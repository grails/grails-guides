<!DOCTYPE html>
<html>
  <head>
    <meta name='google-site-verification' content='REYQ1_I6HGowAE7LOLVqfQbnKaB4IfFpMlGzMbJj55Q' />
    <meta name='viewport' content='width=device-width, initial-scale=1' />
    <link rel='icon' href='/images/favicon.ico' />
    <link rel='mask-icon' href='//images/grails-pinned-icon.svg' color='feb672' />
    <meta charset='UTF-8' />
    <title>Building a REST application with MongoDB | Grails Guides | Grails Framework</title>
    <meta name='description' content='Building a REST application with MongoDB. This guide will demonstrate how you can use Grails, GORM and MongoDB to build a REST application' />
    <link rel='stylesheet' href='../css/main.css' />
    <link rel='stylesheet' href='../css/screen.css' />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js'></script>
  </head>
  <body class='guide'><header class='mainheader'>
  <div class='content'>
    <a href='https://grails.org/index.html'><img class='grailslogo' src='/images/grails_logo.svg' alt='Grails Logo' /></a>
    <a href='javascript:show(&apos;topmenus&apos;, &apos;showNavigationLink&apos;)' id='showNavigationLink' class='mobile align-center'>Show Navigation</a>
    <div id='topmenus'>
      <nav class='secondarymenu' id='secondarymenu'><ul>
  <li>
    <a href='https://grails.org/learning.html'>Learning</a>
  </li>
  <li>
    <a href='https://grails.org/community.html'>Community</a>
  </li>
  <li>
    <a href='https://grails.org/search.html'>Search</a>
  </li>
</ul></nav>
      <nav class='mainmenu' id='mainmenu'><ul>
  <li>
    <a href='https://grails.org/documentation.html'>Documentation</a>
  </li>
  <li>
    <a href='https://grails.org/download.html'>Download</a>
  </li>
  <li>
    <a href='https://plugins.grails.org'>Plugins</a>
  </li>
  <li>
    <a href='https://guides.grails.org/index.html'>Guides</a>
  </li>
  <li>
    <a href='https://grails.org/faq.html'>FAQ</a>
  </li>
  <li>
    <a href='https://grails.org/support.html'>Support</a>
  </li>
</ul></nav>
    </div>
  </div>
</header><div class='fullwidth'><article class="guide">
    <aside>
        <a href="https://travis-ci.org/grails-guides/rest-mongodb"><img src="https://travis-ci.org/grails-guides/rest-mongodb.svg?branch=master"></a>

        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/grails-guides/rest-mongodb&quot;"><img height="15" src="../img/github_white.svg" alt="Github"/><span>&nbsp;Get the Code</span></button>


        <ul class="githublinks">
            <li><button type="button" class="btn btn-default" href="#" onclick="document.getElementById('github-url').value='git@github.com:grails-guides/rest-mongodb.git'" class="codeButton">SSH</button></li>
            <li><button type="button" class="btn btn-default" onclick="document.getElementById('github-url').value='https://github.com/grails-guides/rest-mongodb.git'" class="codeButton">HTTPS</button></li>
        </ul>
        <div class="input-group">
            <!-- Target -->
            <input id="github-url" value="git@github.com:grails-guides/rest-mongodb.git" type="text" />
            <!-- Trigger -->
            <button type="button" class="clippy btn btn-default" type="button" data-clipboard-target="#github-url">
                <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
            </button>
        </div>
        <script>var clipboard = new Clipboard('.clippy');</script>
        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/grails-guides/rest-mongodb/archive/master.zip&quot;">Download ZIP</button>
        
        <div id="table-of-content">
            <h3>Table of Contents</h3>
            
            <div class="toc-item" style="margin-left:0px"><a href="#training"><strong>1</strong><span>Grails Training</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#gettingStarted"><strong>2</strong><span>Getting Started</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#requirements"><strong>2.1</strong><span>What you will need</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#howto"><strong>2.2</strong><span>How to complete the guide</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#writingTheApp"><strong>3</strong><span>Writing the Application</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#configure"><strong>3.1</strong><span>Configure the Application</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#domainClass"><strong>3.2</strong><span>Create a Domain Class</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#applyConstraints"><strong>3.3</strong><span>Apply Domain Constraints</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#controller"><strong>3.4</strong><span>Create a Controller</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#mapController"><strong>3.5</strong><span>Map the Controller to a URI</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#searchEndpoint"><strong>3.6</strong><span>Implement a Search Endpoint</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#testing"><strong>3.7</strong><span>Testing the Search Endpoint</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#json"><strong>3.8</strong><span>Customizing the JSON Output</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#runningTheApp"><strong>4</strong><span>Running the Application</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#createData"><strong>4.1</strong><span>Creating Data with POST</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#readData"><strong>4.2</strong><span>Reading Data with GET</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#updateData"><strong>4.3</strong><span>Updating Data with PUT</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#deleteDate"><strong>4.4</strong><span>Deleting Data with DELETE</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#helpWithGrails"><strong>5</strong><span>Do you need help with Grails?</span></a></div>
            
            <div style="clear:both" ></div>
        </div>
        
    </aside>
    <header>
        <h1>Building a REST application with MongoDB</h1>
        <p>This guide will demonstrate how you can use Grails, GORM and MongoDB to build a REST application</p>
        <p><strong>Authors:</strong> Graeme Rocher</p>
        <p><strong>Grails Version:</strong> 4.0.1</p>
    </header>
    

<h1 id="training">1 Grails Training</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/training.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><strong>Grails Training</strong> - Developed and delivered by the folks who created and actively maintain the Grails framework!.</p>
</div>
<div id="ocitraining"></div>
<script type="text/javascript">
var getJSON = function(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'json';
    xhr.onload = function() {
      var status = xhr.status;
      if (status == 200) {
        callback(null, xhr.response);
      } else {
        callback(status);
      }
    };
    xhr.send();
};
getJSON('https://training.grails.org/training', function(err, data) {
  var msg = '';
  if (err != null) {
      msg = 'Something went wrong while retrieving OCI training offerings';

  } else {
      if ( data.length == 0 ) {
         msg = '<p><b>Nothing scheduled at the moment - please check back again soon!</b></p>.';

      } else {
        msg += '<table>';
        msg += '<thead>';
        msg += '<tr><th>Course</th><th>Date(s)</th><th>Instructor(s)</th><th>Hour(s)</th></tr>';
        msg += '</thead>';
        msg += '<tbody>';

        var hrefs = new Array();
        for (var i = 0; i < data.length; i++) {
            var href = data[i].enrollmentLink;
            if (hrefs.indexOf(href) == -1) {
                msg += '<tr><td><a href="'+ href + '">'+ data[i].course + '</a></td><td>'+ data[i].dates + '</td><td>'+ data[i].instructors + '</td><td>'+ data[i].hours + '</td></tr>';
                hrefs.push(href);
            }

        }
        msg += '</tbody>';
        msg += '</table>';
      }
  }
  var ociTraining = document.getElementById("ocitraining");
  ociTraining.innerHTML = msg;
});
</script>


<h1 id="gettingStarted">2 Getting Started</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/gettingStarted.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In this guide you are going to build a <a href="http://grails.org">Grails application</a> that uses <a href="http://gorm.grails.org/latest/mongodb">GORM for MongoDB</a> to access <a href="http://mongodb.org">MongoDB</a> and produce a JSON response in a RESTful manner.</p>
</div>


<h2 id="requirements">2.1 What you will need</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/requirements.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To complete this guide, you will need the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE</p>
</li>
<li>
<p>JDK 1.8 or greater installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>An <a href="https://www.mongodb.com/download-center">installation</a> of <a href="http://mongodb.org">MongoDB</a> 3.0.0 or above</p>
</li>
</ul>
</div>


<h2 id="howto">2.2 How to complete the guide</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/howto.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To get started do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/grails-guides/rest-mongodb/archive/master.zip">Download</a> and unzip the source</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clone the <a href="https://git-scm.com/">Git</a> repository:<br>
<code>git clone <a href="https://github.com/grails-guides/rest-mongodb.git" class="bare">https://github.com/grails-guides/rest-mongodb.git</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Grails guides repositories contain two folders:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>initial</code>  Initial project. Often a simple Grails app with some additional code to give you a head-start.</p>
</li>
<li>
<p><code>complete</code> A completed example. It is the result of working through the steps presented by the guide and applying those changes to the <code>initial</code> folder.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To complete the guide, go to the <code>initial</code> folder</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cd</code> into <code>grails-guides/rest-mongodb/initial</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and follow the instructions in the next sections.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can go right to the <strong>completed example</strong> if you <code>cd</code> into <code>grails-guides/rest-mongodb/complete</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, if you already have Grails 4.0.1 installed then you can create a new application using the following command in a Terminal window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-app mongodb-example --profile rest-api --features mongodb
$ cd mongodb-example</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the <code>create-app</code> command completes, Grails will create a <code>mongodb-example</code> directory with an application configured to create a REST application by default (using the <code>rest-api</code> profile) and configured to use the <code>mongodb</code> feature.</p>
</div>
<div class="paragraph">
<p>Once you have the application create you need to startup MongoDB. Typically this is done via the <code>MONGODB_HOME/bin/mongod</code> executable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ sudo ./mongod
2016-11-22T12:42:30.569+0100 I CONTROL  [initandlisten] db version v3.0.4
2016-11-22T12:42:30.569+0100 I CONTROL  [initandlisten] git version: 0481c958daeb2969800511e7475dc66986fa9ed5
2016-11-22T12:42:30.569+0100 I CONTROL  [initandlisten] build info: Darwin mci-osx108-11.build.10gen.cc 12.5.0 Darwin Kernel Version 12.5.0: Sun Sep 29 13:33:47 PDT 2013; root:xnu-2050.48.12~1/RELEASE_X86_64 x86_64 BOOST_LIB_VERSION=1_49
2016-11-22T12:42:30.569+0100 I CONTROL  [initandlisten] allocator: system
2016-11-22T12:42:30.569+0100 I CONTROL  [initandlisten] options: {}
2016-11-22T12:42:31.297+0100 I NETWORK  [initandlisten] waiting for connections on port 27017</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see MongoDB is by default available on port <code>27017</code>.</p>
</div>


<h1 id="writingTheApp">3 Writing the Application</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/writingTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Now you are ready to start writing the application.</p>
</div>


<h2 id="configure">3.1 Configure the Application</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/configure.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The first step after starting the MongoDB server is to ensure the application is correctly configured. By default the configuration for the MongoDB client can be found in the <code>grails-app/conf/application.yml</code> file:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/conf/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">grails</span>:
    <span class="key">mongodb</span>:
        <span class="key">host</span>: localhost
        <span class="key">port</span>: <span class="integer">27017</span>
        <span class="error">#</span><span class="key">username</span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
        <span class="error">#</span><span class="key">password</span>: <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
        <span class="error">#</span><span class="key">databaseName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">mydatabase</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration is setup to use the defaults, however if your MongoDB server requires authentication or any custom configuration you may want to <a href="http://gorm.grails.org/latest/mongodb/manual/index.html#advancedConfig">alter the configuration</a>.</p>
</div>


<h2 id="domainClass">3.2 Create a Domain Class</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/domainClass.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Each <a href="http://api.mongodb.com/java/current/com/mongodb/client/MongoCollection.html">MongoCollection</a> is represented by a <a href="http://gorm.grails.org/latest/hibernate/manual/index.html#domainClasses">GORM domain class</a>.</p>
</div>
<div class="paragraph">
<p>You can create a domain class with the <code>create-domain-class</code> CLI command from the root of your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ ./grailsw create-domain-class Product
| Created grails-app/domain/demo/Product.groovy
| Created src/test/groovy/demo/ProductSpec.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can equally create a domain class with your favourite text editor or IDE.</p>
</div>
<div class="paragraph">
<p>A domain class is a simple Groovy class and you can represent each attribute of a MongoDB <a href="http://api.mongodb.com/java/current/org/bson/Document.html">Document</a> using a property. For example:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/domain/demo/Product.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">grails.compiler.GrailsCompileStatic</span>

<span class="annotation">@GrailsCompileStatic</span>
<span class="type">class</span> <span class="class">Product</span> {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each domain class defined in the application will be compiled to implement the <a href="http://gorm.grails.org/latest/mongodb/api/grails/mongodb/MongoEntity.html">MongoEntity</a> trait. If you prefer you can define this explicitly:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/domain/demo/Product.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.mongodb.*</span>

<span class="type">class</span> <span class="class">Product</span> <span class="directive">implements</span> MongoEntity&lt;Product&gt; {
    ..
}</code></pre>
</div>
</div>


<h2 id="applyConstraints">3.3 Apply Domain Constraints</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/applyConstraints.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you wish to define <a href="http://gorm.grails.org/latest/hibernate/manual/index.html#constraints">validation constraints</a>
on properties defined in a GORM domain class, you can do so using the <code>constraints</code> property:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/domain/demo/Product.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="directive">static</span> constraints = {
    name <span class="key">blank</span>: <span class="predefined-constant">false</span>
    price <span class="key">range</span>: <span class="float">0.0</span>..<span class="float">1000.00</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example applies two constraints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>name</code> property is constrained so that it cannot be a blank string.</p>
</li>
<li>
<p>The <code>price</code> property is constrained so that it must be greater than 0 and less than a thousand using the <code>range</code> constraint.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To verify these constraints work to our expectation you can write a test. If you used the <code>create-domain-class</code> a test
called <code>src/test/groovy/demo/ProductSpec.groovy</code> was generated for you already. Otherwise simply creating an appropriately
named test in <code>src/test/groovy</code> using your IDE or text editor will suffice.</p>
</div>
<div class="paragraph">
<p>Tests in Grails are written with <a href="http://spockframework.org">Spock Framework</a>,
tests including having spaces in the test name.</p>
</div>
<div class="paragraph">
<p>To write unit tests with MongoDB and Spock, you can simply extend from <code>grails.test.mongodb.MongoSpec</code>.</p>
</div>
<div class="listingblock">
<div class="title">src/test/groovy/demo/ProductSpec.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.test.mongodb.MongoSpec</span>
<span class="keyword">import</span> <span class="include">grails.testing.gorm.DomainUnitTest</span>
<span class="keyword">import</span> <span class="include">com.github.fakemongo.Fongo</span>
<span class="keyword">import</span> <span class="include">com.mongodb.MongoClient</span>

<span class="type">class</span> <span class="class">ProductSpec</span> <span class="directive">extends</span> MongoSpec <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="directive">implements</span> DomainUnitTest&lt;Product&gt; {  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="annotation">@Override</span>
    MongoClient createMongoClient() {  <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="keyword">new</span> Fongo(getClass().name).mongo
    }

    <span class="type">void</span> <span class="string"><span class="delimiter">'</span><span class="content">a negative value is not a valid price</span><span class="delimiter">'</span></span>() { <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="key">given</span>:
        domain.price = -<span class="float">2.0d</span>

        <span class="key">expect</span>:
        !domain.validate([<span class="string"><span class="delimiter">'</span><span class="content">price</span><span class="delimiter">'</span></span>])
    }

    <span class="type">void</span> <span class="string"><span class="delimiter">'</span><span class="content">a blank name is not save</span><span class="delimiter">'</span></span>() { <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="key">given</span>:
        domain.name = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>

        <span class="key">expect</span>:
        !domain.validate([<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>])
    }

    <span class="type">void</span> <span class="string"><span class="delimiter">'</span><span class="content">A valid domain is saved</span><span class="delimiter">'</span></span>() {  <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="key">given</span>:
        domain.name = <span class="string"><span class="delimiter">'</span><span class="content">Banana</span><span class="delimiter">'</span></span>
        domain.price = <span class="float">2.15d</span>

        <span class="key">when</span>:
        domain.save()

        <span class="key">then</span>:
        Product.count() == old(Product.count()) + <span class="integer">1</span>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Spock allows you to define much more readable</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Override the <code>createMongoClient</code> method of the <code>MongoSpec</code> base class. Use something such as <a href="https://github.com/fakemongo/fongo">Fongo</a>; an in-memory java implementation of MongoDB.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>MongoSpec is an abstract class that will initialise GORM in the setup phase of the specification being executed</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use the <a href="https://testing.grails.org/latest/guide/index.html#unitTestingDomainClasses">grails.testing.gorm.DomainUnitTest</a> trait to unit test single domain class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Add the fongo dependency to <code>build.gradle</code></p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    testCompile <span class="string"><span class="delimiter">'</span><span class="content">com.github.fakemongo:fongo:2.1.0</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now to run the test you can run <code>./gradlew check</code> from a terminal window or run the test within your IDE if the IDE supports it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ ./gradlew check</code></pre>
</div>
</div>
<div class="paragraph">
<p>Checkout <a href="http://guides.grails.org/grails-test-domain-class-constraints/guide/index.html">How to test domain class constraints?</a> guide to learn more about testing constraints.</p>
</div>


<h2 id="controller">3.4 Create a Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/controller.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>With the data model defined now it time to write <a href="http://docs.grails.org/latest/guide/theWebLayer.html#controllers">a controller</a>.</p>
</div>
<div class="paragraph">
<p>The quickest way to do that is with the <code>create-restful-controller</code> command from a terminal window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ ./grailsw create-restful-controller demo.Product
| Created grails-app/controllers/demo/ProductController.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, you can also simply create the controller with your favourite text editor or IDE.</p>
</div>
<div class="paragraph">
<p>The contents of the controller should look like the following:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/demo/ProductController.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">ProductController</span> <span class="directive">extends</span> RestfulController {
    <span class="directive">static</span> responseFormats = [<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">xml</span><span class="delimiter">'</span></span>]
    ProductController() {
        <span class="local-variable">super</span>(Product)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>RestfulController</code> super class will implement all the necessary operations to perform the common REST verbs such as <code>GET</code>, <code>POST</code>, <code>PUT</code> and <code>DELETE</code>. If is you wish to override or forbid certain verbs you can override the equivalent method from the super (for example the <code>delete</code> method for <code>DELETE</code>) to return an alternative or forbidden response.</p>
</div>


<h2 id="mapController">3.5 Map the Controller to a URI</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/mapController.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>By default the controller will be exposed under the <code>/product</code> URI. This is due to the default <code>grails-app/conf/demo/UrlMappings.groovy</code> class:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/demo/UrlMappings.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">delete <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>controller</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>id</span><span class="content">(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span>(<span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">delete</span><span class="delimiter">'</span></span>)
get <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>controller</span><span class="content">(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span>(<span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">index</span><span class="delimiter">'</span></span>)
get <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>controller</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>id</span><span class="content">(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span>(<span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">show</span><span class="delimiter">'</span></span>)
post <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>controller</span><span class="content">(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span>(<span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">save</span><span class="delimiter">'</span></span>)
put <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>controller</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>id</span><span class="content">(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span>(<span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">update</span><span class="delimiter">'</span></span>)
patch <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>controller</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>id</span><span class="content">(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span>(<span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">patch</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see above each HTTP verb is mapped such that the controller name is established from the URI itself using the <code>$controller</code> syntax.</p>
</div>
<div class="paragraph">
<p>If you wish to use another name or be explicit about the URI used you can define an additional mapping uses the <code>resources</code> mapping:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/demo/UrlMappings.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="string"><span class="delimiter">&quot;</span><span class="content">/products</span><span class="delimiter">&quot;</span></span>(<span class="key">resources</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">product</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case the controller will be mapped to <code>/products</code> instead of <code>/product</code>.</p>
</div>


<h2 id="searchEndpoint">3.6 Implement a Search Endpoint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/searchEndpoint.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you wish to add an additional endpoint to your REST API then it is simply a matter of implementing the corresponding action.</p>
</div>
<div class="paragraph">
<p>For example, say you wanted to be able to search for products using the <code>/products/search</code> URI and a query. To do so the first step is to implement a <code>search</code> action in the controller:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/demo/ProductController.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">search</span>(<span class="predefined-type">String</span> q, <span class="predefined-type">Integer</span> max ) { <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="keyword">if</span> (q) {
        <span class="keyword">def</span> query = Product.where { <i class="conum" data-value="2"></i><b>(2)</b>
            name ==~ ~<span class="regexp"><span class="delimiter">/</span><span class="inline"><span class="inline-delimiter">$</span>q</span><span class="delimiter">/</span></span>
        }
        respond query.list(<span class="key">max</span>: <span class="predefined-type">Math</span>.min( max ?: <span class="integer">10</span>, <span class="integer">100</span>)) <i class="conum" data-value="3"></i><b>(3)</b>
    }
    <span class="keyword">else</span> {
        respond(<span class="type">[]</span>) <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>An action called <code>search</code> is defined that takes a query parameter, called <code>q</code>, and a <code>max</code> parameter</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A <a href="http://gorm.grails.org/latest/hibernate/manual/index.html#whereQueries">where</a> query is executed that uses a regular expression (regex) to search for products.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>respond</code> method is used to respond with a list of results</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>For the case where no query is specified we <code>respond</code> with an empty list</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With the action written you now need to expose the <code>/products/search</code> endoint by defining the appropriate mapping in <code>grails-app/conf/demo/UrlMappings.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/demo/UrlMappings.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="string"><span class="delimiter">'</span><span class="content">/products</span><span class="delimiter">'</span></span>(<span class="key">resources</span>: <span class="string"><span class="delimiter">'</span><span class="content">product</span><span class="delimiter">'</span></span>) {
    collection {
        <span class="string"><span class="delimiter">'</span><span class="content">/search</span><span class="delimiter">'</span></span>(<span class="key">controller</span>: <span class="string"><span class="delimiter">'</span><span class="content">product</span><span class="delimiter">'</span></span>, <span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">search</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example uses the <code>collection</code> method to nest URIs directly underneath the <code>/products</code> URI (for example <code>/product/search</code>) instead of nesting it below the resource identifier (for example <code>/product/1/search</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the Grails user guide on <a href="http://docs.grails.org/latest/guide//theWebLayer.html#restfulMappings">Mapping REST Resources</a> for more information on controllering how URIs map to controllers.
</td>
</tr>
</table>
</div>


<h2 id="testing">3.7 Testing the Search Endpoint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/testing.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To write a unit test for the <code>search</code> action your can use the <code>create-unit-test</code> command of the CLI to create one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ ./grailsw create-unit-test demo.ProductController</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or alternatively just create a <code>src/test/groovy/demo/ProductControllerSpec.groovy</code> file using your favourite text editor or IDE.</p>
</div>
<div class="paragraph">
<p>Write the next unit test:</p>
</div>
<div class="listingblock">
<div class="title">src/test/groovy/demo/ProductControllerSpec.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">com.github.fakemongo.Fongo</span>
<span class="keyword">import</span> <span class="include">com.mongodb.MongoClient</span>
<span class="keyword">import</span> <span class="include">grails.test.mongodb.MongoSpec</span>
<span class="keyword">import</span> <span class="include">grails.testing.web.controllers.ControllerUnitTest</span>

<span class="type">class</span> <span class="class">ProductControllerSpec</span> <span class="directive">extends</span> MongoSpec <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="directive">implements</span> ControllerUnitTest&lt;ProductController&gt; {  <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="annotation">@Override</span>
    MongoClient createMongoClient() {  <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="keyword">new</span> Fongo(getClass().name).mongo
    }
    <span class="type">void</span> setup() { <i class="conum" data-value="4"></i><b>(4)</b>
        Product.saveAll(
            <span class="keyword">new</span> Product(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Apple</span><span class="delimiter">'</span></span>, <span class="key">price</span>: <span class="float">2.0</span>),
            <span class="keyword">new</span> Product(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Orange</span><span class="delimiter">'</span></span>, <span class="key">price</span>: <span class="float">3.0</span>),
            <span class="keyword">new</span> Product(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Banana</span><span class="delimiter">'</span></span>, <span class="key">price</span>: <span class="float">1.0</span>),
            <span class="keyword">new</span> Product(<span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Cake</span><span class="delimiter">'</span></span>, <span class="key">price</span>: <span class="float">4.0</span>)
        )
    }
    <span class="type">void</span> <span class="string"><span class="delimiter">'</span><span class="content">test the search action finds results</span><span class="delimiter">'</span></span>() {
        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">A query is executed that finds results</span><span class="delimiter">'</span></span>
        controller.search(<span class="string"><span class="delimiter">'</span><span class="content">pp</span><span class="delimiter">'</span></span>, <span class="integer">10</span>)

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">The response is correct</span><span class="delimiter">'</span></span>
        response.json.size() == <span class="integer">1</span>
        response.json[<span class="integer">0</span>].name == <span class="string"><span class="delimiter">'</span><span class="content">Apple</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>MongoSpec is an abstract class that will initialise GORM in the setup phase of the specification being executed</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Override the <code>createMongoClient</code> method of the <code>MongoSpec</code> base class. Use something such as <a href="https://github.com/fakemongo/fongo">Fongo</a>; an in-memory java implementation of MongoDB.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Use the <a href="https://testing.grails.org/latest/guide/index.html#unitTestingControllers">grails.testing.web.controllers.ControllerUnitTest</a> trait to unit test controllers.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>setup</code> method uses the <code>saveAll</code> method to save multiple domain classes to serve as test data.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The test performs a search by executing the <code>search</code> method, passing appropriate arguments and verifying the JSON written to the response.
The tests asserts the value of the <code>json</code> property of the <code>response</code>. The resulting JSON rendered by Grails looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Apple</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span>:<span class="float">2.0</span>}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at how we can customize this JSON.</p>
</div>


<h2 id="json">3.8 Customizing the JSON Output</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/json.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails uses <a href="http://views.grails.org">JSON Views</a> to represent render JSON responses. The idea being to continue the philosophy of separating the controller logic from the view logic.</p>
</div>
<div class="paragraph">
<p>The default view rendered if no specific view is found is <code>grails-app/views/object/_object.gson</code>:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/views/object/_object.gson</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">groovy.transform.*</span>

<span class="annotation">@Field</span> <span class="predefined-type">Object</span> object

json g.render(object)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default <code>_object.gson</code> view simply uses the <code>g.render(..)</code> method to automatically product a JSON representation of the object.</p>
</div>
<div class="paragraph">
<p>If you want to alter the output of the JSON the way that is done in Grails is by creating a view. You can generate a starting point with the <code>generate-views</code> command of the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./grailsw generate-views demo.Product
| Rendered template index.gson to destination grails-app/views/product/index.gson
| Rendered template show.gson to destination grails-app/views/product/show.gson
| Rendered template _domain.gson to destination grails-app/views/product/_product.gson</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see 3 templates were generated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>grails-app/views/product/index.gson</code> - This view will be used when a collection (typically a list of results from GORM) is rendered via the <code>respond</code> method in a controller.</p>
</li>
<li>
<p><code>grails-app/views/product/show.gson</code> - This view will be rendered when a single <code>Product</code> instance is rendered via the <code>respond</code> method in a controller.</p>
</li>
<li>
<p><code>grails-app/views/product/_product.gson</code> - This is the template used by both the <code>index.gson</code> and <code>show.gson</code> views to actually display the data.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The contents of the <code>_product.gson</code> by default look like:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/views/product/_product.gson</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">demo.Product</span>

model {
    Product product
}

json g.render(product)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The call to <code>g.render(product)</code> outputs all properties.</p>
</div>
<div class="paragraph">
<p>However, the <code>json</code> property is an instance of Groovy&#8217;s <a href="http://docs.groovy-lang.org/2.4.7/html/gapi/groovy/json/StreamingJsonBuilder.html">StreamingJsonBuilder</a> and you can use it to alter the output as per your needs.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="title">grails-app/views/product/_product.gson</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">demo.Product</span>

model {
        Product product
}

<span class="predefined-type">Currency</span> currency = locale?.country ? <span class="predefined-type">Currency</span>.getInstance(locale) : <span class="predefined-type">Currency</span>.getInstance(<span class="string"><span class="delimiter">'</span><span class="content">USD</span><span class="delimiter">'</span></span>)
json {
    id product.id
    name product.name
    price <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>currency.symbol<span class="inline-delimiter">}</span></span><span class="inline"><span class="inline-delimiter">${</span>product.price<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this trivialized example, we output the currency symbol based on the user&#8217;s locale. Now the resulting JSON will look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{<span class="error">i</span><span class="error">d</span>:<span class="integer">1</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Apple</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">price</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">$2.0</span><span class="delimiter">&quot;</span></span>}]</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
JSON Views are very flexible, for more information on customizing the output to your needs see <a href="http://views.grails.org">the documentation</a>.
</td>
</tr>
</table>
</div>


<h1 id="runningTheApp">4 Running the Application</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/runningTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To run the application use the <code>./gradlew bootRun</code> command which will start the application on port 8080.</p>
</div>


<h2 id="createData">4.1 Creating Data with POST</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/createData.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Once the application has started up you can create a <code>Product</code> instance using your preferred HTTP client. In the following examples we will be using the <a href="https://curl.haxx.se">curl</a>.</p>
</div>
<div class="paragraph">
<p>To submit a <code>POST</code> request use the following in a terminal window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Content-Type:application/json&quot; -X POST localhost:8080/products -d '{&quot;name&quot;:&quot;Orange&quot;,&quot;price&quot;:2.0}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting output will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">HTTP/1.1 201
X-Application-Context: application:development
Location: http://localhost:8080/products/2
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Wed, 23 Nov 2016 08:46:40 GMT

{&quot;name&quot;:&quot;Orange&quot;,&quot;price&quot;:&quot;$2.0&quot;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see an HTTP 201 status code is returned.</p>
</div>


<h2 id="readData">4.2 Reading Data with GET</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/readData.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can read all of the <code>Product</code> instances back using a <code>GET</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i  localhost:8080/products</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or read only a single instance by <code>id</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i  localhost:8080/products/1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which will return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">HTTP/1.1 200
X-Application-Context: application:development
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Wed, 23 Nov 2016 08:50:58 GMT

{&quot;id&quot;:1,&quot;name&quot;:&quot;Orange&quot;,&quot;price&quot;:&quot;$2.0&quot;}</code></pre>
</div>
</div>


<h2 id="updateData">4.3 Updating Data with PUT</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/updateData.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To update data you can use a <code>PUT</code> request with the id and in the URI and data you want to change:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Content-Type:application/json&quot; -X PUT localhost:8080/products/1 -d '{&quot;price&quot;:3.0}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case the resulting output will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">HTTP/1.1 200
X-Application-Context: application:development
Location: http://localhost:8080/products/1
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Wed, 23 Nov 2016 08:52:14 GMT

{&quot;id&quot;:1,&quot;name&quot;:&quot;Orange&quot;,&quot;price&quot;:&quot;$3.0&quot;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you were to attempt update the data with an invalid value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Content-Type:application/json&quot; -X PUT localhost:8080/products/1 -d '{&quot;price&quot;:-2.0}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then an error response will be received:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">HTTP/1.1 422
X-Application-Context: application:development
Location: http://localhost:8080/products/1
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Date: Wed, 23 Nov 2016 08:54:25 GMT

{&quot;message&quot;:&quot;Property [price] of class [class demo.Product] with value [-2] does not fall within the valid range from [0] to [1,000]&quot;,&quot;path&quot;:&quot;&quot;,&quot;_links&quot;:{&quot;self&quot;:{&quot;href&quot;:&quot;http://localhost:8080/products/1&quot;}}}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The error response is rendered by the <code>grails-app/views/error.gson</code> view and the messages are obtained from the message bundles located at <code>grails-app/i18n</code>
</td>
</tr>
</table>
</div>


<h2 id="deleteDate">4.4 Deleting Data with DELETE</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/deleteDate.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To delete a <code>Product</code> simply send a <code>DELETE</code> request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -X DELETE localhost:8080/products/1</code></pre>
</div>
</div>
<div class="paragraph">
<p>If deleting the instance was successful the output will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">HTTP/1.1 204
X-Application-Context: application:development
Content-Type: application/json;charset=UTF-8
Date: Wed, 23 Nov 2016 08:57:27 GMT</code></pre>
</div>
</div>
<div class="paragraph">
<p>Congratulations! You have built your first REST application with Grails, GORM and MongoDB!</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Remember you can obtain the source code for the completed examples using the links on the right.
</td>
</tr>
</table>
</div>


<h1 id="helpWithGrails">5 Do you need help with Grails?</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/rest-mongodb/edit/master/src/main/docs/guide/helpWithGrails.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<h3 style="color: #333; margin-bottom:25px;"><a href="https://objectcomputing.com/" target="_blank">Object Computing, Inc.</a> (OCI) sponsored the creation of this Guide. A variety of consulting and support services are available.</h3>

<!-- BEGIN HubSpot Consultation Form -->

<!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
<script>
  hbspt.forms.create({
	portalId: "4547412",
	formId: "f8bc9b16-d5f6-4226-a24e-da0eb8b73363"
});
</script>

<!-- END HubSpot Consultation Form -->

<h3 style="color: #333;">OCI is Home to Grails</h3>

<p><a href="https://objectcomputing.com/products/2gm-team" target="_blank">Meet the Team</a></p>

</article></div><footer>
  <div class='content'>
    <div class='ocihometograils'>
      <span>Sponsored by</span>
      <a href='https://objectcomputing.com/products/grails/'><img class='' src='/images/oci_home_to_grails.svg' alt='Object Computing - Home to Grails' width='300px' /></a>
    </div>
    <nav class='socialmedianav'><ul>
  <li>
    <a href='https://slack.grails.org'><img class='' src='/images/slack.svg' alt='Slack Icon' /></a>
  </li>
  <li>
    <a href='https://www.youtube.com/watch?v=XnRNfDGkBVg&amp;list=PLI74De5M9T73uH3WilDCePP2qfSDpMaGu'><img class='' src='/images/youtube.svg' alt='Youtube Icon' /></a>
  </li>
  <li>
    <a href='https://www.linkedin.com/groups/39757'><img class='' src='/images/linkedin.svg' alt='LinkedIn Icon' /></a>
  </li>
  <li>
    <a href='https://github.com/grails/'><img class='' src='/images/github.svg' alt='Github Icon' /></a>
  </li>
  <li>
    <a href='https://twitter.com/grailsframework'><img class='' src='/images/twitter.svg' alt='Twitter Icon' /></a>
  </li>
</ul></nav>
    <nav class='partnersnav'><ul>
  <li>Grails' repositories are hosted by
    <a href='https://repo.grails.org/'>Artifactory</a>
  </li>
  <li>Website hosting provided by
    <a href='https://aws.amazon.com/'>AWS</a>
  </li>
  <li>JetBrains supports Grails with its 
    <a href='https://www.jetbrains.com/idea/'>IntelliJ IDEA IDE</a>
  </li>
  <li>YourKit supports Grails with its 
    <a href='https://www.yourkit.com/java/profiler/index.jsp'>Java Profiler</a>
  </li>
  <li>Grails is Open Source
    <a href='http://www.apache.org/licenses/LICENSE-2.0.html'>Apache 2 License</a>
  </li>
  <li>
    <a href='https://grails.org/buildstatus.html'>Build Status</a>
  </li>
</ul></nav>
  </div>
</footer><div>
  <script type='text/javascript'>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-82213539-2', 'auto');
              ga('send', 'pageview');
</script>
  <script type='text/javascript'>
adroll_adv_id = "HBWJH4CQCJGS5DJRSB4Z4D";
adroll_pix_id = "IVEQYFOZXZAPZMDVQH7BFE";
/* OPTIONAL: provide email to improve user identification */
/* adroll_email = "username@example.com"; */
(function () {
    var _onload = function(){
        if (document.readyState && !/loaded|complete/.test(document.readyState)){setTimeout(_onload, 10);return}
        if (!window.__adroll_loaded){__adroll_loaded=true;setTimeout(_onload, 50);return}
        var scr = document.createElement("script");
        var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
        scr.setAttribute('async', 'true');
        scr.type = "text/javascript";
        scr.src = host + "/j/roundtrip.js";
        ((document.getElementsByTagName('head') || [null])[0] ||
            document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
    };
    if (window.addEventListener) {window.addEventListener('load', _onload, false);}
    else {window.attachEvent('onload', _onload)}
}());            
</script>
</div></body>
</html>
