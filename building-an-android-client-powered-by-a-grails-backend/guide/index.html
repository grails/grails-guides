<!DOCTYPE html>
<html>
  <head>
    <meta name='google-site-verification' content='REYQ1_I6HGowAE7LOLVqfQbnKaB4IfFpMlGzMbJj55Q' />
    <meta name='viewport' content='width=device-width, initial-scale=1' />
    <link rel='icon' href='/images/favicon.ico' />
    <link rel='mask-icon' href='//images/grails-pinned-icon.svg' color='feb672' />
    <meta charset='UTF-8' />
    <title>Building an Android client powered by a Grails backend | Grails Guides | Grails Framework</title>
    <meta name='description' content='Building an Android client powered by a Grails backend. This guide demonstrates how you can use Grails as a backend for an Android app' />
    <link rel='stylesheet' href='../css/main.css' />
    <link rel='stylesheet' href='../css/screen.css' />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js'></script>
  </head>
  <body class='guide'><header class='mainheader'>
  <div class='content'>
    <a href='https://grails.org/index.html'><img class='grailslogo' src='/images/grails_logo.svg' alt='Grails Logo' /></a>
    <a href='javascript:show(&apos;topmenus&apos;, &apos;showNavigationLink&apos;)' id='showNavigationLink' class='mobile align-center'>Show Navigation</a>
    <div id='topmenus'>
      <nav class='secondarymenu' id='secondarymenu'><ul>
  <li>
    <a href='https://grails.org/learning.html'>Learning</a>
  </li>
  <li>
    <a href='https://grails.org/community.html'>Community</a>
  </li>
  <li>
    <a href='https://grails.org/search.html'>Search</a>
  </li>
</ul></nav>
      <nav class='mainmenu' id='mainmenu'><ul>
  <li>
    <a href='https://grails.org/documentation.html'>Documentation</a>
  </li>
  <li>
    <a href='https://grails.org/download.html'>Download</a>
  </li>
  <li>
    <a href='https://plugins.grails.org'>Plugins</a>
  </li>
  <li>
    <a href='https://guides.grails.org/index.html'>Guides</a>
  </li>
  <li>
    <a href='https://grails.org/faq.html'>FAQ</a>
  </li>
  <li>
    <a href='https://grails.org/support.html'>Support</a>
  </li>
</ul></nav>
    </div>
  </div>
</header><div class='fullwidth'><article class="guide">
    <aside>
        <a href="https://travis-ci.org/grails-guides/building-an-android-client-powered-by-a-grails-backend"><img src="https://travis-ci.org/grails-guides/building-an-android-client-powered-by-a-grails-backend.svg?branch=master"></a>

        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend&quot;"><img height="15" src="../img/github_white.svg" alt="Github"/><span>&nbsp;Get the Code</span></button>


        <ul class="githublinks">
            <li><button type="button" class="btn btn-default" href="#" onclick="document.getElementById('github-url').value='git@github.com:grails-guides/building-an-android-client-powered-by-a-grails-backend.git'" class="codeButton">SSH</button></li>
            <li><button type="button" class="btn btn-default" onclick="document.getElementById('github-url').value='https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend.git'" class="codeButton">HTTPS</button></li>
        </ul>
        <div class="input-group">
            <!-- Target -->
            <input id="github-url" value="git@github.com:grails-guides/building-an-android-client-powered-by-a-grails-backend.git" type="text" />
            <!-- Trigger -->
            <button type="button" class="clippy btn btn-default" type="button" data-clipboard-target="#github-url">
                <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
            </button>
        </div>
        <script>var clipboard = new Clipboard('.clippy');</script>
        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/archive/master.zip&quot;">Download ZIP</button>
        
        <div id="table-of-content">
            <h3>Table of Contents</h3>
            
            <div class="toc-item" style="margin-left:0px"><a href="#training"><strong>1</strong><span>Grails Training</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#gettingStarted"><strong>2</strong><span>Getting Started</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#requirements"><strong>2.1</strong><span>What you will need</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#howto"><strong>2.2</strong><span>How to complete the guide</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#overview"><strong>3</strong><span>Overview</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#writingTheGrailsApp"><strong>4</strong><span>Writing the Grails Application</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#domainClass"><strong>4.1</strong><span>Create a Domain Class - Persistent Entities</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#domainClassTest"><strong>4.2</strong><span>Domain Class Unit Testing</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#versioning"><strong>4.3</strong><span>Versioning</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#v1Controller"><strong>4.4</strong><span>Create a Controller</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#bootstrap"><strong>4.5</strong><span>Loading test data</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#v1FunctionalTests"><strong>4.6</strong><span>Functional tests</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#runningTheApp"><strong>4.7</strong><span>Running the Application</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#writingTheAndroidApp"><strong>5</strong><span>Writing the Android Application</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#androidOverview"><strong>5.1</strong><span>Fetching the Announcements</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#networkingCode"><strong>5.2</strong><span>Networking code</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#detailActivity"><strong>5.3</strong><span>Detail Activity</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#version2"><strong>6</strong><span>API version 2.0</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#v2Controller"><strong>6.1</strong><span>Grails V2 Changes</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#v2FunctionalTests"><strong>6.2</strong><span>Api 2.0 Functional tests</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#v2Android"><strong>6.3</strong><span>Android V2 Changes</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#conclusion"><strong>7</strong><span>Conclusion</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#helpWithGrails"><strong>8</strong><span>Do you need help with Grails?</span></a></div>
            
            <div style="clear:both" ></div>
        </div>
        
    </aside>
    <header>
        <h1>Building an Android client powered by a Grails backend</h1>
        <p>This guide demonstrates how you can use Grails as a backend for an Android app</p>
        <p><strong>Authors:</strong> Sergio del Amo</p>
        <p><strong>Grails Version:</strong> 4.0.1</p>
    </header>
    

<h1 id="training">1 Grails Training</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/training.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><strong>Grails Training</strong> - Developed and delivered by the folks who created and actively maintain the Grails framework!.</p>
</div>
<div id="ocitraining"></div>
<script type="text/javascript">
var getJSON = function(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'json';
    xhr.onload = function() {
      var status = xhr.status;
      if (status == 200) {
        callback(null, xhr.response);
      } else {
        callback(status);
      }
    };
    xhr.send();
};
getJSON('https://training.grails.org/training', function(err, data) {
  var msg = '';
  if (err != null) {
      msg = 'Something went wrong while retrieving OCI training offerings';

  } else {
      if ( data.length == 0 ) {
         msg = '<p><b>Nothing scheduled at the moment - please check back again soon!</b></p>.';

      } else {
        msg += '<table>';
        msg += '<thead>';
        msg += '<tr><th>Course</th><th>Date(s)</th><th>Instructor(s)</th><th>Hour(s)</th></tr>';
        msg += '</thead>';
        msg += '<tbody>';

        var hrefs = new Array();
        for (var i = 0; i < data.length; i++) {
            var href = data[i].enrollmentLink;
            if (hrefs.indexOf(href) == -1) {
                msg += '<tr><td><a href="'+ href + '">'+ data[i].course + '</a></td><td>'+ data[i].dates + '</td><td>'+ data[i].instructors + '</td><td>'+ data[i].hours + '</td></tr>';
                hrefs.push(href);
            }

        }
        msg += '</tbody>';
        msg += '</table>';
      }
  }
  var ociTraining = document.getElementById("ocitraining");
  ociTraining.innerHTML = msg;
});
</script>


<h1 id="gettingStarted">2 Getting Started</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/gettingStarted.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In this guide you are going to build a <a href="http://grails.org">Grails application</a> which will serve as a company intranet backend.
It exposes a JSON API of company announcements.</p>
</div>
<div class="paragraph">
<p>Additionally, you are going to build an <a href="https://developer.android.com/index.html">Android App</a>, the intranet client, which
consumes the JSON API offered by the backend.</p>
</div>
<div class="paragraph">
<p>The guide explores the support of diffent API versions.</p>
</div>


<h2 id="requirements">2.1 What you will need</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/requirements.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To complete this guide, you will need the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE</p>
</li>
<li>
<p>JDK 1.8 or greater installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
</ul>
</div>


<h2 id="howto">2.2 How to complete the guide</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/howto.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To complete this guide, you will need to checkout the source from Github and work through the steps presented by the guide.</p>
</div>
<div class="paragraph">
<p>To get started do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/archive/master.zip">Download</a> and unzip the source or if you already have <a href="https://git-scm.com/">Git</a>: <code>git clone <a href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend.git" class="bare">https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend.git</a></code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_to_follow_the_grails_part">To follow the Grails part:</h3>
<div class="ulist">
<ul>
<li>
<p><code>cd</code> into <code>grails-guides/building-an-android-client-powered-by-a-grails-backend/initial</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternatively, if you already have Grails installed then you can create a new application using the
following command in a Terminal window:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grails create-app intranet.backend.grails-app --profile rest-api
$ cd grails-app</pre>
</div>
</div>
<div class="paragraph">
<p>When the create-app command completes, Grails will create a grails-app directory with an
application configured to create a REST application (due to the use of the parameter profile=rest-api )
and configured to use the hibernate feature with an H2 database.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can go right to the completed Grails example if you <code>cd</code> into <code>grails-guides/building-an-android-client-powered-by-a-grails-backend/complete</code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_to_follow_the_android_part">To follow the Android part:</h3>
<div class="ulist">
<ul>
<li>
<p><code>cd</code> into <code>grails-guides/building-an-android-client-powered-by-a-grails-backend/initial-android</code></p>
</li>
<li>
<p>Head on over to the next section</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternatively, you can create an android app using the New Project Wizard of Android Studio as illustrated in
the next screenshots.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/android-studio-newproject1.png" alt="android studio newproject1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/android-studio-newproject2.png" alt="android studio newproject2">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/android-studio-newproject3.png" alt="android studio newproject3">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/android-studio-newproject4.png" alt="android studio newproject4">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can go right to the completed version 1 of the Android example if you <code>cd</code> into <code>grails-guides/building-an-android-client-powered-by-a-grails-backend/complete-android-v1</code>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can go right to the completed version 2 of the Android example if you <code>cd</code> into <code>grails-guides/building-an-android-client-powered-by-a-grails-backend/complete-android-v2</code>
</td>
</tr>
</table>
</div>
</div>


<h1 id="overview">3 Overview</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/overview.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The next image illustrates the behavior of Android app version 1. The Android app is composed by two Activities.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the Android application initial screen loads, it requests an announcements list.</p>
</li>
<li>
<p>The Grails app sends a JSON payload which includes a list of announcements. For each announcement, a unique identifier, a title and a HTML body are included.</p>
</li>
<li>
<p>The android app renders the JSON Payload in a ListView.</p>
</li>
<li>
<p>The user taps an announcement&#8217;s title and the app transition to a detail screen. The initial screen sends the
detail screen the announcement identifier, title and HTML body. The latter will be rendered in a WebView.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/overview.png" alt="overview">
</div>
</div>


<h1 id="writingTheGrailsApp">4 Writing the Grails Application</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/writingTheGrailsApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Now you are ready to start writing the Grails application.</p>
</div>


<h2 id="domainClass">4.1 Create a Domain Class - Persistent Entities</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/domainClass.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We need to create persistent entities to store company announcements. Grails handles persistence with the use of <a href="https://docs.grails.org/latest/ref/Domain%20Classes/Usage.html">Grails Domain Classes</a>:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A domain class fulfills the M in the Model View Controller (MVC) pattern and represents a persistent entity that is
mapped onto an underlying database table. In Grails a domain is a class that lives in the grails-app/domain directory.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Grails simplifies the creation of domain classes with the <a href="http://docs.grails.org/latest/ref/Command%20Line/create-domain-class.html">create-domain-class command</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"> ./grailsw create-domain-class Announcement
| Resolving Dependencies. Please wait...
CONFIGURE SUCCESSFUL
Total time: 4.53 secs
| Created grails-app/grails/company/intranet/Announcement.groovy
| Created src/test/groovy/grails/company/intranet/AnnouncementSpec.groovy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Just to keep it simple, we assume the company announcements just contain a <em>title</em> and a <em>HTML body</em>.
We are going to modify the domain class generated in the previous step to store that information.</p>
</div>
<div class="listingblock">
<div class="title">grails-app/domain/intranet/backend/Announcement.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend

<span class="type">class</span> <span class="class">Announcement</span> {

    <span class="predefined-type">String</span> title
    <span class="predefined-type">String</span> body

    <span class="directive">static</span> constraints = {
        title <span class="key">size</span>: <span class="integer">0</span>..<span class="integer">255</span>
        body <span class="key">nullable</span>: <span class="predefined-constant">true</span>
    }

    <span class="directive">static</span> mapping = {
        body <span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>  <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>it enables us to store strings with more than 255 characters in the <em>body</em>.</td>
</tr>
</table>
</div>


<h2 id="domainClassTest">4.2 Domain Class Unit Testing</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/domainClassTest.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://docs.grails.org/latest/guide/testing.html">Grails makes testing easier</a> from low-level unit testing to high
level functional tests.</p>
</div>
<div class="paragraph">
<p>We are going to test the constraints we defined in the Announcement domain Class in constraints property. In particular
nullability and length of both <code>title</code> and <code>body</code> properties.</p>
</div>
<div class="listingblock">
<div class="title">src/test/groovy/intranet/backend/AnnouncementSpec.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend

<span class="keyword">import</span> <span class="include">grails.testing.gorm.DomainUnitTest</span>
<span class="keyword">import</span> <span class="include">spock.lang.Specification</span>

        <span class="key">expect</span>:
        <span class="keyword">new</span> Announcement(<span class="key">body</span>: <span class="predefined-constant">null</span>).validate([<span class="string"><span class="delimiter">'</span><span class="content">body</span><span class="delimiter">'</span></span>])
    }

    <span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test title can not be null</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">expect</span>:
        !<span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="predefined-constant">null</span>).validate([<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>])
    }

    <span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test body can have a more than 255 characters</span><span class="delimiter">&quot;</span></span>() {

        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">for a string of 256 characters</span><span class="delimiter">'</span></span>
        <span class="predefined-type">String</span> str = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
        <span class="integer">256</span>.times { str += <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span> }

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">body validation passes</span><span class="delimiter">'</span></span>
        <span class="keyword">new</span> Announcement(<span class="key">body</span>: str).validate([<span class="string"><span class="delimiter">'</span><span class="content">body</span><span class="delimiter">'</span></span>])
    }

    <span class="type">void</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test title can have a maximum of 255 characters</span><span class="delimiter">&quot;</span></span>() {

        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">for a string of 256 characters</span><span class="delimiter">'</span></span>
        <span class="predefined-type">String</span> str = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
        <span class="integer">256</span>.times { str += <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span> }

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">title validation fails</span><span class="delimiter">'</span></span>
        !<span class="keyword">new</span> Announcement(<span class="key">title</span>: str).validate([<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>])

        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">for a string of 256 characters</span><span class="delimiter">'</span></span>
        str = <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>
        <span class="integer">255</span>.times { str += <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span> }

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">title validation passes</span><span class="delimiter">'</span></span>
        <span class="keyword">new</span> Announcement(<span class="key">title</span>: str).validate([<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>])
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can run the every test, including the one we just created, with the command test_app</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"> ./grailsw test-app
 | Resolving Dependencies. Please wait...
 CONFIGURE SUCCESSFUL
 Total time: 2.534 secs
 :complete:compileJava UP-TO-DATE
 :complete:compileGroovy
 :complete:buildProperties
 :complete:processResources
 :complete:classes
 :complete:compileTestJava UP-TO-DATE
 :complete:compileTestGroovy
 :complete:processTestResources UP-TO-DATE
 :complete:testClasses
 :complete:test
 :complete:compileIntegrationTestJava UP-TO-DATE
 :complete:compileIntegrationTestGroovy UP-TO-DATE
 :complete:processIntegrationTestResources UP-TO-DATE
 :complete:integrationTestClasses UP-TO-DATE
 :complete:integrationTest UP-TO-DATE
 :complete:mergeTestReports

 BUILD SUCCESSFUL

 | Tests PASSED</code></pre>
</div>
</div>


<h2 id="versioning">4.3 Versioning</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/versioning.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>It is important to think about API versioning from the beginning, especially when you create an API
consumed by mobile phone applications. Users will run different versions of the app, and you will need to version
your API to create advanced functionality but keep supporting legacy versions.</p>
</div>
<div class="paragraph">
<p>Grails allows multiple ways to <a href="http://docs.grails.org/latest/guide/webServices.html#versioningResources">Version REST Resources</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the URI</p>
</li>
<li>
<p>Using the Accept-Version Header</p>
</li>
<li>
<p>Using Hypermedia/Mime Types</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this guide we are going to version the API using the <code>Accept-Version</code> HTTP header.</p>
</div>
<div class="paragraph">
<p>Devices running version 1.0 will invoke the <em>announcements</em> enpoint passing the 1.0 in the Accept Version Header.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Accept-Version: 1.0&quot; -X GET http://localhost:8080/announcements</code></pre>
</div>
</div>
<div class="paragraph">
<p>Devices running version 2.0 will invoke the <em>announcements</em> enpoint passing the 2.0 in the Accept Version Header.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Accept-Version: 2.0&quot; -X GET http://localhost:8080/announcements</code></pre>
</div>
</div>


<h2 id="v1Controller">4.4 Create a Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/v1Controller.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We create a <em>Controller</em> for the <em>Domain class</em> we previously created. Our Controller extends  <a href="http://docs.grails.org/latest/guide/webServices.html#restfulControllers">RestfulController</a>. This
will provide us RESTful functionality to list, create, update and delete <code>Announcement</code> resources using
different HTTP  Methods.</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/intranet/backend/v1/AnnouncementController.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend.v1

<span class="keyword">import</span> <span class="include">grails.rest.RestfulController</span>
<span class="keyword">import</span> <span class="include">intranet.backend.Announcement</span>

<span class="type">class</span> <span class="class">AnnouncementController</span> <span class="directive">extends</span> RestfulController&lt;Announcement&gt; {
    <span class="directive">static</span> namespace = <span class="string"><span class="delimiter">'</span><span class="content">v1</span><span class="delimiter">'</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">static</span> responseFormats = [<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>] <i class="conum" data-value="2"></i><b>(2)</b>

    AnnouncementController() {
        <span class="local-variable">super</span>(Announcement)
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>this controller will handle v1 of our api</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>we want to respond only JSON Payloads</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_url_mapping">Url Mapping</h3>
<div class="paragraph">
<p>We want our endpoint to listen in <code>/announcements</code> instead of <code>/announcement</code>. Moreover, we want the previous controller for
which we declared a namespace of v1 to handle the requests with the Accept-Version Http Header set to 1.0.</p>
</div>
<div class="paragraph">
<p>Grails enables powerful <a href="http://docs.grails.org/latest/guide/theWebLayer.html#urlmappingss">URL mapping</a> configuration to
do that. Add the next line to the mappings closure:</p>
</div>
<div class="listingblock">
<div class="title">/grails-app/controllers/intranet/backend/UrlMappings.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">        get <span class="string"><span class="delimiter">&quot;</span><span class="content">/announcements</span><span class="delimiter">&quot;</span></span>(<span class="key">version</span>:<span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>, <span class="key">controller</span>: <span class="string"><span class="delimiter">'</span><span class="content">announcement</span><span class="delimiter">'</span></span>, <span class="key">namespace</span>:<span class="string"><span class="delimiter">'</span><span class="content">v1</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>


<h2 id="bootstrap">4.5 Loading test data</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/bootstrap.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We are going to populate the database with several announcements when the application startups.</p>
</div>
<div class="paragraph">
<p>In order to do that, we edit <em>grails-app/init/grails/company/intranet/BootStrap.groovy</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> grails.company.intranet

<span class="type">class</span> <span class="class">BootStrap</span> {

    <span class="keyword">def</span> init = { servletContext -&gt;
        announcements().each { <span class="local-variable">it</span>.save() }
    }
    <span class="keyword">def</span> destroy = {
    }

    <span class="directive">static</span> <span class="predefined-type">List</span>&lt;Announcement&gt; announcements() {
        [
                <span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Grails Quickcast #1: Grails Interceptors</span><span class="delimiter">'</span></span>),
                <span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Grails Quickcast #2: JSON Views</span><span class="delimiter">'</span></span>)
        ]
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Announcements in the previous code snippet don&#8217;t contain <em>body</em> content
to keep the code sample small. Checkout <code>grails-app/init/intranet/backend/BootStrap.groovy</code> to see the complete code.
</td>
</tr>
</table>
</div>


<h2 id="v1FunctionalTests">4.6 Functional tests</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/v1FunctionalTests.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://docs.grails.org/latest/guide/testing.html#functionalTesting">Functional Tests</a> involve making HTTP
requests against the running application and verifying the resultant behavior.</p>
</div>
<div class="paragraph">
<p>We use the <a href="https://github.com/grails-plugins/grails-rest-client-builder">Rest Client Builder Grails Plugin</a> whose
dependency is added when we create an app with the <em>rest-api</em> profile.</p>
</div>
<div class="paragraph">
<p>/home/runner/work/building-an-android-client-powered-by-a-grails-backend/building-an-android-client-powered-by-a-grails-backend/complete</p>
</div>
<div class="listingblock">
<div class="title">/src/integration-test/groovy/intranet/backend/AnnouncementControllerSpec.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend

<span class="keyword">import</span> <span class="include">grails.testing.mixin.integration.Integration</span>
<span class="keyword">import</span> <span class="include">grails.testing.spock.OnceBefore</span>
<span class="keyword">import</span> <span class="include">grails.web.http.HttpHeaders</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.HttpRequest</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.HttpResponse</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.HttpStatus</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.client.HttpClient</span>
<span class="keyword">import</span> <span class="include">spock.lang.AutoCleanup</span>
<span class="keyword">import</span> <span class="include">spock.lang.Shared</span>
<span class="keyword">import</span> <span class="include">spock.lang.Specification</span>


<span class="annotation">@Integration</span>
<span class="type">class</span> <span class="class">AnnouncementControllerSpec</span> <span class="directive">extends</span> Specification {

    <span class="annotation">@Shared</span>
    <span class="annotation">@AutoCleanup</span>
    HttpClient client

    <span class="annotation">@OnceBefore</span>
    <span class="type">void</span> init() {
        <span class="predefined-type">String</span> baseUrl = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:</span><span class="inline"><span class="inline-delimiter">$</span>serverPort</span><span class="delimiter">&quot;</span></span>
        <span class="local-variable">this</span>.client  = HttpClient.create(baseUrl.toURL())
    }

    <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test body is present in announcements json payload of Api 1.0</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">given</span>:
        HttpRequest request = HttpRequest.GET(<span class="string"><span class="delimiter">&quot;</span><span class="content">/announcements/</span><span class="delimiter">&quot;</span></span>).header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Accept-Version</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>)

        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Requesting announcements for version 1.0</span><span class="delimiter">'</span></span>
        HttpResponse&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&gt;&gt; resp = client.toBlocking().exchange(request, <span class="predefined-type">List</span>) <i class="conum" data-value="1"></i><b>(1)</b>

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">the request was successful</span><span class="delimiter">'</span></span>
        resp.status == HttpStatus.OK <i class="conum" data-value="3"></i><b>(3)</b>

        <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">the response is a JSON Payload</span><span class="delimiter">'</span></span>
        <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">json payload contains the complete announcement</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>serverPort is automatically injected. It contains the random port where the grails application runs during the functional test</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Pass the api version as an Http header</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Verify the response code is 200; OK</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Body is present in the JSON paylod</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Grails command <em>test-app</em> runs unit, integration and functional tests.</p>
</div>


<h2 id="runningTheApp">4.7 Running the Application</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/runningTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To run the application use the <code>./gradlew bootRun</code> command which will start the application on port 8080.</p>
</div>


<h1 id="writingTheAndroidApp">5 Writing the Android Application</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/writingTheAndroidApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="androidOverview">5.1 Fetching the Announcements</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/androidOverview.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Next image illustrates the classes involved in the fetching and rendering of the announcements exposed by the Grails application.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/android-announcements-overview.png" alt="android announcements overview">
</div>
</div>


<h2 id="networkingCode">5.2 Networking code</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/networkingCode.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We have a class where serveral constants are initialized:</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/network/Constants.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.network</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Constants</span> {
    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> GRAILS_APP_URL = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://192.168.1.42:8080/</span><span class="delimiter">&quot;</span></span>; <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> ANNOUNCEMENTS_PATH = <span class="string"><span class="delimiter">&quot;</span><span class="content">announcements</span><span class="delimiter">&quot;</span></span>; <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> ACCEPT_VERSION = <span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>; <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Grails App server url.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The path we configured in the Grails app in <em>UrlMappings.groovy</em></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The version of the API</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You may need to change the ip address to match your local machine.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_model">Model</h3>
<div class="paragraph">
<p>The announcements sent by the server are gonna be rendered into this POJO:</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/network/model/Announcement.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.network.model</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Announcement</span> {
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;
    <span class="directive">private</span> <span class="predefined-type">String</span> title;
    <span class="directive">private</span> <span class="predefined-type">String</span> body;

    <span class="directive">public</span> <span class="predefined-type">Long</span> getId() {
        <span class="keyword">return</span> id;
    }

    <span class="directive">public</span> <span class="type">void</span> setId(<span class="predefined-type">Long</span> id) {
        <span class="local-variable">this</span>.id = id;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getTitle() {
        <span class="keyword">return</span> title;
    }

    <span class="directive">public</span> <span class="type">void</span> setTitle(<span class="predefined-type">String</span> title) {
        <span class="local-variable">this</span>.title = title;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getBody() {
        <span class="keyword">return</span> body;
    }

    <span class="directive">public</span> <span class="type">void</span> setBody(<span class="predefined-type">String</span> body) {
        <span class="local-variable">this</span>.body = body;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_networking_dependencies">Networking Dependencies</h3>
<div class="paragraph">
<p>You will need to add INTERNET permission to <em>app/src/main/AndroidManifest.xml</em></p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/AndroidManifest.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    <span class="tag">&lt;uses-permission</span> <span class="attribute-name">android:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">android.permission.INTERNET</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_okhttp">OkHttp</h4>
<div class="paragraph">
<p>We are going to use one of the most popular http clients for Android, <a href="http://square.github.io/okhttp/">OkHttp</a></p>
</div>
<div class="paragraph">
<p>To add OkHttp as a dependency, edit the file <em>app/build.gradle</em> and add, in the
dependencies block, the next line:</p>
</div>
<div class="listingblock">
<div class="title">/app/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    implementation <span class="string"><span class="delimiter">'</span><span class="content">com.squareup.okhttp3:okhttp:4.2.2</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gson">Gson</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><a href="https://github.com/google/gson">Gson</a> is a Java library that can be used to convert Java Objects into their JSON
representation. It can also be used to convert a JSON string to an equivalent
Java object.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>To add Gson as a dependency, edit the file <em>app/build.gradle</em> and add, in the
dependencies block, the next line:</p>
</div>
<div class="listingblock">
<div class="title">/app/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    implementation <span class="string"><span class="delimiter">'</span><span class="content">com.google.code.gson:gson:2.8.6</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We are going to encapsulate the instantiation of OkHttp Request in a class to ensure the Accept-Version Http header is
always set with the value defined in the <em>Constants.java</em> class</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/network/NetworkTask.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.network</span>;

<span class="keyword">import</span> <span class="include">okhttp3.Request</span>;

<span class="type">class</span> <span class="class">NetworkTask</span> {
    <span class="directive">static</span> Request requestWithUrl(<span class="predefined-type">String</span> url) {
        <span class="keyword">return</span> <span class="keyword">new</span> Request.Builder()
                .url(url)
                .header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Accept-Version</span><span class="delimiter">&quot;</span></span>, Constants.ACCEPT_VERSION)
                .build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next class fetches and returns a list of Announcements.</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/network/AnnouncementsFetcher.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.network</span>;

<span class="keyword">import</span> <span class="include">android.util.Log</span>;

<span class="keyword">import</span> <span class="include">com.google.gson.Gson</span>;
<span class="keyword">import</span> <span class="include">com.google.gson.reflect.TypeToken</span>;

<span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="keyword">import</span> <span class="include">java.lang.reflect.Type</span>;
<span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;
<span class="keyword">import</span> <span class="include">okhttp3.OkHttpClient</span>;
<span class="keyword">import</span> <span class="include">okhttp3.Request</span>;
<span class="keyword">import</span> <span class="include">okhttp3.Response</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">AnnouncementsFetcher</span> {

    <span class="directive">private</span> <span class="directive">final</span> <span class="directive">static</span> <span class="predefined-type">String</span> TAG = AnnouncementsFetcher.class.getSimpleName();

    <span class="directive">private</span> OkHttpClient client = <span class="keyword">new</span> OkHttpClient();
    <span class="directive">private</span> <span class="directive">final</span> Gson gson = <span class="keyword">new</span> Gson();

    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Announcement&gt; fetchAnnouncements() {
        <span class="predefined-type">Type</span> listType = <span class="keyword">new</span> TypeToken&lt;<span class="predefined-type">List</span>&lt;Announcement&gt;&gt;() {}.getType();
        <span class="keyword">try</span> {
            <span class="predefined-type">String</span> url = Constants.GRAILS_APP_URL + Constants.ANNOUNCEMENTS_PATH;
            <span class="predefined-type">String</span> jsonString = fetchAnnouncementsJsonString(url);
            <span class="keyword">return</span> gson.fromJson(jsonString, listType);

        } <span class="keyword">catch</span> (<span class="exception">IOException</span> e) {
            Log.e(TAG, e.toString());
            <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
        }
    }

    <span class="directive">private</span> <span class="predefined-type">String</span> fetchAnnouncementsJsonString(<span class="predefined-type">String</span> url) <span class="directive">throws</span> <span class="exception">IOException</span> {
        Request request = NetworkTask.requestWithUrl(url);
        Response response = client.newCall(request).execute();
        <span class="keyword">return</span> response.body().string();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to avoid running networking code in the UI thread we are going to encapsulate the networking code in an
<a href="https://developer.android.com/reference/android/os/AsyncTask.html">AsyncTask</a></p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/asynctasks/RetrieveAnnouncementsTask.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.asynctasks</span>;

<span class="keyword">import</span> <span class="include">android.os.AsyncTask</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="keyword">import</span> <span class="include">intranet.client.android.delegates.RetrieveAnnouncementsDelegate</span>;
<span class="keyword">import</span> <span class="include">intranet.client.network.AnnouncementsFetcher</span>;
<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">RetrieveAnnouncementsTask</span> <span class="directive">extends</span> AsyncTask&lt;<span class="predefined-type">Void</span>, <span class="predefined-type">Void</span>, <span class="predefined-type">List</span>&lt;Announcement&gt;&gt; {

    <span class="directive">private</span> AnnouncementsFetcher fetcher = <span class="keyword">new</span> AnnouncementsFetcher();
    <span class="directive">private</span> RetrieveAnnouncementsDelegate delegate;

    <span class="directive">public</span> RetrieveAnnouncementsTask(RetrieveAnnouncementsDelegate delegate) {
        <span class="local-variable">this</span>.delegate = delegate;
    }

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;Announcement&gt; doInBackground(<span class="predefined-type">Void</span>... voids) {
        <span class="keyword">return</span> fetcher.fetchAnnouncements();
    }

    <span class="directive">protected</span> <span class="type">void</span> onPostExecute(<span class="predefined-type">List</span>&lt;Announcement&gt; announcements) {
        <span class="keyword">if</span> ( delegate != <span class="predefined-constant">null</span> ) {
            delegate.onAnnouncementsFetched(announcements);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once we get a list of announcements, we will communicate the response to classes implementing the delegate</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/delegates/RetrieveAnnouncementsDelegate.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.delegates</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">RetrieveAnnouncementsDelegate</span> {
    <span class="type">void</span> onAnnouncementsFetched(<span class="predefined-type">List</span>&lt;Announcement&gt; announcements);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class which implements the delegate receiving the announcements is the initial Activity</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/activities/MainActivity.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.activities</span>;

<span class="keyword">import</span> <span class="include">android.app.Activity</span>;
<span class="keyword">import</span> <span class="include">android.content.Intent</span>;
<span class="keyword">import</span> <span class="include">android.os.Bundle</span>;
<span class="keyword">import</span> <span class="include">android.widget.ListView</span>;

<span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="keyword">import</span> <span class="include">intranet.client.R</span>;
<span class="keyword">import</span> <span class="include">intranet.client.android.adapters.AnnouncementAdapter</span>;
<span class="keyword">import</span> <span class="include">intranet.client.android.asynctasks.RetrieveAnnouncementsTask</span>;
<span class="keyword">import</span> <span class="include">intranet.client.android.delegates.AnnouncementAdapterDelegate</span>;
<span class="keyword">import</span> <span class="include">intranet.client.android.delegates.RetrieveAnnouncementsDelegate</span>;
<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MainActivity</span> <span class="directive">extends</span> Activity
        <span class="directive">implements</span> RetrieveAnnouncementsDelegate, AnnouncementAdapterDelegate {

    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> EXTRA_ID = <span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> EXTRA_TITLE = <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">public</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> EXTRA_BODY = <span class="string"><span class="delimiter">&quot;</span><span class="content">body</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">private</span> AnnouncementAdapter adapter;

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> onCreate(Bundle savedInstanceState) {
        <span class="local-variable">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        <span class="predefined-type">ListView</span> announcementsListView = (<span class="predefined-type">ListView</span>) findViewById(R.id.announcementsListView);
        adapter = <span class="keyword">new</span> AnnouncementAdapter(<span class="local-variable">this</span>, <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;Announcement&gt;(), <span class="local-variable">this</span>);
        announcementsListView.setAdapter(adapter);

        <span class="keyword">new</span> RetrieveAnnouncementsTask(<span class="local-variable">this</span>).execute(); <i class="conum" data-value="1"></i><b>(1)</b>
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> onAnnouncementsFetched(<span class="predefined-type">List</span>&lt;Announcement&gt; announcements) {  <i class="conum" data-value="2"></i><b>(2)</b>
        adapter.clear();
        adapter.addAll(announcements);
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> onAnnouncementTapped(Announcement announcement) {
        segueToAnnouncementActivity(announcement);
    }

    <span class="directive">private</span> <span class="type">void</span> segueToAnnouncementActivity(Announcement announcement) {
        Intent i = <span class="keyword">new</span> Intent(<span class="local-variable">this</span>, AnnouncementActivity.class);
        i.putExtra(EXTRA_ID, announcement.getId());
        i.putExtra(EXTRA_TITLE, announcement.getTitle());
        i.putExtra(EXTRA_BODY, announcement.getBody());
        startActivity(i);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Triggers the async tasks to fetch the announcements asynchronously.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Refreshes the UI once we get a list of announcements</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>MainActivity uses a ListView defined in:</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/res/layout/activity_main.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="tag">&lt;RelativeLayout</span> <span class="attribute-name">xmlns:android</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://schemas.android.com/apk/res/android</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:tools</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://schemas.android.com/tools</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@+id/activity_main</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:layout_width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:layout_height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingBottom</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_vertical_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingLeft</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_horizontal_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingRight</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_horizontal_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingTop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_vertical_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">tools:context</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">grails.company.client.intranet.client.MainActivity</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;ListView</span>
        <span class="attribute-name">android:id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@+id/announcementsListView</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;/ListView&gt;</span>

<span class="tag">&lt;/RelativeLayout&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next classes and layout files render the different announcements in a ListView and handle the user tap.</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/adapters/AnnouncementAdapter.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.adapters</span>;

<span class="keyword">import</span> <span class="include">android.content.Context</span>;
<span class="keyword">import</span> <span class="include">android.view.LayoutInflater</span>;
<span class="keyword">import</span> <span class="include">android.view.View</span>;
<span class="keyword">import</span> <span class="include">android.view.ViewGroup</span>;
<span class="keyword">import</span> <span class="include">android.widget.ArrayAdapter</span>;
<span class="keyword">import</span> <span class="include">android.widget.TextView</span>;

<span class="keyword">import</span> <span class="include">java.util.List</span>;

<span class="keyword">import</span> <span class="include">androidx.annotation.NonNull</span>;
<span class="keyword">import</span> <span class="include">intranet.client.R</span>;
<span class="keyword">import</span> <span class="include">intranet.client.android.delegates.AnnouncementAdapterDelegate</span>;
<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">AnnouncementAdapter</span> <span class="directive">extends</span> ArrayAdapter&lt;Announcement&gt; {
    <span class="directive">private</span> AnnouncementAdapterDelegate delegate;

    <span class="directive">public</span> AnnouncementAdapter(<span class="predefined-type">Context</span> context, <span class="predefined-type">List</span>&lt;Announcement&gt; announcements, AnnouncementAdapterDelegate delegate) {
        <span class="local-variable">super</span>(context, <span class="integer">0</span>, announcements);
        <span class="local-variable">this</span>.delegate = delegate;
    }

    <span class="annotation">@NonNull</span>
    <span class="directive">public</span> <span class="predefined-type">View</span> getView(<span class="type">int</span> position, <span class="predefined-type">View</span> convertView, <span class="annotation">@NonNull</span> ViewGroup parent) {
        <span class="keyword">if</span> (convertView == <span class="predefined-constant">null</span>) {
            convertView = LayoutInflater.from(getContext()).inflate(R.layout.item_announcement, parent, <span class="predefined-constant">false</span>);
        }
        TextView tvTitle = (TextView) convertView.findViewById(R.id.tvTitle);
        Announcement announcement = getItem(position);
        <span class="keyword">if</span> ( announcement != <span class="predefined-constant">null</span> ) {
            tvTitle.setText(announcement.getTitle());
            tvTitle.setOnClickListener(<span class="keyword">new</span> AnnouncementClickListener(announcement));
        }
        <span class="keyword">return</span> convertView;
    }

    <span class="directive">private</span> <span class="type">class</span> <span class="class">AnnouncementClickListener</span> <span class="directive">implements</span> <span class="predefined-type">View</span>.OnClickListener {
        <span class="directive">private</span> Announcement announcement;

        AnnouncementClickListener(Announcement announcement) {
            <span class="local-variable">this</span>.announcement = announcement;
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">void</span> onClick(<span class="predefined-type">View</span> view) {
            <span class="keyword">if</span> ( delegate != <span class="predefined-constant">null</span> ) {
                delegate.onAnnouncementTapped(announcement);
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/delegates/AnnouncementAdapterDelegate.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.delegates</span>;

<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">AnnouncementAdapterDelegate</span> {
    <span class="type">void</span> onAnnouncementTapped(Announcement announcement);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/app/src/main/res/layout/item_announcement.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;LinearLayout</span> <span class="attribute-name">xmlns:android</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://schemas.android.com/apk/res/android</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:layout_width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:layout_height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
    <span class="tag">&lt;TextView</span>
        <span class="attribute-name">android:id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@+id/tvTitle</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:paddingTop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_vertical_margin</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:paddingBottom</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_vertical_margin</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">wrap_content</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">wrap_content</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/LinearLayout&gt;</span></code></pre>
</div>
</div>
</div>
</div>


<h2 id="detailActivity">5.3 Detail Activity</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/detailActivity.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>When the user taps an announcement, the announcement is transmited using <a href="https://developer.android.com/reference/android/content/Intent.html">Android Intent Extras</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/extras.png" alt="extras">
</div>
</div>
<div class="paragraph">
<p>You will need to add a second activity two the manifest.</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/AndroidManifest.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">        <span class="tag">&lt;activity</span> <span class="attribute-name">android:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">.android.activities.AnnouncementActivity</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/activities/AnnouncementActivity.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.activities</span>;

<span class="keyword">import</span> <span class="include">android.app.Activity</span>;
<span class="keyword">import</span> <span class="include">android.content.Intent</span>;
<span class="keyword">import</span> <span class="include">android.os.Bundle</span>;
<span class="keyword">import</span> <span class="include">android.webkit.WebView</span>;
<span class="keyword">import</span> <span class="include">android.widget.TextView</span>;

<span class="keyword">import</span> <span class="include">intranet.client.R</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">AnnouncementActivity</span> <span class="directive">extends</span> Activity {

    <span class="directive">private</span> TextView tvTitle;
    <span class="directive">private</span> WebView wvBody;

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> onCreate(Bundle savedInstanceState) {
        <span class="local-variable">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_announcement);

        tvTitle = (TextView) findViewById(R.id.tvTitle);
        wvBody = (WebView) findViewById(R.id.wvBody);
        populateUi();
    }

    <span class="directive">private</span> <span class="type">void</span> populateUi() {
        Intent intent = getIntent();
        <span class="directive">final</span> <span class="predefined-type">String</span> title = intent.getStringExtra(MainActivity.EXTRA_TITLE);
        <span class="directive">final</span> <span class="predefined-type">String</span> body = intent.getStringExtra(MainActivity.EXTRA_BODY);
        populateUiWithTitleAndBody(title, body);
    }

    <span class="directive">private</span> <span class="type">void</span> populateUiWithTitleAndBody(<span class="directive">final</span> <span class="predefined-type">String</span> title, <span class="directive">final</span> <span class="predefined-type">String</span> body) {
        tvTitle.setText(title);
        <span class="directive">final</span> <span class="predefined-type">String</span> mime = <span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>;
        <span class="directive">final</span> <span class="predefined-type">String</span> encoding = <span class="string"><span class="delimiter">&quot;</span><span class="content">utf-8</span><span class="delimiter">&quot;</span></span>;
        wvBody.loadDataWithBaseURL(<span class="predefined-constant">null</span>, body, mime, encoding, <span class="predefined-constant">null</span>);
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/app/src/main/res/layout/activity_announcement.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="tag">&lt;RelativeLayout</span> <span class="attribute-name">xmlns:android</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://schemas.android.com/apk/res/android</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:tools</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://schemas.android.com/tools</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@+id/activity_main</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:layout_width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:layout_height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingBottom</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_vertical_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingLeft</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_horizontal_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingRight</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_horizontal_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">android:paddingTop</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@dimen/activity_vertical_margin</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">tools:context</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">grails.company.client.intranet.client.MainActivity</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;TextView</span>
        <span class="attribute-name">android:id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@+id/tvTitle</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">tools:text</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Announcement Title</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:textSize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">20dp</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">match_parent</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">wrap_content</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

    <span class="tag">&lt;WebView</span>
        <span class="attribute-name">android:id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@+id/wvBody</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_below</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">@+id/tvTitle</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">wrap_content</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">android:layout_height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">wrap_content</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

<span class="tag">&lt;/RelativeLayout&gt;</span></code></pre>
</div>
</div>


<h1 id="version2">6 API version 2.0</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/version2.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The problem with the first version of the API is that we include every announcement
body in the payload used to displayed the list. An announcement&#8217;s body can be a large block of HTML.
A user will probably just wants to check a couple of announcements. It will save bandwidth and
make the app faster if we don&#8217;t send the announcement body in the initial request. Instead, we will ask
the API for a complete announcement (including <code>body</code>) once the user taps the announcement.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/version2overview.png" alt="version2overview">
</div>
</div>


<h2 id="v2Controller">6.1 Grails V2 Changes</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/v2Controller.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We are going to use create Controller to handle the version 2 of the API. We are going to use a Criteria
query with a projection to fetch only the id and title of the announcements.</p>
</div>
<div class="listingblock">
<div class="title">grails-app/controllers/intranet/backend/v2/AnnouncementController.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend.v2

<span class="keyword">import</span> <span class="include">grails.rest.RestfulController</span>
<span class="keyword">import</span> <span class="include">intranet.backend.Announcement</span>

<span class="type">class</span> <span class="class">AnnouncementController</span> <span class="directive">extends</span> RestfulController&lt;Announcement&gt; {
    <span class="directive">static</span> namespace = <span class="string"><span class="delimiter">'</span><span class="content">v2</span><span class="delimiter">'</span></span>
    <span class="directive">static</span> responseFormats = [<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>]

    <span class="keyword">def</span> announcementService

    AnnouncementController() {
        <span class="local-variable">super</span>(Announcement)
    }

    <span class="keyword">def</span> <span class="function">index</span>(<span class="predefined-type">Integer</span> max) {
        params.max = <span class="predefined-type">Math</span>.min(max ?: <span class="integer">10</span>, <span class="integer">100</span>)
        <span class="keyword">def</span> announcements = announcementService.findAllIdAndTitleProjections(params)
        respond announcements, <span class="key">model</span>: [(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>resourceName<span class="inline-delimiter">}</span></span><span class="content">Count</span><span class="delimiter">&quot;</span></span>.toString()): countResources()]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We encapsulate the querying in a service</p>
</div>
<div class="listingblock">
<div class="title">grails-app/services/intranet/backend/AnnouncementService.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend

<span class="keyword">import</span> <span class="include">grails.gorm.transactions.Transactional</span>

<span class="annotation">@Transactional</span>(readOnly = <span class="predefined-constant">true</span>)
<span class="type">class</span> <span class="class">AnnouncementService</span> {

    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&gt; findAllIdAndTitleProjections(<span class="predefined-type">Map</span> params) {
        <span class="keyword">def</span> c = Announcement.createCriteria()
        <span class="keyword">def</span> announcements = c.list(params) {
            projections {
                property(<span class="string"><span class="delimiter">'</span><span class="content">id</span><span class="delimiter">'</span></span>)
                property(<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>)
            }
        }.collect { [<span class="key">id</span>: <span class="local-variable">it</span>[<span class="integer">0</span>], <span class="key">title</span>: <span class="local-variable">it</span>[<span class="integer">1</span>]] } <span class="keyword">as</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&gt;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and we test it:</p>
</div>
<div class="listingblock">
<div class="title">/src/test/groovy/intranet/backend/AnnouncementServiceSpec.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend

<span class="keyword">import</span> <span class="include">grails.test.hibernate.HibernateSpec</span>
<span class="keyword">import</span> <span class="include">grails.testing.services.ServiceUnitTest</span>

<span class="type">class</span> <span class="class">AnnouncementServiceSpec</span> <span class="directive">extends</span> HibernateSpec <span class="directive">implements</span> ServiceUnitTest&lt;AnnouncementService&gt; {

    <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test criteria query with projection returns a list of maps</span><span class="delimiter">&quot;</span></span>() {

        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Save some announcements</span><span class="delimiter">'</span></span>
        [<span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Grails Quickcast #1: Grails Interceptors</span><span class="delimiter">'</span></span>),
        <span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Grails Quickcast #2: JSON Views</span><span class="delimiter">'</span></span>),
        <span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Grails Quickcast #3: Multi-Project Builds</span><span class="delimiter">'</span></span>),
        <span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Grails Quickcast #4: Angular Scaffolding</span><span class="delimiter">'</span></span>),
        <span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Retrieving Runtime Config Values In Grails 3</span><span class="delimiter">'</span></span>),
        <span class="keyword">new</span> Announcement(<span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Developing Grails 3 Applications With IntelliJ IDEA</span><span class="delimiter">'</span></span>)].each {
            <span class="local-variable">it</span>.save()
        }

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">announcements are saved</span><span class="delimiter">'</span></span>
        Announcement.count() == <span class="integer">6</span>

        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">fetching the projection</span><span class="delimiter">'</span></span>
        <span class="keyword">def</span> resp = service.findAllIdAndTitleProjections([:])

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">there are six maps in the response</span><span class="delimiter">'</span></span>
        resp
        resp.size() == <span class="integer">6</span>

        <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">the maps contain only id and title</span><span class="delimiter">'</span></span>
        resp.each {
            <span class="local-variable">it</span>.keySet() == [<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">id</span><span class="delimiter">'</span></span>] <span class="keyword">as</span> <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt;
         }

        <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">non empty values</span><span class="delimiter">'</span></span>
        resp.each {
            <span class="keyword">assert</span> <span class="local-variable">it</span>.title
            <span class="keyword">assert</span> <span class="local-variable">it</span>.id
        }

    }
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_url_mapping">Url Mapping</h3>
<div class="paragraph">
<p>We need to map the version <em>2.0</em> of the Accept-Header to the namespace <em>v2</em></p>
</div>
<div class="listingblock">
<div class="title">/grails-app/controllers/intranet/backend/UrlMappings.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">        get <span class="string"><span class="delimiter">&quot;</span><span class="content">/announcements</span><span class="delimiter">&quot;</span></span>(<span class="key">version</span>:<span class="string"><span class="delimiter">'</span><span class="content">2.0</span><span class="delimiter">'</span></span>, <span class="key">controller</span>: <span class="string"><span class="delimiter">'</span><span class="content">announcement</span><span class="delimiter">'</span></span>, <span class="key">namespace</span>:<span class="string"><span class="delimiter">'</span><span class="content">v2</span><span class="delimiter">'</span></span>)
        get <span class="string"><span class="delimiter">&quot;</span><span class="content">/announcements/</span><span class="inline"><span class="inline-delimiter">$</span>id</span><span class="content">(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span>(<span class="key">version</span>:<span class="string"><span class="delimiter">'</span><span class="content">2.0</span><span class="delimiter">'</span></span>, <span class="key">controller</span>: <span class="string"><span class="delimiter">'</span><span class="content">announcement</span><span class="delimiter">'</span></span>, <span class="key">action</span>: <span class="string"><span class="delimiter">'</span><span class="content">show</span><span class="delimiter">'</span></span>, <span class="key">namespace</span>:<span class="string"><span class="delimiter">'</span><span class="content">v2</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
</div>


<h2 id="v2FunctionalTests">6.2 Api 2.0 Functional tests</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/v2FunctionalTests.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We want to test the Api version 2.0 does not include the body property when receiving a GET request to the <em>announcements</em>
endpoint. The next functional test verifies that behaviour.</p>
</div>
<div class="paragraph">
<p>/home/runner/work/building-an-android-client-powered-by-a-grails-backend/building-an-android-client-powered-by-a-grails-backend/complete</p>
</div>
<div class="listingblock">
<div class="title">/src/integration-test/groovy/intranet/backend/AnnouncementControllerSpec.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> intranet.backend

<span class="keyword">import</span> <span class="include">grails.testing.mixin.integration.Integration</span>
<span class="keyword">import</span> <span class="include">grails.testing.spock.OnceBefore</span>
<span class="keyword">import</span> <span class="include">grails.web.http.HttpHeaders</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.HttpRequest</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.HttpResponse</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.HttpStatus</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.client.HttpClient</span>
<span class="keyword">import</span> <span class="include">spock.lang.AutoCleanup</span>
<span class="keyword">import</span> <span class="include">spock.lang.Shared</span>
<span class="keyword">import</span> <span class="include">spock.lang.Specification</span>


<span class="annotation">@Integration</span>
        resp.headers.getFirst(HttpHeaders.CONTENT_TYPE).get() == <span class="string"><span class="delimiter">'</span><span class="content">application/json;charset=UTF-8</span><span class="delimiter">'</span></span>

        <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">json payload contains an array of annoucements with id, title and body</span><span class="delimiter">'</span></span>
        resp.body().each {
            <span class="keyword">assert</span> <span class="local-variable">it</span>.id
            <span class="keyword">assert</span> <span class="local-variable">it</span>.title
            <span class="keyword">assert</span> <span class="local-variable">it</span>.body <i class="conum" data-value="4"></i><b>(4)</b>
        }
    }

    <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">test body is NOT present in announcements json payload of Api 2.0</span><span class="delimiter">&quot;</span></span>() {
        <span class="key">given</span>:
        HttpRequest request = HttpRequest.GET(<span class="string"><span class="delimiter">&quot;</span><span class="content">/announcements/</span><span class="delimiter">&quot;</span></span>).header(<span class="string"><span class="delimiter">&quot;</span><span class="content">Accept-Version</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">2.0</span><span class="delimiter">&quot;</span></span>)

        <span class="key">when</span>: <span class="string"><span class="delimiter">'</span><span class="content">Requesting announcements for version 2.0</span><span class="delimiter">'</span></span>
        HttpResponse&lt;<span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&gt;&gt; resp = client.toBlocking().exchange(request, <span class="predefined-type">List</span>)

        <span class="key">then</span>: <span class="string"><span class="delimiter">'</span><span class="content">the request was successful</span><span class="delimiter">'</span></span>
        resp.status == HttpStatus.OK <i class="conum" data-value="3"></i><b>(3)</b>

        <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">the response is a JSON Payload</span><span class="delimiter">'</span></span>
        resp.headers.getFirst(HttpHeaders.CONTENT_TYPE).get() == <span class="string"><span class="delimiter">'</span><span class="content">application/json;charset=UTF-8</span><span class="delimiter">'</span></span>
        <span class="key">and</span>: <span class="string"><span class="delimiter">'</span><span class="content">json payload contains the complete announcement</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Body is not present in the JSON paylod</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Grails command <em>test-app</em> runs unit, integration and functional tests.</p>
</div>


<h2 id="v2Android">6.3 Android V2 Changes</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/v2Android.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>First we need to change the api version defined in <em>Constants.java</em></p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/network/Constants.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.network</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Constants</span> {
    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> GRAILS_APP_URL = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://192.168.1.42:8080/</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> ANNOUNCEMENTS_PATH = <span class="string"><span class="delimiter">&quot;</span><span class="content">announcements</span><span class="delimiter">&quot;</span></span>;
    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> ACCEPT_VERSION = <span class="string"><span class="delimiter">&quot;</span><span class="content">2.0</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The detail activity uses an asyncTask to fetch a complete announcement.</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/asynctasks/RetrieveAnnouncementTask.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.asynctasks</span>;

<span class="keyword">import</span> <span class="include">android.os.AsyncTask</span>;

<span class="keyword">import</span> <span class="include">intranet.client.android.delegates.RetrieveAnnouncementDelegate</span>;
<span class="keyword">import</span> <span class="include">intranet.client.network.AnnouncementFetcher</span>;
<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">RetrieveAnnouncementTask</span> <span class="directive">extends</span> AsyncTask&lt;<span class="predefined-type">Long</span>, <span class="predefined-type">Void</span>, Announcement&gt; {
    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> TAG = RetrieveAnnouncementTask.class.getSimpleName();
    AnnouncementFetcher fetcher = <span class="keyword">new</span> AnnouncementFetcher();
    <span class="directive">private</span> RetrieveAnnouncementDelegate delegate;

    <span class="directive">public</span> RetrieveAnnouncementTask(RetrieveAnnouncementDelegate delegate) {
        <span class="local-variable">this</span>.delegate = delegate;
    }

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> Announcement doInBackground(<span class="predefined-type">Long</span>... ids) {
        <span class="keyword">if</span> ( ids != <span class="predefined-constant">null</span> &amp;&amp; ids.length &gt;= <span class="integer">1</span>) {
            <span class="predefined-type">Long</span> announcementId = ids[<span class="integer">0</span>];
            <span class="keyword">return</span> fetcher.fetchAnnouncement(announcementId);
        }

        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }

    <span class="directive">protected</span> <span class="type">void</span> onPostExecute(Announcement announcement) {
        <span class="keyword">if</span> ( delegate != <span class="predefined-constant">null</span> ) {
            delegate.onAnnouncementFetched(announcement);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once we get an announcement we will communicate the response to classes implementing the delegate</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/delegates/RetrieveAnnouncementDelegate.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.delegates</span>;

<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">interface</span> <span class="class">RetrieveAnnouncementDelegate</span> {
    <span class="type">void</span> onAnnouncementFetched(Announcement announcement);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Announcement Activity implements the delegate and renders the announcement.</p>
</div>
<div class="listingblock">
<div class="title">/app/src/main/java/intranet/client/android/activities/AnnouncementActivity.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">intranet.client.android.activities</span>;

<span class="keyword">import</span> <span class="include">android.app.Activity</span>;
<span class="keyword">import</span> <span class="include">android.content.Intent</span>;
<span class="keyword">import</span> <span class="include">android.os.Bundle</span>;
<span class="keyword">import</span> <span class="include">android.webkit.WebView</span>;
<span class="keyword">import</span> <span class="include">android.widget.TextView</span>;

<span class="keyword">import</span> <span class="include">intranet.client.R</span>;
<span class="keyword">import</span> <span class="include">intranet.client.android.asynctasks.RetrieveAnnouncementTask</span>;
<span class="keyword">import</span> <span class="include">intranet.client.android.delegates.RetrieveAnnouncementDelegate</span>;
<span class="keyword">import</span> <span class="include">intranet.client.network.model.Announcement</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">AnnouncementActivity</span> <span class="directive">extends</span> Activity <span class="directive">implements</span> RetrieveAnnouncementDelegate {

    <span class="directive">private</span> TextView tvTitle;
    <span class="directive">private</span> WebView wvBody;

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> onCreate(Bundle savedInstanceState) {
        <span class="local-variable">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_announcement);

        tvTitle = (TextView) findViewById(R.id.tvTitle);
        wvBody = (WebView) findViewById(R.id.wvBody);

        Intent intent = getIntent();
        <span class="directive">final</span> <span class="predefined-type">Long</span> announcementId = intent.getLongExtra(MainActivity.EXTRA_ID, <span class="integer">0L</span>);
        <span class="keyword">new</span> RetrieveAnnouncementTask(<span class="local-variable">this</span>).execute(announcementId);
    }

    <span class="directive">private</span> <span class="type">void</span> populateUiWithTitleAndBody(<span class="directive">final</span> <span class="predefined-type">String</span> title, <span class="directive">final</span> <span class="predefined-type">String</span> body) {
        tvTitle.setText(title);
        <span class="directive">final</span> <span class="predefined-type">String</span> mime = <span class="string"><span class="delimiter">&quot;</span><span class="content">text/html</span><span class="delimiter">&quot;</span></span>;
        <span class="directive">final</span> <span class="predefined-type">String</span> encoding = <span class="string"><span class="delimiter">&quot;</span><span class="content">utf-8</span><span class="delimiter">&quot;</span></span>;
        wvBody.loadDataWithBaseURL(<span class="predefined-constant">null</span>, body, mime, encoding, <span class="predefined-constant">null</span>);
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> onAnnouncementFetched(Announcement announcement) {
        populateUiWithTitleAndBody(announcement.getTitle(), announcement.getBody());
    }
}</code></pre>
</div>
</div>


<h1 id="conclusion">7 Conclusion</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/conclusion.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Thanks to Grails ease of API versioning we can now support two Android applications running different versions.</p>
</div>


<h1 id="helpWithGrails">8 Do you need help with Grails?</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/building-an-android-client-powered-by-a-grails-backend/edit/master/src/main/docs/guide/helpWithGrails.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<h3 style="color: #333; margin-bottom:25px;"><a href="https://objectcomputing.com/" target="_blank">Object Computing, Inc.</a> (OCI) sponsored the creation of this Guide. A variety of consulting and support services are available.</h3>

<!-- BEGIN HubSpot Consultation Form -->

<!--[if lte IE 8]>
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
<![endif]-->
<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
<script>
  hbspt.forms.create({
	portalId: "4547412",
	formId: "f8bc9b16-d5f6-4226-a24e-da0eb8b73363"
});
</script>

<!-- END HubSpot Consultation Form -->

<h3 style="color: #333;">OCI is Home to Grails</h3>

<p><a href="https://objectcomputing.com/products/2gm-team" target="_blank">Meet the Team</a></p>

</article></div><footer>
  <div class='content'>
    <div class='ocihometograils'>
      <span>Sponsored by</span>
      <a href='https://objectcomputing.com/products/grails/'><img class='' src='/images/oci_home_to_grails.svg' alt='Object Computing - Home to Grails' width='300px' /></a>
    </div>
    <nav class='socialmedianav'><ul>
  <li>
    <a href='https://slack.grails.org'><img class='' src='/images/slack.svg' alt='Slack Icon' /></a>
  </li>
  <li>
    <a href='https://www.youtube.com/watch?v=XnRNfDGkBVg&amp;list=PLI74De5M9T73uH3WilDCePP2qfSDpMaGu'><img class='' src='/images/youtube.svg' alt='Youtube Icon' /></a>
  </li>
  <li>
    <a href='https://www.linkedin.com/groups/39757'><img class='' src='/images/linkedin.svg' alt='LinkedIn Icon' /></a>
  </li>
  <li>
    <a href='https://github.com/grails/'><img class='' src='/images/github.svg' alt='Github Icon' /></a>
  </li>
  <li>
    <a href='https://twitter.com/grailsframework'><img class='' src='/images/twitter.svg' alt='Twitter Icon' /></a>
  </li>
</ul></nav>
    <nav class='partnersnav'><ul>
  <li>Grails' repositories are hosted by
    <a href='https://repo.grails.org/'>Artifactory</a>
  </li>
  <li>Website hosting provided by
    <a href='https://aws.amazon.com/'>AWS</a>
  </li>
  <li>JetBrains supports Grails with its 
    <a href='https://www.jetbrains.com/idea/'>IntelliJ IDEA IDE</a>
  </li>
  <li>YourKit supports Grails with its 
    <a href='https://www.yourkit.com/java/profiler/index.jsp'>Java Profiler</a>
  </li>
  <li>Grails is Open Source
    <a href='http://www.apache.org/licenses/LICENSE-2.0.html'>Apache 2 License</a>
  </li>
  <li>
    <a href='https://grails.org/buildstatus.html'>Build Status</a>
  </li>
</ul></nav>
  </div>
</footer><div>
  <script type='text/javascript'>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-82213539-2', 'auto');
              ga('send', 'pageview');
</script>
  <script type='text/javascript'>
adroll_adv_id = "HBWJH4CQCJGS5DJRSB4Z4D";
adroll_pix_id = "IVEQYFOZXZAPZMDVQH7BFE";
/* OPTIONAL: provide email to improve user identification */
/* adroll_email = "username@example.com"; */
(function () {
    var _onload = function(){
        if (document.readyState && !/loaded|complete/.test(document.readyState)){setTimeout(_onload, 10);return}
        if (!window.__adroll_loaded){__adroll_loaded=true;setTimeout(_onload, 50);return}
        var scr = document.createElement("script");
        var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
        scr.setAttribute('async', 'true');
        scr.type = "text/javascript";
        scr.src = host + "/j/roundtrip.js";
        ((document.getElementsByTagName('head') || [null])[0] ||
            document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
    };
    if (window.addEventListener) {window.addEventListener('load', _onload, false);}
    else {window.attachEvent('onload', _onload)}
}());            
</script>
</div></body>
</html>
