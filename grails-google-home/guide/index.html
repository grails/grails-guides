<!DOCTYPE html>
<html>
  <head>
    <meta name='google-site-verification' content='REYQ1_I6HGowAE7LOLVqfQbnKaB4IfFpMlGzMbJj55Q' />
    <meta name='viewport' content='width=device-width, initial-scale=1' />
    <link rel='icon' href='/images/favicon.ico' />
    <link rel='mask-icon' href='//images/grails-pinned-icon.svg' color='feb672' />
    <meta charset='UTF-8' />
    <title>Google Home Guide | Grails Guides | Grails Framework</title>
    <meta name='description' content='Google Home Guide. Learn to make a Goole action using Grails' />
    <link rel='stylesheet' href='../css/main.css' />
    <link rel='stylesheet' href='../css/screen.css' />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js'></script>
  </head>
  <body class='guide'><header class='mainheader'>
  <div class='content'>
    <a href='https://grails.org/index.html'><img class='grailslogo' src='/images/grails_logo.svg' alt='Grails Logo' /></a>
    <a href='javascript:show(&apos;topmenus&apos;, &apos;showNavigationLink&apos;)' id='showNavigationLink' class='mobile align-center'>Show Navigation</a>
    <div id='topmenus'>
      <nav class='secondarymenu' id='secondarymenu'><ul>
  <li>
    <a href='https://grails.org/learning.html'>Learning</a>
  </li>
  <li>
    <a href='https://grails.org/community.html'>Community</a>
  </li>
  <li>
    <a href='https://grails.org/search.html'>Search</a>
  </li>
</ul></nav>
      <nav class='mainmenu' id='mainmenu'><ul>
  <li>
    <a href='https://grails.org/documentation.html'>Documentation</a>
  </li>
  <li>
    <a href='https://grails.org/download.html'>Download</a>
  </li>
  <li>
    <a href='https://plugins.grails.org'>Plugins</a>
  </li>
  <li>
    <a href='https://guides.grails.org/index.html'>Guides</a>
  </li>
  <li>
    <a href='https://grails.org/faq.html'>FAQ</a>
  </li>
  <li>
    <a href='https://grails.org/support.html'>Support</a>
  </li>
</ul></nav>
    </div>
  </div>
</header><div class='fullwidth'><article class="guide">
    <aside>
        <a href="https://travis-ci.org/grails-guides/grails-google-home"><img src="https://travis-ci.org/grails-guides/grails-google-home.svg?branch=master"></a>

        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/grails-guides/grails-google-home&quot;"><img height="15" src="../img/github_white.svg" alt="Github"/><span>&nbsp;Get the Code</span></button>


        <ul class="githublinks">
            <li><button type="button" class="btn btn-default" href="#" onclick="document.getElementById('github-url').value='git@github.com:grails-guides/grails-google-home.git'" class="codeButton">SSH</button></li>
            <li><button type="button" class="btn btn-default" onclick="document.getElementById('github-url').value='https://github.com/grails-guides/grails-google-home.git'" class="codeButton">HTTPS</button></li>
        </ul>
        <div class="input-group">
            <!-- Target -->
            <input id="github-url" value="git@github.com:grails-guides/grails-google-home.git" type="text" />
            <!-- Trigger -->
            <button type="button" class="clippy btn btn-default" type="button" data-clipboard-target="#github-url">
                <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
            </button>
        </div>
        <script>var clipboard = new Clipboard('.clippy');</script>
        <button type="button" class="btn btn-large" onclick="window.location.href=&quot;https://github.com/grails-guides/grails-google-home/archive/master.zip&quot;">Download ZIP</button>
        
        <div id="table-of-content">
            <h3>Table of Contents</h3>
            
            <div class="toc-item" style="margin-left:0px"><a href="#training"><strong>1</strong><span>Grails Training</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#gettingStarted"><strong>2</strong><span>Getting Started</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#requirements"><strong>2.1</strong><span>What you will need</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#howto"><strong>2.2</strong><span>How to complete the guide</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#googleCloudSettings"><strong>3</strong><span>Google Cloud Settings</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#googleCloud"><strong>3.1</strong><span>Create a Google Cloud Project</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#gactionsCLI"><strong>3.2</strong><span>Install gactions CLI</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#googleActionsApi"><strong>3.3</strong><span>Configure Google Actions</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#appEngine"><strong>3.4</strong><span>Google App Engine</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#writingTheApp"><strong>4</strong><span>Writing the Application</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#grailsResponseHandler"><strong>4.1</strong><span>Handle Request from Google in Grails</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#colorRequestHandlerFactory"><strong>4.2</strong><span>Color Handler</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#googleActionsJavaSdk"><strong>4.3</strong><span>Unofficial Google Actions Java SDK</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#gapGradlePlugin"><strong>4.4</strong><span>Google App Engine Gradle Plugin</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#applicationDeploymentConfiguration"><strong>4.5</strong><span>Application Deployment Configuration</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#springBootJetty"><strong>4.6</strong><span>SpringBoot Jetty</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#deployingTheApp"><strong>4.7</strong><span>Deploying the App</span></a></div>
            
            <div class="toc-item" style="margin-left:0px"><a href="#test"><strong>5</strong><span>Test</span></a></div>
            
            <div class="toc-item" style="margin-left:10px"><a href="#webSimulator"><strong>5.1</strong><span>Test and interact with your Google Action</span></a></div>
            
            <div style="clear:both" ></div>
        </div>
        
    </aside>
    <header>
        <h1>Google Home Guide</h1>
        <p>Learn to make a Goole action using Grails</p>
        <p><strong>Authors:</strong> Ryan Vanderwerf, Sergio del Amo</p>
        <p><strong>Grails Version:</strong> 3.3.0</p>
    </header>
    

<h1 id="training">1 Grails Training</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/training.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><strong>Grails Training</strong> - Developed and delivered by the folks who created and actively maintain the Grails framework!.</p>
</div>
<div id="ocitraining"></div>
<script type="text/javascript">
var getJSON = function(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'json';
    xhr.onload = function() {
      var status = xhr.status;
      if (status == 200) {
        callback(null, xhr.response);
      } else {
        callback(status);
      }
    };
    xhr.send();
};
getJSON('https://training.grails.org/training', function(err, data) {
  var msg = '';
  if (err != null) {
      msg = 'Something went wrong while retrieving OCI training offerings';

  } else {
      if ( data.length == 0 ) {
         msg = '<p><b>Nothing scheduled at the moment - please check back again soon!</b></p>.';

      } else {
        msg += '<table>';
        msg += '<thead>';
        msg += '<tr><th>Course</th><th>Date(s)</th><th>Instructor(s)</th><th>Hour(s)</th></tr>';
        msg += '</thead>';
        msg += '<tbody>';

        var hrefs = new Array();
        for (var i = 0; i < data.length; i++) {
            var href = data[i].enrollmentLink;
            if (hrefs.indexOf(href) == -1) {
                msg += '<tr><td><a href="'+ href + '">'+ data[i].course + '</a></td><td>'+ data[i].dates + '</td><td>'+ data[i].instructors + '</td><td>'+ data[i].hours + '</td></tr>';
                hrefs.push(href);
            }

        }
        msg += '</tbody>';
        msg += '</table>';
      }
  }
  var ociTraining = document.getElementById("ocitraining");
  ociTraining.innerHTML = msg;
});
</script>


<h1 id="gettingStarted">2 Getting Started</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/gettingStarted.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In this guide you are going to learn how to create a Grails application to host a <a href="https://developers.google.com/actions/">Google Action</a> for your <a href="https://madeby.google.com/home/">Google Home</a> device to interact with. We will build, deploy, and set up everything necessary to facilitate this on <a href="https://cloud.google.com/appengine/docs/flexible/">Google App Engine Flexible</a> and Google APIs.</p>
</div>
<div class="paragraph">
<p>We will be using the <a href="https://github.com/frogermcs/Google-Actions-Java-SDK">early access unofficial Java SDK</a> to build actions. This is because the only official SDK is built with node.</p>
</div>


<h2 id="requirements">2.1 What you will need</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/requirements.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE</p>
</li>
<li>
<p>A Google account</p>
</li>
<li>
<p>A <a href="https://cloud.google.com">Google Cloud</a> account</p>
</li>
<li>
<p>curl command to help debugging</p>
</li>
</ul>
</div>


<h2 id="howto">2.2 How to complete the guide</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/howto.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To get started do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/grails-guides/grails-google-home/archive/master.zip">Download</a> and unzip the source</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clone the <a href="https://git-scm.com/">Git</a> repository:<br>
<code>git clone <a href="https://github.com/grails-guides/grails-google-home.git" class="bare">https://github.com/grails-guides/grails-google-home.git</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Grails guides repositories contain two folders:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>initial</code>  Initial project. Often a simple Grails app with some additional code to give you a head-start.</p>
</li>
<li>
<p><code>complete</code> A completed example. It is the result of working through the steps presented by the guide and applying those changes to the <code>initial</code> folder.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To complete the guide, go to the <code>initial</code> folder</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cd</code> into <code>grails-guides/grails-google-home/initial</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and follow the instructions in the next sections.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can go right to the <strong>completed example</strong> if you <code>cd</code> into <code>grails-guides/grails-google-home/complete</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The initial project is a Grails Application built with the <code>web</code> profile where we removed the <code>asset-pipeline</code> and <code>hibernate</code> depenencies.</p>
</div>
<div class="paragraph">
<p>Although you can go right to the completed example, in order to deploy the app you would need to complete several configuration steps <a href="index.html#googleCloudSettings#">Google Cloud Settings</a>.</p>
</div>
<div class="paragraph">
<p>You will need to edit the file <code>src/main/resources/action.json</code> to point to your Google App Engine Flexible deployment.</p>
</div>


<h1 id="googleCloudSettings">3 Google Cloud Settings</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/googleCloudSettings.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This guide uses paid services; you may need to enable Billing in Google Cloud to complete some steps in this guide.
</td>
</tr>
</table>
</div>


<h2 id="googleCloud">3.1 Create a Google Cloud Project</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/googleCloud.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Signup for <a href="https://console.cloud.google.com">Google Cloud Platform</a> and create a new project:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/createproject_1.png" alt="createproject 1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/createproject_2.png" alt="createproject 2">
</div>
</div>
<div class="paragraph">
<p>Install <a href="https://cloud.google.com/sdk/downloads">Cloud SDK</a> for your operating system.</p>
</div>
<div class="paragraph">
<p>After you have installed the SDK, run the init command in your terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ gcloud init</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will prompt you to select the Google account and the project which you want to use.</p>
</div>


<h2 id="gactionsCLI">3.2 Install gactions CLI</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/gactionsCLI.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We will use <code>gactions CLI</code> to test our app.</p>
</div>
<div class="paragraph">
<p>Go to <a href="https://developers.google.com/actions/tools/gactions-cli">gactions CLI</a> and download it:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/gactions-cli.png" alt="gactions cli">
</div>
</div>
<div class="paragraph">
<p>Make the gactions binary executable (chmod +x on linux and OSX).</p>
</div>
<div class="paragraph">
<p>After you have installed gactions, run the init command in your terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ gactions init --force</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other commands you can run: <code>preview</code>, <code>update</code>, <code>deploy</code>, <code>test</code>, and <code>list</code>.</p>
</div>


<h2 id="googleActionsApi">3.3 Configure Google Actions</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/googleActionsApi.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect2">
<h3 id="_enable_google_actions_api">Enable Google Actions API</h3>
<div class="paragraph">
<p>Go to <a href="https://console.developers.google.com/apis/dashboard">Google API Manager Console</a> and
enable Google Actions API.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/enablegoogleactions.png" alt="enablegoogleactions">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_import_your_project_to_the_google_actions_console">Import your Project to the Google Actions Console</h3>
<div class="paragraph">
<p>Go to the new <a href="https://console.actions.google.com/">Google Actions Console</a> and import the project your previoulsy created:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/googleactionsconsole.png" alt="googleactionsconsole">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configure_your_project_id_in_code_action_json_code">Configure your project ID in <code>action.json</code></h3>
<div class="paragraph">
<p><code>action.json</code> is a metadata file which we use to inform the Google Cloud Actions Console about the
actions supported by our application.</p>
</div>
<div class="paragraph">
<p>Here you can also control:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sample queries to help google understand which action to call</p>
</li>
<li>
<p>intent to call</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">src/main/resources/action.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">actions</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Default Welcome Intent</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">MAIN</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">fulfillment</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">conversationName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color-finder-echo</span><span class="delimiter">&quot;</span></span>
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">intent</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">actions.intent.MAIN</span><span class="delimiter">&quot;</span></span>
      }

    },
    {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Deep link that finds brighter colors</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">color.intent</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">fulfillment</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">conversationName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color.intent</span><span class="delimiter">&quot;</span></span>
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">intent</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color.intent</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">parameters</span><span class="delimiter">&quot;</span></span>: [{
          <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SchemaOrg_Color</span><span class="delimiter">&quot;</span></span>
        }],
        <span class="key"><span class="delimiter">&quot;</span><span class="content">trigger</span><span class="delimiter">&quot;</span></span>: {
          <span class="key"><span class="delimiter">&quot;</span><span class="content">queryPatterns</span><span class="delimiter">&quot;</span></span>: [
            <span class="string"><span class="delimiter">&quot;</span><span class="content">find a brighter color for $SchemaOrg_Color:color</span><span class="delimiter">&quot;</span></span>
          ]
        }
      }
    }
  ],
  <span class="key"><span class="delimiter">&quot;</span><span class="content">conversations</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">color-finder-echo</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color-finder-echo</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://grails-color-finder.appspot.com/assistantAction/index</span><span class="delimiter">&quot;</span></span>
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">color.intent</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">color.intent</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://grails-color-finder.appspot.com/assistantAction/color</span><span class="delimiter">&quot;</span></span>
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown above, our app supports two actions. We explain those actions with more detail in the next sections of this guide.</p>
</div>
<div class="paragraph">
<p>We will need to modify the httpExecution items to match your deployed application endpoints.</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/action.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://PROJECT_ID.appspot.com/assistantAction/index</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_actions_to_your_assistant_app">Add Actions to your assistant app</h3>
<div class="paragraph">
<p>The first time you select a project in the Google Cloud Actions Console, you will need to supply the action package JSON via the <code>gactions</code> tool like so:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/useactionssdk.png" alt="useactionssdk">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">gactions update --action_package src/main/resources/action.json --project PROJECT_ID</code></pre>
</div>
</div>
<div class="paragraph">
<p>Follow the instructions prompted by the above command. It involves an authorization process.</p>
</div>
<div class="paragraph">
<p>At the end you will see an output similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">Your app for the Assistant for project PROJECT_ID was successfully updated with your actions. Visit the Actions on Google console to finish registering your app and submit it for review at https://console.actions.google.com/project/PROJECT_ID/overview</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_app_information">Add App Information</h3>
<div class="paragraph">
<p>After you actions package has been validated, you will be able to enter directory information such as images, privacy policy, and descriptions. Here you can also pick the voice of the speaker in your skill.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/appinfo.png" alt="appinfo">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/appinfo2.png" alt="appinfo2">
</div>
</div>
<div class="paragraph">
<p>The previous screenshots display two buttons. Test and Submit. We will click the <code>Test</code> in the previous screenshots once we have deployed our app to Google App Engine Flexible and we are ready to test our actions.</p>
</div>
</div>


<h2 id="appEngine">3.4 Google App Engine</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/appEngine.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We are going to deploy the Grails application developed in this guide to the <a href="https://cloud.google.com/appengine/docs/flexible/">Google App Engine Flexible Environment</a></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>App Engine allows developers to focus on doing what they do best: writing code. Based on Google Compute Engine,
the App Engine flexible environment automatically scales your app up and down while balancing the load. Microservices,
authorization, SQL and NoSQL databases, traffic splitting, logging, versioning, security scanning, and content delivery networks are all supported natively.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ gcloud app create</code></pre>
</div>
</div>
<div class="paragraph">
<p>to initialize an App Engine application within the current Google Cloud project.</p>
</div>


<h1 id="writingTheApp">4 Writing the Application</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/writingTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="grailsResponseHandler">4.1 Handle Request from Google in Grails</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/grailsResponseHandler.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We name our app <em>color finder</em>. We want to achieve the scenario pictured below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/scenarioA.jpeg" alt="scenarioA">
</div>
</div>
<div class="paragraph">
<p>First, we are going to add a dependency to <a href="https://github.com/frogermcs/Google-Actions-Java-SDK">Google Actions Java SDK</a></p>
</div>
<div class="listingblock">
<div class="title">/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">'</span><span class="content">com.frogermcs.gactions:gactions:0.1.1</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The illustrated conversation is managed with the handlers. We instantiate the handlers with factories. Add the next classes
to your app:</p>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/MainRequestHandlerFactory.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.RequestHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">MainRequestHandlerFactory</span> <span class="directive">extends</span> RequestHandler.Factory {
    <span class="annotation">@Override</span>
    RequestHandler create(RootRequest rootRequest) {
        <span class="keyword">new</span> MainRequestHandler(rootRequest)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/MainRequestHandler.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.ResponseBuilder</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.RequestHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.response.RootResponse</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">MainRequestHandler</span> <span class="directive">extends</span> RequestHandler {
    <span class="directive">protected</span> MainRequestHandler(RootRequest rootRequest) {
        <span class="local-variable">super</span>(rootRequest)
    }

    <span class="annotation">@Override</span>
    RootResponse getResponse() {
        ResponseBuilder.askResponse(<span class="string"><span class="delimiter">'</span><span class="content">Hey, it works! Now tell something so I could repeat it.</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/MainRequestHandler.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.ResponseBuilder</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.RequestHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.response.RootResponse</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">MainRequestHandler</span> <span class="directive">extends</span> RequestHandler {
    <span class="directive">protected</span> MainRequestHandler(RootRequest rootRequest) {
        <span class="local-variable">super</span>(rootRequest)
    }

    <span class="annotation">@Override</span>
    RootResponse getResponse() {
        ResponseBuilder.askResponse(<span class="string"><span class="delimiter">'</span><span class="content">Hey, it works! Now tell something so I could repeat it.</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/TextRequestHandlerFactory.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.RequestHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">TextRequestHandlerFactory</span> <span class="directive">extends</span> RequestHandler.Factory {
    <span class="annotation">@Override</span>
    RequestHandler create(RootRequest rootRequest) {
        <span class="keyword">new</span> TextRequestHandler(rootRequest)
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/TextRequestHandler.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.ResponseBuilder</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.RequestHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.response.RootResponse</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">TextRequestHandler</span> <span class="directive">extends</span> RequestHandler {
    <span class="directive">protected</span> TextRequestHandler(RootRequest rootRequest) {
        <span class="local-variable">super</span>(rootRequest)
    }

    <span class="annotation">@Override</span>
    RootResponse getResponse() {
        ResponseBuilder.tellResponse(<span class="string"><span class="delimiter">&quot;</span><span class="content">You just told: </span><span class="inline"><span class="inline-delimiter">${</span>rootRequest.inputs.get(<span class="integer">0</span>).raw_inputs.get(<span class="integer">0</span>).query<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are going to handle the request that come from Google in a Grails Controller:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A controller fulfills the C in the Model View Controller (MVC) pattern and is responsible for handling web requests. In Grails a controller is a class with a name that ends in the convention "Controller" and lives in the grails-app/controllers directory.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The Grails Controller, in turn, will  delegate to Actions SDK.</p>
</div>
<div class="listingblock">
<div class="title">/grails-app/controllers/demo/AssistantActionController.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.AssistantActions</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.StandardIntents</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">com.google.gson.Gson</span>
<span class="keyword">import</span> <span class="include">com.google.gson.stream.JsonReader</span>
<span class="keyword">import</span> <span class="include">javax.servlet.http.HttpServletRequest</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">AssistantActionController</span> {
    <span class="keyword">def</span> <span class="function">index</span>() {
        AssistantActions assistantActions =
                <span class="keyword">new</span> AssistantActions.Builder(<span class="keyword">new</span> GrailsResponseHandler(response))
                        .addRequestHandlerFactory(StandardIntents.MAIN, <span class="keyword">new</span> MainRequestHandlerFactory())  <i class="conum" data-value="1"></i><b>(1)</b>
                        .addRequestHandlerFactory(StandardIntents.TEXT, <span class="keyword">new</span> TextRequestHandlerFactory())
                        .build()
        RootRequest rootRequest = parseActionRequest(request)
        assistantActions.handleRequest(rootRequest) <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="predefined-constant">null</span> <i class="conum" data-value="3"></i><b>(3)</b>
    }
    <span class="directive">private</span> RootRequest parseActionRequest(HttpServletRequest request) <span class="directive">throws</span> <span class="exception">IOException</span> {
        JsonReader jsonReader = <span class="keyword">new</span> JsonReader(request.reader)
        <span class="keyword">new</span> Gson().fromJson(jsonReader, RootRequest)
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We can chain handlers</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Grails action delegates to Actions SDK to handle requests that come from Google.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We do not want to return a grails view. The handlers manage the response</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Add <code>GrailsResponseHandler</code> to your project. As illustrated above, it allow us to use a controller to process the incoming requests.</p>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/GrailsResponseHandler.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.ResponseHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.response.RootResponse</span>
<span class="keyword">import</span> <span class="include">com.google.gson.Gson</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">javax.servlet.http.HttpServletResponse</span>
<span class="keyword">import</span> <span class="include">groovy.util.logging.Slf4j</span>

<span class="comment">/**
 * This is a handler for the SDK to make it work with Grails properly
 */</span>
<span class="annotation">@CompileStatic</span>
<span class="annotation">@Slf4j</span>
<span class="type">class</span> <span class="class">GrailsResponseHandler</span> <span class="directive">implements</span> ResponseHandler {
    <span class="directive">private</span> <span class="directive">final</span> HttpServletResponse httpServletResponse
    <span class="directive">private</span> <span class="directive">final</span> Gson gson

    GrailsResponseHandler(HttpServletResponse httpServletResponse) {
        <span class="local-variable">this</span>(httpServletResponse, <span class="keyword">new</span> Gson())
    }

    GrailsResponseHandler(HttpServletResponse httpServletResponse, Gson gson) {
        <span class="local-variable">this</span>.httpServletResponse = httpServletResponse
        <span class="local-variable">this</span>.gson = gson
    }

    <span class="annotation">@Override</span>
    <span class="type">void</span> onPrepareContentType(<span class="predefined-type">String</span> contentType) {
        httpServletResponse.setContentType(contentType)
    }

    <span class="annotation">@Override</span>
    <span class="type">void</span> onPrepareResponseHeaders(<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; headers) {
        <span class="keyword">for</span> (<span class="predefined-type">String</span> headerName : headers.keySet()) {
            httpServletResponse.addHeader(headerName, headers.get(headerName))
        }
    }

    <span class="annotation">@Override</span>
    <span class="type">void</span> onResponse(RootResponse rootResponse) {
        <span class="keyword">try</span> {
            gson.toJson(rootResponse, httpServletResponse.writer)
            httpServletResponse.flushBuffer()
        } <span class="keyword">catch</span> (<span class="exception">IOException</span> e) {
            log.error(<span class="string"><span class="delimiter">'</span><span class="content">Error writing response</span><span class="delimiter">'</span></span>, e)
        }
    }

    <span class="predefined-type">String</span> getResponse(RootResponse rootResponse) {

        <span class="keyword">try</span> {
            gson.toJson(rootResponse)
        } <span class="keyword">catch</span> (<span class="exception">IOException</span> e) {
            log.error(<span class="string"><span class="delimiter">'</span><span class="content">Error getting response</span><span class="delimiter">'</span></span>, e)
        }
    }
}</code></pre>
</div>
</div>


<h2 id="colorRequestHandlerFactory">4.2 Color Handler</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/colorRequestHandlerFactory.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To honor our app&#8217;s name we want to handle the next scenario as well:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/scenarioB.jpeg" alt="scenarioB">
</div>
</div>
<div class="paragraph">
<p>Similar to the previous example. We need a handler and a factory to instantiate the handler.</p>
</div>
<div class="paragraph">
<p>This handler demonstrates passing a verbal parameter into the intent. When the user asks for a brighter color for X it will try to find a brighter color with a name and say it to the user.</p>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/ColorRequestHandlerFactory.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.RequestHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">ColorRequestHandlerFactory</span> <span class="directive">extends</span> RequestHandler.Factory {
    <span class="annotation">@Override</span>
    RequestHandler create(RootRequest rootRequest) {
        <span class="keyword">new</span> ColorRequestHandler(rootRequest)
    }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/ColorRequestHandler.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.ResponseBuilder</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.RequestHandler</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.response.RootResponse</span>
<span class="keyword">import</span> <span class="include">demo.util.ColorUtils</span>
<span class="keyword">import</span> <span class="include">java.awt.Color</span>
<span class="keyword">import</span> <span class="include">java.lang.reflect.Field</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">groovy.util.logging.Slf4j</span>

<span class="comment">/**
 * take a color name input and returns a brighter color name in return if possible
 */</span>
<span class="annotation">@CompileStatic</span>
<span class="annotation">@Slf4j</span>
<span class="type">class</span> <span class="class">ColorRequestHandler</span> <span class="directive">extends</span> RequestHandler {

    <span class="directive">protected</span> ColorRequestHandler(RootRequest rootRequest) {
        <span class="local-variable">super</span>(rootRequest)
    }

    <span class="annotation">@Override</span>
    RootResponse getResponse() {
        log.debug(<span class="string"><span class="delimiter">&quot;</span><span class="content">Inputs=</span><span class="inline"><span class="inline-delimiter">${</span>rootRequest.inputs.toListString()<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
        <span class="predefined-type">String</span> color = rootRequest.inputs[<span class="integer">0</span>].arguments[<span class="integer">0</span>].raw_text.toLowerCase()

        <span class="predefined-type">Color</span> parsedColor = <span class="predefined-constant">null</span>
        <span class="keyword">try</span> {
            <span class="predefined-type">Field</span> field = <span class="predefined-type">Class</span>.forName(<span class="string"><span class="delimiter">'</span><span class="content">java.awt.Color</span><span class="delimiter">'</span></span>).getField(color)
            parsedColor = (<span class="predefined-type">Color</span>)field.get(<span class="predefined-constant">null</span>)
        } <span class="keyword">catch</span> (<span class="exception">NoSuchFieldException</span> ne) {
            <span class="keyword">return</span> colorNotFound(color)
        }
        <span class="keyword">if</span> (parsedColor) {
            ColorUtils colorUtils = <span class="keyword">new</span> ColorUtils()
            <span class="predefined-type">String</span> brighter = colorUtils.findBrighterNameForColor(parsedColor).toLowerCase()
            <span class="predefined-type">String</span> answer = <span class="string"><span class="delimiter">&quot;</span><span class="content">Sorry I can't find a brighter color for </span><span class="inline"><span class="inline-delimiter">${</span>color<span class="inline-delimiter">}</span></span><span class="content">.</span><span class="delimiter">&quot;</span></span>
            if (brighter != color) {
                answer = <span class="string"><span class="delimiter">&quot;</span><span class="content">The brighter color for </span><span class="inline"><span class="inline-delimiter">${</span>color<span class="inline-delimiter">}</span></span><span class="content"> is </span><span class="inline"><span class="inline-delimiter">${</span>brighter<span class="inline-delimiter">}</span></span><span class="content"> </span><span class="delimiter">&quot;</span></span>
            }
            <span class="keyword">return</span> ResponseBuilder.tellResponse(answer)
        }
        colorNotFound(color)
    }

    <span class="directive">private</span> RootResponse colorNotFound(<span class="predefined-type">String</span> color) {
        ResponseBuilder.tellResponse(<span class="string"><span class="delimiter">&quot;</span><span class="content">Sorry I don't understand the color </span><span class="inline"><span class="inline-delimiter">${</span>color<span class="inline-delimiter">}</span></span><span class="content">.</span><span class="delimiter">&quot;</span></span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We are going to handle the request that come from Google in another action of our controller:</p>
</div>
<div class="listingblock">
<div class="title">/grails-app/controllers/demo/AssistantActionController.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.AssistantActions</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.StandardIntents</span>
<span class="keyword">import</span> <span class="include">com.frogermcs.gactions.api.request.RootRequest</span>
<span class="keyword">import</span> <span class="include">com.google.gson.Gson</span>
<span class="keyword">import</span> <span class="include">com.google.gson.stream.JsonReader</span>
<span class="keyword">import</span> <span class="include">javax.servlet.http.HttpServletRequest</span>
<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">AssistantActionController</span> {
    <span class="keyword">def</span> <span class="function">color</span>() {
        AssistantActions assistantActions =
                <span class="keyword">new</span> AssistantActions.Builder(<span class="keyword">new</span> GrailsResponseHandler(response))
                        .addRequestHandlerFactory(<span class="string"><span class="delimiter">'</span><span class="content">color.intent</span><span class="delimiter">'</span></span>, <span class="keyword">new</span> ColorRequestHandlerFactory()) <i class="conum" data-value="1"></i><b>(1)</b>
                        .build()
        RootRequest rootRequest = parseActionRequest(request)  <i class="conum" data-value="2"></i><b>(2)</b>
        assistantActions.handleRequest(rootRequest)
        <span class="predefined-constant">null</span>  <i class="conum" data-value="3"></i><b>(3)</b>
    }
    <span class="directive">private</span> RootRequest parseActionRequest(HttpServletRequest request) <span class="directive">throws</span> <span class="exception">IOException</span> {
        JsonReader jsonReader = <span class="keyword">new</span> JsonReader(request.reader)
        <span class="keyword">new</span> Gson().fromJson(jsonReader, RootRequest)
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Instantiate the handler with the help of the factory</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Grails action delegates to Actions SDK to handle requests that come from Google.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We do not want to return a grails view. The handlers manage the response</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let’s use a simple utility class to make our action do something interesting. This will help us map a given <code>java.awt.Color</code> to give us a english name for it.</p>
</div>
<div class="listingblock">
<div class="title">/src/main/groovy/demo/util/ColorUtils.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo.util;

<span class="keyword">import</span> <span class="include">java.awt.*</span>;
<span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;

<span class="comment">/**
 * Java Code to get a color name from rgb/hex value/awt color
 *
 * The part of looking up a color name from the rgb values is edited from
 * https://gist.github.com/nightlark/6482130#file-gistfile1-java (that has some errors) by Ryan Mast (nightlark)
 *
 * @author Xiaoxiao Li
 *
 */</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">ColorUtils</span> {

    <span class="comment">/**
     * Initialize the color list that we have.
     */</span>
    <span class="directive">private</span> <span class="predefined-type">ArrayList</span>&lt;ColorName&gt; initColorList() {
        <span class="predefined-type">ArrayList</span>&lt;ColorName&gt; colorList = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;ColorName&gt;();
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">AliceBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF0</span>, <span class="hex">0xF8</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">AntiqueWhite</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFA</span>, <span class="hex">0xEB</span>, <span class="hex">0xD7</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Aqua</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Aquamarine</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x7F</span>, <span class="hex">0xFF</span>, <span class="hex">0xD4</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Azure</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF0</span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Beige</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF5</span>, <span class="hex">0xF5</span>, <span class="hex">0xDC</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Bisque</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xE4</span>, <span class="hex">0xC4</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Black</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">BlanchedAlmond</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xEB</span>, <span class="hex">0xCD</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Blue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">BlueViolet</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x8A</span>, <span class="hex">0x2B</span>, <span class="hex">0xE2</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Brown</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xA5</span>, <span class="hex">0x2A</span>, <span class="hex">0x2A</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">BurlyWood</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xDE</span>, <span class="hex">0xB8</span>, <span class="hex">0x87</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">CadetBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x5F</span>, <span class="hex">0x9E</span>, <span class="hex">0xA0</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Chartreuse</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x7F</span>, <span class="hex">0xFF</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Chocolate</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xD2</span>, <span class="hex">0x69</span>, <span class="hex">0x1E</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Coral</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x7F</span>, <span class="hex">0x50</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">CornflowerBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x64</span>, <span class="hex">0x95</span>, <span class="hex">0xED</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Cornsilk</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xF8</span>, <span class="hex">0xDC</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Crimson</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xDC</span>, <span class="hex">0x14</span>, <span class="hex">0x3C</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Cyan</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>, <span class="hex">0x8B</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkCyan</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x8B</span>, <span class="hex">0x8B</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkGoldenRod</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xB8</span>, <span class="hex">0x86</span>, <span class="hex">0x0B</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkGray</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xA9</span>, <span class="hex">0xA9</span>, <span class="hex">0xA9</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x64</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkKhaki</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xBD</span>, <span class="hex">0xB7</span>, <span class="hex">0x6B</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkMagenta</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x8B</span>, <span class="hex">0x00</span>, <span class="hex">0x8B</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkOliveGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x55</span>, <span class="hex">0x6B</span>, <span class="hex">0x2F</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkOrange</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x8C</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkOrchid</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x99</span>, <span class="hex">0x32</span>, <span class="hex">0xCC</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkRed</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x8B</span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkSalmon</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xE9</span>, <span class="hex">0x96</span>, <span class="hex">0x7A</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkSeaGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x8F</span>, <span class="hex">0xBC</span>, <span class="hex">0x8F</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkSlateBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x48</span>, <span class="hex">0x3D</span>, <span class="hex">0x8B</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkSlateGray</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x2F</span>, <span class="hex">0x4F</span>, <span class="hex">0x4F</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkTurquoise</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0xCE</span>, <span class="hex">0xD1</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DarkViolet</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x94</span>, <span class="hex">0x00</span>, <span class="hex">0xD3</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DeepPink</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x14</span>, <span class="hex">0x93</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DeepSkyBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0xBF</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DimGray</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x69</span>, <span class="hex">0x69</span>, <span class="hex">0x69</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">DodgerBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x1E</span>, <span class="hex">0x90</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">FireBrick</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xB2</span>, <span class="hex">0x22</span>, <span class="hex">0x22</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">FloralWhite</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xFA</span>, <span class="hex">0xF0</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">ForestGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x22</span>, <span class="hex">0x8B</span>, <span class="hex">0x22</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Fuchsia</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x00</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Gainsboro</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xDC</span>, <span class="hex">0xDC</span>, <span class="hex">0xDC</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">GhostWhite</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF8</span>, <span class="hex">0xF8</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Gold</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xD7</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">GoldenRod</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xDA</span>, <span class="hex">0xA5</span>, <span class="hex">0x20</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Gray</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x80</span>, <span class="hex">0x80</span>, <span class="hex">0x80</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Green</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x80</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">GreenYellow</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xAD</span>, <span class="hex">0xFF</span>, <span class="hex">0x2F</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">HoneyDew</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF0</span>, <span class="hex">0xFF</span>, <span class="hex">0xF0</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">HotPink</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x69</span>, <span class="hex">0xB4</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">IndianRed</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xCD</span>, <span class="hex">0x5C</span>, <span class="hex">0x5C</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Indigo</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x4B</span>, <span class="hex">0x00</span>, <span class="hex">0x82</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Ivory</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>, <span class="hex">0xF0</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Khaki</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF0</span>, <span class="hex">0xE6</span>, <span class="hex">0x8C</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Lavender</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xE6</span>, <span class="hex">0xE6</span>, <span class="hex">0xFA</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LavenderBlush</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xF0</span>, <span class="hex">0xF5</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LawnGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x7C</span>, <span class="hex">0xFC</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LemonChiffon</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xFA</span>, <span class="hex">0xCD</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xAD</span>, <span class="hex">0xD8</span>, <span class="hex">0xE6</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightCoral</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF0</span>, <span class="hex">0x80</span>, <span class="hex">0x80</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightCyan</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xE0</span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightGoldenRodYellow</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFA</span>, <span class="hex">0xFA</span>, <span class="hex">0xD2</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightGray</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xD3</span>, <span class="hex">0xD3</span>, <span class="hex">0xD3</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x90</span>, <span class="hex">0xEE</span>, <span class="hex">0x90</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightPink</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xB6</span>, <span class="hex">0xC1</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightSalmon</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xA0</span>, <span class="hex">0x7A</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightSeaGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x20</span>, <span class="hex">0xB2</span>, <span class="hex">0xAA</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightSkyBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x87</span>, <span class="hex">0xCE</span>, <span class="hex">0xFA</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightSlateGray</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x77</span>, <span class="hex">0x88</span>, <span class="hex">0x99</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightSteelBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xB0</span>, <span class="hex">0xC4</span>, <span class="hex">0xDE</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LightYellow</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>, <span class="hex">0xE0</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Lime</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0xFF</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">LimeGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x32</span>, <span class="hex">0xCD</span>, <span class="hex">0x32</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Linen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFA</span>, <span class="hex">0xF0</span>, <span class="hex">0xE6</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Magenta</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x00</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Maroon</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x80</span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumAquaMarine</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x66</span>, <span class="hex">0xCD</span>, <span class="hex">0xAA</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>, <span class="hex">0xCD</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumOrchid</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xBA</span>, <span class="hex">0x55</span>, <span class="hex">0xD3</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumPurple</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x93</span>, <span class="hex">0x70</span>, <span class="hex">0xDB</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumSeaGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x3C</span>, <span class="hex">0xB3</span>, <span class="hex">0x71</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumSlateBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x7B</span>, <span class="hex">0x68</span>, <span class="hex">0xEE</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumSpringGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0xFA</span>, <span class="hex">0x9A</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumTurquoise</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x48</span>, <span class="hex">0xD1</span>, <span class="hex">0xCC</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MediumVioletRed</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xC7</span>, <span class="hex">0x15</span>, <span class="hex">0x85</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MidnightBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x19</span>, <span class="hex">0x19</span>, <span class="hex">0x70</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MintCream</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF5</span>, <span class="hex">0xFF</span>, <span class="hex">0xFA</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">MistyRose</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xE4</span>, <span class="hex">0xE1</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Moccasin</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xE4</span>, <span class="hex">0xB5</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">NavajoWhite</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xDE</span>, <span class="hex">0xAD</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Navy</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>, <span class="hex">0x80</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">OldLace</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFD</span>, <span class="hex">0xF5</span>, <span class="hex">0xE6</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Olive</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x80</span>, <span class="hex">0x80</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">OliveDrab</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x6B</span>, <span class="hex">0x8E</span>, <span class="hex">0x23</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Orange</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xA5</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">OrangeRed</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x45</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Orchid</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xDA</span>, <span class="hex">0x70</span>, <span class="hex">0xD6</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">PaleGoldenRod</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xEE</span>, <span class="hex">0xE8</span>, <span class="hex">0xAA</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">PaleGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x98</span>, <span class="hex">0xFB</span>, <span class="hex">0x98</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">PaleTurquoise</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xAF</span>, <span class="hex">0xEE</span>, <span class="hex">0xEE</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">PaleVioletRed</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xDB</span>, <span class="hex">0x70</span>, <span class="hex">0x93</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">PapayaWhip</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xEF</span>, <span class="hex">0xD5</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">PeachPuff</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xDA</span>, <span class="hex">0xB9</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Peru</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xCD</span>, <span class="hex">0x85</span>, <span class="hex">0x3F</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Pink</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xC0</span>, <span class="hex">0xCB</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Plum</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xDD</span>, <span class="hex">0xA0</span>, <span class="hex">0xDD</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">PowderBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xB0</span>, <span class="hex">0xE0</span>, <span class="hex">0xE6</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Purple</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x80</span>, <span class="hex">0x00</span>, <span class="hex">0x80</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Red</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x00</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">RosyBrown</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xBC</span>, <span class="hex">0x8F</span>, <span class="hex">0x8F</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">RoyalBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x41</span>, <span class="hex">0x69</span>, <span class="hex">0xE1</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SaddleBrown</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x8B</span>, <span class="hex">0x45</span>, <span class="hex">0x13</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Salmon</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFA</span>, <span class="hex">0x80</span>, <span class="hex">0x72</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SandyBrown</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF4</span>, <span class="hex">0xA4</span>, <span class="hex">0x60</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SeaGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x2E</span>, <span class="hex">0x8B</span>, <span class="hex">0x57</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SeaShell</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xF5</span>, <span class="hex">0xEE</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Sienna</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xA0</span>, <span class="hex">0x52</span>, <span class="hex">0x2D</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Silver</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xC0</span>, <span class="hex">0xC0</span>, <span class="hex">0xC0</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SkyBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x87</span>, <span class="hex">0xCE</span>, <span class="hex">0xEB</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SlateBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x6A</span>, <span class="hex">0x5A</span>, <span class="hex">0xCD</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SlateGray</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x70</span>, <span class="hex">0x80</span>, <span class="hex">0x90</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Snow</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xFA</span>, <span class="hex">0xFA</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SpringGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0xFF</span>, <span class="hex">0x7F</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">SteelBlue</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x46</span>, <span class="hex">0x82</span>, <span class="hex">0xB4</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tan</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xD2</span>, <span class="hex">0xB4</span>, <span class="hex">0x8C</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Teal</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x00</span>, <span class="hex">0x80</span>, <span class="hex">0x80</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Thistle</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xD8</span>, <span class="hex">0xBF</span>, <span class="hex">0xD8</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Tomato</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0x63</span>, <span class="hex">0x47</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Turquoise</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x40</span>, <span class="hex">0xE0</span>, <span class="hex">0xD0</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Violet</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xEE</span>, <span class="hex">0x82</span>, <span class="hex">0xEE</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Wheat</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF5</span>, <span class="hex">0xDE</span>, <span class="hex">0xB3</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">White</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">WhiteSmoke</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xF5</span>, <span class="hex">0xF5</span>, <span class="hex">0xF5</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Yellow</span><span class="delimiter">&quot;</span></span>, <span class="hex">0xFF</span>, <span class="hex">0xFF</span>, <span class="hex">0x00</span>));
        colorList.add(<span class="keyword">new</span> ColorName(<span class="string"><span class="delimiter">&quot;</span><span class="content">YellowGreen</span><span class="delimiter">&quot;</span></span>, <span class="hex">0x9A</span>, <span class="hex">0xCD</span>, <span class="hex">0x32</span>));
        <span class="keyword">return</span> colorList;
    }

    <span class="comment">/**
     * Get the closest color name from our list
     *
     * @param r
     * @param g
     * @param b
     * @return
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getColorNameFromRgb(<span class="type">int</span> r, <span class="type">int</span> g, <span class="type">int</span> b) {
        <span class="predefined-type">ArrayList</span>&lt;ColorName&gt; colorList = initColorList();
        ColorName closestMatch = <span class="predefined-constant">null</span>;
        <span class="type">int</span> minMSE = <span class="predefined-type">Integer</span>.MAX_VALUE;
        <span class="type">int</span> mse;
        <span class="keyword">for</span> (ColorName c : colorList) {
            mse = c.computeMSE(r, g, b);
            <span class="keyword">if</span> (mse &lt; minMSE) {
                minMSE = mse;
                closestMatch = c;
            }
        }

        <span class="keyword">if</span> (closestMatch != <span class="predefined-constant">null</span>) {
            <span class="keyword">return</span> closestMatch.getName();
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">No matched color name.</span><span class="delimiter">&quot;</span></span>;
        }
    }

    <span class="comment">/**
     * Convert hexColor to rgb, then call getColorNameFromRgb(r, g, b)
     *
     * @param hexColor
     * @return
     */</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getColorNameFromHex(<span class="type">int</span> hexColor) {
        <span class="type">int</span> r = (hexColor &amp; <span class="hex">0xFF0000</span>) &gt;&gt; <span class="integer">16</span>;
        <span class="type">int</span> g = (hexColor &amp; <span class="hex">0xFF00</span>) &gt;&gt; <span class="integer">8</span>;
        <span class="type">int</span> b = (hexColor &amp; <span class="hex">0xFF</span>);
        <span class="keyword">return</span> getColorNameFromRgb(r, g, b);
    }

    <span class="directive">public</span> <span class="type">int</span> colorToHex(<span class="predefined-type">Color</span> c) {
        <span class="keyword">return</span> <span class="predefined-type">Integer</span>.decode(<span class="string"><span class="delimiter">&quot;</span><span class="content">0x</span><span class="delimiter">&quot;</span></span>
                + <span class="predefined-type">Integer</span>.toHexString(c.getRGB()).substring(<span class="integer">2</span>));
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getColorNameFromColor(<span class="predefined-type">Color</span> color) {
        <span class="keyword">return</span> getColorNameFromRgb(color.getRed(), color.getGreen(),
                color.getBlue());
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> findBrighterNameForColor(<span class="predefined-type">Color</span> color) {
        <span class="predefined-type">String</span> name = getColorNameFromColor(color);
        <span class="predefined-type">String</span> nextColorName = name;
        <span class="type">int</span> colorCount = <span class="integer">0</span>;
        <span class="keyword">while</span> (name.equals(nextColorName) &amp;&amp; colorCount &lt; <span class="integer">100</span>) {
            color = color.brighter();
            nextColorName = getColorNameFromColor(color);
            colorCount++;
        }
        <span class="keyword">return</span> nextColorName;



    }

    <span class="directive">public</span> <span class="predefined-type">String</span> findDarkerNameForColor(<span class="predefined-type">Color</span> color) {
        <span class="predefined-type">String</span> name = getColorNameFromColor(color);
        <span class="predefined-type">String</span> nextColorName = name;
        <span class="type">int</span> colorCount = <span class="integer">0</span>;
        <span class="keyword">while</span> (name.equals(nextColorName) &amp;&amp; colorCount &lt; <span class="integer">100</span>) {
            color = color.darker();
            nextColorName = getColorNameFromColor(color);
            colorCount++;
        }
        <span class="keyword">return</span> nextColorName;



    }

    <span class="comment">/**
     * SubClass of ColorUtils. In order to lookup color name
     *
     * @author Xiaoxiao Li
     *
     */</span>
    <span class="directive">public</span> <span class="type">class</span> <span class="class">ColorName</span> {
        <span class="directive">public</span> <span class="type">int</span> r, g, b;
        <span class="directive">public</span> <span class="predefined-type">String</span> name;

        <span class="directive">public</span> ColorName(<span class="predefined-type">String</span> name, <span class="type">int</span> r, <span class="type">int</span> g, <span class="type">int</span> b) {
            <span class="local-variable">this</span>.r = r;
            <span class="local-variable">this</span>.g = g;
            <span class="local-variable">this</span>.b = b;
            <span class="local-variable">this</span>.name = name;
        }

        <span class="directive">public</span> <span class="type">int</span> computeMSE(<span class="type">int</span> pixR, <span class="type">int</span> pixG, <span class="type">int</span> pixB) {
            <span class="keyword">return</span> (<span class="type">int</span>) (((pixR - r) * (pixR - r) + (pixG - g) * (pixG - g) + (pixB - b)
                    * (pixB - b)) / <span class="integer">3</span>);
        }

        <span class="directive">public</span> <span class="type">int</span> getR() {
            <span class="keyword">return</span> r;
        }

        <span class="directive">public</span> <span class="type">int</span> getG() {
            <span class="keyword">return</span> g;
        }

        <span class="directive">public</span> <span class="type">int</span> getB() {
            <span class="keyword">return</span> b;
        }

        <span class="directive">public</span> <span class="predefined-type">String</span> getName() {
            <span class="keyword">return</span> name;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Previous class is a Java Class. <strong>Grails allows us to mix Groovy and Java code seamlessly</strong>.</p>
</div>


<h2 id="googleActionsJavaSdk">4.3 Unofficial Google Actions Java SDK</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/googleActionsJavaSdk.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The SDK is at <a href="https://github.com/frogermcs/Google-Actions-Java-SDK" class="bare">https://github.com/frogermcs/Google-Actions-Java-SDK</a> however all we need to do is edit our build.gradle to include the library.</p>
</div>
<div class="listingblock">
<div class="title">/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="gradle">compile 'com.frogermcs.gactions:gactions:0.1.1'</code></pre>
</div>
</div>


<h2 id="gapGradlePlugin">4.4 Google App Engine Gradle Plugin</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/gapGradlePlugin.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To deploy to App Engine, we are going to use the <a href="https://github.com/GoogleCloudPlatform/app-gradle-plugin">Google App Engine Gradle Plugin</a>.</p>
</div>
<div class="paragraph">
<p>We need to modify <code>build.gradle</code>, add the plugin as a buildscript dependency and apply the plugin:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildscript {
    repositories {
        mavenLocal()
        maven { url <span class="string"><span class="delimiter">&quot;</span><span class="content">https://repo.grails.org/grails/core</span><span class="delimiter">&quot;</span></span> }
    }
    dependencies {
        classpath <span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails:grails-gradle-plugin:</span><span class="inline"><span class="inline-delimiter">$</span>grailsVersion</span><span class="delimiter">&quot;</span></span>
        classpath <span class="string"><span class="delimiter">'</span><span class="content">com.google.cloud.tools:appengine-gradle-plugin:1.1.1</span><span class="delimiter">'</span></span>
    }
}
...
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">com.google.cloud.tools.appengine</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>


<h2 id="applicationDeploymentConfiguration">4.5 Application Deployment Configuration</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/applicationDeploymentConfiguration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To deploy to Google App Engine, we need to add the file <code>src/main/appengine/app.yaml</code></p>
</div>
<div class="paragraph">
<p>It describes the application&#8217;s deployment configuration:</p>
</div>
<div class="listingblock">
<div class="title">/src/main/appengine/app.yaml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">runtime</span>: java
<span class="key">env</span>: flex

<span class="key">runtime_config</span>:
    <span class="key">jdk</span>: openjdk8
    <span class="key">server</span>: jetty9

<span class="key">health_check</span>:
    <span class="key">enable_health_check</span>: False

<span class="key">resources</span>:
    <span class="key">cpu</span>: <span class="integer">1</span>
    <span class="key">memory_gb</span>: <span class="float">2.3</span>

<span class="key">manual_scaling</span>:
  <span class="key">instances</span>: <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, <code>app.yaml</code> specifies the runtime used by the app, and sets <code>env: flex</code>,
specifying that the app uses the <a href="https://cloud.google.com/appengine/docs/flexible/">flexible environment</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The minimal <code>app.yaml</code> application configuration file shown above is sufficient for a simple Grails application.
Depending on the size, complexity, and features that your application uses, you may need to change and extend this basic
configuration file. For more information on what can be configured via <code>app.yaml</code>, please see the
<a href="https://cloud.google.com/appengine/docs/flexible/java/configuring-your-app-with-app-yaml">Configuring Your App with app.yaml</a>
guide.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information on how the Java runtime works, see <a href="https://cloud.google.com/appengine/docs/flexible/java/dev-jetty9">Java 8 / Jetty 9.3 Runtime</a>.</p>
</div>


<h2 id="springBootJetty">4.6 SpringBoot Jetty</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/springBootJetty.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>As shown in the previous app engine configuration file, we are using Jetty.</p>
</div>
<div class="paragraph">
<p>Following SpringBoot&#8217;s documentation, we need to do the following changes to
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-embedded-servlet-containers.html">deploy to Jetty instead of Tomcat</a></p>
</div>
<div class="paragraph">
<p>Replace tomcat:</p>
</div>
<div class="listingblock">
<div class="title">app/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">provided <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot:spring-boot-starter-tomcat</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>with jetty:</p>
</div>
<div class="listingblock">
<div class="title">/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">provided <span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.boot:spring-boot-starter-jetty</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We need to exclude the tomcat-juli dependency as well. Add:</p>
</div>
<div class="listingblock">
<div class="title">/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">configurations {
    compile.exclude <span class="key">module</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">tomcat-juli</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>


<h2 id="deployingTheApp">4.7 Deploying the App</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/deployingTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To deploy the app to Google App Engine run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ ./gradlew appengineDeploy</code></pre>
</div>
</div>
<div class="paragraph">
<p>Initial deployment may take a while. When finished, you will be able to access your app.</p>
</div>


<h1 id="test">5 Test</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/test.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="webSimulator">5.1 Test and interact with your Google Action</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-google-home/edit/master/src/main/docs/guide/webSimulator.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Once your app is deployed in Google App Engine Flexible, you can test it.</p>
</div>
<div class="paragraph">
<p>Go back to the Google Actions Console and click test.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/test1.png" alt="test1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/test2.png" alt="test2">
</div>
</div>
<div class="paragraph">
<p>Try to test out your actions with the following phrases:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Ask to Grails Color Finder to find a brighter color for magenta</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>You should see the response:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Sure, here is the test version of Grails Color Finder
The brighter color for magenta is fuchsia"</p>
</div>
</blockquote>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/test-brigther-color.png" alt="test brigther color">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s try another:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>talk to Grails Color Finder</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>You&#8217;ll see:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Sure, here is the test version of Grails Color Finder
Hey, it works! Now tell something so I could repeat it.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Now respond with something:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Grails is awesome</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>You should see it echo back what you entered:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>You just told: Grails is awesome</p>
</div>
</blockquote>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/test-default.png" alt="test default">
</div>
</div>
<div class="paragraph">
<p>Now you can make a more rich skill, and when you are ready go to the Google API dashboard, fill in the directory listing and submit it for testing.</p>
</div>

</article></div><footer>
  <div class='content'>
    <div class='ocihometograils'>
      <span>Sponsored by</span>
      <a href='https://objectcomputing.com/products/grails/'><img class='' src='/images/oci_home_to_grails.svg' alt='Object Computing - Home to Grails' width='300px' /></a>
    </div>
    <nav class='socialmedianav'><ul>
  <li>
    <a href='https://slack.grails.org'><img class='' src='/images/slack.svg' alt='Slack Icon' /></a>
  </li>
  <li>
    <a href='https://www.youtube.com/watch?v=XnRNfDGkBVg&amp;list=PLI74De5M9T73uH3WilDCePP2qfSDpMaGu'><img class='' src='/images/youtube.svg' alt='Youtube Icon' /></a>
  </li>
  <li>
    <a href='https://www.linkedin.com/groups/39757'><img class='' src='/images/linkedin.svg' alt='LinkedIn Icon' /></a>
  </li>
  <li>
    <a href='https://github.com/grails/'><img class='' src='/images/github.svg' alt='Github Icon' /></a>
  </li>
  <li>
    <a href='https://twitter.com/grailsframework'><img class='' src='/images/twitter.svg' alt='Twitter Icon' /></a>
  </li>
</ul></nav>
    <nav class='partnersnav'><ul>
  <li>Grails' repositories are hosted by
    <a href='https://repo.grails.org/'>Artifactory</a>
  </li>
  <li>Website hosting provided by
    <a href='https://aws.amazon.com/'>AWS</a>
  </li>
  <li>JetBrains supports Grails with its 
    <a href='https://www.jetbrains.com/idea/'>IntelliJ IDEA IDE</a>
  </li>
  <li>YourKit supports Grails with its 
    <a href='https://www.yourkit.com/java/profiler/index.jsp'>Java Profiler</a>
  </li>
  <li>Grails is Open Source
    <a href='http://www.apache.org/licenses/LICENSE-2.0.html'>Apache 2 License</a>
  </li>
  <li>
    <a href='https://grails.org/buildstatus.html'>Build Status</a>
  </li>
</ul></nav>
  </div>
</footer><div>
  <script type='text/javascript'>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-82213539-2', 'auto');
              ga('send', 'pageview');
</script>
  <script type='text/javascript'>
adroll_adv_id = "HBWJH4CQCJGS5DJRSB4Z4D";
adroll_pix_id = "IVEQYFOZXZAPZMDVQH7BFE";
/* OPTIONAL: provide email to improve user identification */
/* adroll_email = "username@example.com"; */
(function () {
    var _onload = function(){
        if (document.readyState && !/loaded|complete/.test(document.readyState)){setTimeout(_onload, 10);return}
        if (!window.__adroll_loaded){__adroll_loaded=true;setTimeout(_onload, 50);return}
        var scr = document.createElement("script");
        var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
        scr.setAttribute('async', 'true');
        scr.type = "text/javascript";
        scr.src = host + "/j/roundtrip.js";
        ((document.getElementsByTagName('head') || [null])[0] ||
            document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
    };
    if (window.addEventListener) {window.addEventListener('load', _onload, false);}
    else {window.attachEvent('onload', _onload)}
}());            
</script>
</div></body>
</html>
