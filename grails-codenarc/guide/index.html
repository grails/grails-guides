<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Static code analysis in a Grails app with CodeNarc</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/guide.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />        
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />

        <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>

        <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css" />        
        <link rel="stylesheet" type="text/css" href="../css/navbar.css" />
        <link rel="stylesheet" type="text/css" href="../css/stMenu.css" />      

    </head>

    <body class="body" onload="addJsClass();">

    <a href="https://github.com/grails/grails-core" target="_blank">
      <div id="fork-me">
        <p>Fork me on Github</p>
      </div>
    </a>
    <div id="st-container" class="st-container st-effect-9">
      <nav class="st-menu st-effect-9" id="menu-12">
        <h2 class="icon icon-lab">Socialize</h2>
        <ul>
          <li><a href="http://grails.org/mailing-lists.html" class="icon"><span class="fa fa-envelope"></span> Discuss on the Mailing List</a></li>
          <li><a href="http://slack-signup.grails.org" class="icon"><span class="fa fa-slack"></span> Discuss on Slack</a></li>
          <li><a href="https://twitter.com/grailsframework" class="icon"><span class="fa fa-twitter"></span> Grails on Twitter</a></li>
          <li><a href="http://grails.org/events.html" class="icon"><span class="fa fa-calendar"></span> Events and conferences</a></li>
          <li><a href="https://github.com/grails/grails-core" class="icon"><span class="fa fa-github"></span> Source code on GitHub</a></li>
          <li><a href="http://grails.org/contribute.html#reporting-issues" class="icon"><span class="fa fa-bug"></span> Report issues on Github</a></li>
          <li><a href="http://stackoverflow.com/questions/tagged/grails" class="icon"><span class="fa fa-stack-overflow"></span> Stack Overflow questions</a></li>
        </ul>
      </nav>
      <div class="st-pusher">
        <div class="st-content">
          <div class="st-content">
            <div class="grailsnavbar grailsnavbar-default">
              <div class="grailsnavbar-container">
                <div class="grailsnavbar-header">
                  <a class="grailsnavbar-brand" href="index.html"><i class="fa grails-icon"><img src="../img/grails-cupsonly-logo-white.svg"></i> Grails</a>
                </div>
                <a id="nav-icon" href="javascript:toggleNavIcon();">
                  <span></span>
                  <span></span>
                  <span></span>
                </a>
                <div class="grailsnavbar-collapse collapse">
                  <ul id="grailsnavbar-nav" class="grailsnavbar-nav grailsnavbar-right closemobile">
                    <li><a href="http://grails.org/learn.html">Learn</a></li>
                    <li><a href="http://guides.grails.org">Guides</a></li>
                    <li><a href="http://grails.org/documentation.html">Documentation</a></li>
                    <li><a href="http://grails.org/download.html">Download</a></li>
                    <li><a href="http://plugins.grails.org">Plugins</a></li>
                    <li><a href="http://grails.org/community.html">Community</a></li>
                    <li><a href="http://grails.org/support.html">Support</a></li>
                    <li><a data-effect="st-effect-9" class="st-trigger" href="#">Socialize</a></li>
                    <li><a href="http://grails.org/search.html"><i class="fa fa-search"></i></a></li>
                  </ul>
                </div>
              </div>
            </div>
            <!-- CONTENT -->
<table id="colset" border="0" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td id="col1">
                                        <div id="main" class="corner-all">

                                            <div class="project">
                                                <h1>Static code analysis in a Grails app with CodeNarc</h1>
                                                <p></p>
                                                <p>In this guide, you'll learn how to improve your code with static analysis using CodeNarc.</p>
                                                <p><strong>Authors:</strong> Iván López</p>
                                                <p><strong>Grails Version:</strong> 3.3.0</p>

                                            </div>

                                            

<h1 id="gettingStarted">1 Getting Started</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/gettingStarted.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>When we write code, it&#8217;s important to follow some rules, right practices, style rules, etc. However, sometimes it is not that
simple. It is even more important when we work in a team, in which every member has his preferences. One way of
improving this is adding a static analysis tool for the code.</p>
</div>
<div class="paragraph">
<p>In this guide, you are going to install and configure <a href="http://codenarc.sourceforge.net/">Codenarc</a> to help you improve the
 quality of your Grails code, and you are also going to learn how to create a custom CodeNarc rule.
 CodeNarc analyzes the Groovy code and reports potential bugs and code problems.</p>
</div>


<h2 id="requirements">1.1 What you will need</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/requirements.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To complete this guide, you will need the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some time on your hands</p>
</li>
<li>
<p>A decent text editor or IDE</p>
</li>
<li>
<p>JDK 1.7 or greater installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
</ul>
</div>


<h2 id="howto">1.2 How to complete the guide</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/howto.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To get started do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/grails-guides/grails-codenarc/archive/master.zip">Download</a> and unzip the source</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clone the <a href="https://git-scm.com/">Git</a> repository:<br>
<code>git clone <a href="https://github.com/grails-guides/grails-codenarc.git" class="bare">https://github.com/grails-guides/grails-codenarc.git</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Grails guides repositories contain two folders:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>initial</code>  Initial project. Often a simple Grails app with additional some code to give you a head-start.</p>
</li>
<li>
<p><code>complete</code> A completed example. It is the result of working through the steps presented by the guide and applying those changes to the <code>initial</code> folder.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To complete the guide, go to the <code>initial</code> folder</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cd</code> into <code>grails-guides/grails-codenarc/initial</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and follow the instructions in the next sections.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can go right to the <strong>completed example</strong> if you <code>cd</code> into <code>grails-guides/grails-codenarc/complete</code>
</td>
</tr>
</table>
</div>


<h1 id="writingTheApp">2 Writing the Application</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/writingTheApp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="multiproject">2.1 Multi-Project Build</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/multiproject.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>We are going to setup a multi-project build with a Grails application and a custom
CodeNarc Rule as shown in the next image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/multiproject.png" alt="multiproject">
</div>
</div>
<div class="paragraph">
<p>Check our <a href="http://guides.grails.org/grails-multi-project-build/guide/index.html">Grails Multi-Project Build</a> Guide, to learn more.</p>
</div>


<h2 id="ruleTypes">2.2 Rule Types</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/ruleTypes.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Current CodeNarc version (0.27.0) includes <a href="http://codenarc.sourceforge.net/codenarc-rule-index.html">348 rules</a> divided
in 22 categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Basic</strong>: For example to check that there are no empty <code>else</code> or <code>finally</code> blocks.</p>
</li>
<li>
<p><strong>Braces</strong>: How many times have you seen an <code>if</code> or <code>else</code> with only one statement without the curly-braces? I personally
don&#8217;t like code without curly-braces because it&#8217;s a source of bugs in the future. We can add the rules in this category to perform these checks.</p>
</li>
<li>
<p><strong>Convention</strong>: There are rules to check for some conventions: when we write an "inverted" <code>if</code>, an <code>if</code> that can be
converted to an elvis operator,&#8230;&#8203;</p>
</li>
<li>
<p><strong>Exceptions</strong>: Rules that will fail if, for example, we throw a <code>NullPointerException</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And there are many more categories to check for duplicated imports, unused variables, unnecessary ifs,&#8230;&#8203; And of course there&#8217;s a specific category for Grails rules.</p>
</div>


<h2 id="addingCodenarc">2.3 Adding CodeNarc to our project</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/addingCodenarc.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Adding CodeNarc to our project is a simple task because there&#8217;s a <a href="https://docs.gradle.org/current/userguide/codenarc_plugin.html">Gradle plugin</a>
 to do it.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s modify <code>build.gradle</code> and add the following:</p>
</div>
<div class="listingblock">
<div class="title">/app/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">from</span>: <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>rootProject.projectDir<span class="inline-delimiter">}</span></span><span class="content">/gradle/codenarc.gradle</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We encapsulate all the CodeNarc configuration in <code>gradle/codenarc.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="title">/gradle/codenarc.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">codenarc</span><span class="delimiter">'</span></span> <i class="conum" data-value="1"></i><b>(1)</b>

codenarc {
    toolVersion = <span class="string"><span class="delimiter">'</span><span class="content">0.27.0</span><span class="delimiter">'</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
    configFile = file(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>rootProject.projectDir<span class="inline-delimiter">}</span></span><span class="content">/config/codenarc/rules.groovy</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="3"></i><b>(3)</b>
    reportFormat = <span class="string"><span class="delimiter">'</span><span class="content">html</span><span class="delimiter">'</span></span> <i class="conum" data-value="4"></i><b>(4)</b>
    ignoreFailures = <span class="predefined-constant">true</span> <i class="conum" data-value="5"></i><b>(5)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Apply the <code>codenarc</code> plugin.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Set the CodeNarc version we want to use.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the main file with the rules. By default CodeNarc uses <code>config/codenarc/codenarc.xml</code> but we don&#8217;t want to
write XML files, don&#8217;t we?</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The report format we want. For a human-readable format we use <code>html</code>. If we want to integrate CodeNarc with, for
example, Jenkins we need to change it to <code>xml</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>We don&#8217;t want that the build fails when there&#8217;s only one violation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then we need to create the rules file:</p>
</div>
<div class="listingblock">
<div class="title">/config/codenarc/rules.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ruleset {
    description <span class="string"><span class="delimiter">'</span><span class="content">Grails-CodeNarc Project RuleSet</span><span class="delimiter">'</span></span>

    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/basic.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/braces.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/convention.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/design.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/dry.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/exceptions.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/formatting.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/generic.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/imports.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/naming.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/unnecessary.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/unused.xml</span><span class="delimiter">'</span></span>)
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/grails.xml</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this configuration we can just run the <code>check</code> task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ ./gradlew app:check

:check UP-TO-DATE
:complete:codenarcMain
CodeNarc rule violations were found. See the report at: file:///home/ivan/workspaces/oci/guides/grails-codenarc/complete/app/build/reports/codenarc/main.html
:complete:codenarcTest NO-SOURCE
:complete:compileJava NO-SOURCE
:complete:compileGroovy UP-TO-DATE
:complete:buildProperties UP-TO-DATE
:complete:processResources UP-TO-DATE
:complete:classes UP-TO-DATE
:complete:compileTestJava NO-SOURCE
:complete:compileTestGroovy NO-SOURCE
:complete:processTestResources NO-SOURCE
:complete:testClasses UP-TO-DATE
:complete:test NO-SOURCE
:complete:check

Total time: 1.953 secs</code></pre>
</div>
</div>
<div class="paragraph">
<p>And we can open the test report to check the violations:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/report1.png" alt="report1">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>First, we have a section with the execution date and the CodeNarc version used.</p>
</li>
<li>
<p>Then there&#8217;s another section with a Summary with the total of files with violations and also the number of violations with priority 1, 2 and 3.</p>
</li>
<li>
<p>After that, there&#8217;s a section for each file in which we can see all the violations in the file with the line of code and a small fragment of it. The rule name is a link to a more detailed explanation.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_let_s_fix_the_violations">Let&#8217;s fix the violations</h3>
<div class="paragraph">
<p>There are different ways of fixing a CodeNarc violation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fixing the problem: As the name implies, just fix the violation.</p>
</li>
<li>
<p>Disabling the rule: Sometimes we don&#8217;t agree with that specific CodeNarc violation. We can disable it.</p>
</li>
<li>
<p>Ignoring the rule for that specific class or method: This case is when we don&#8217;t want to disable the rule but want to
skip it only in a particular class or method.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_fix_the_problem">Fix the problem</h4>
<div class="ulist">
<ul>
<li>
<p>To fix the violation <code>FileEndsWithoutNewline</code> add a new line at the end of <code>UrlMappings</code> file.</p>
</li>
<li>
<p>To fix the violation <code>SpaceBeforeOpeningBrace</code> add a space before the braces.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_disable_the_rule">Disable the rule</h4>
<div class="paragraph">
<p>For the case of <code>ClassJavadoc</code> and <code>NoDef</code> we can just disable the rules modifying the <code>rules.groovy</code> file:</p>
</div>
<div class="listingblock">
<div class="title">/app/src/codenarc/rules.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ruleset {
    description <span class="string"><span class="delimiter">'</span><span class="content">Grails-CodeNarc Project RuleSet</span><span class="delimiter">'</span></span>

    ...
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/convention.xml</span><span class="delimiter">'</span></span>) {
        <span class="string"><span class="delimiter">'</span><span class="content">NoDef</span><span class="delimiter">'</span></span> {
            enabled = <span class="predefined-constant">false</span>
        }
    }
    ...
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/formatting.xml</span><span class="delimiter">'</span></span>) {
        <span class="string"><span class="delimiter">'</span><span class="content">ClassJavadoc</span><span class="delimiter">'</span></span> {
            enabled = <span class="predefined-constant">false</span>
        }
    }
    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ignoring_a_rule">Ignoring a rule</h4>
<div class="paragraph">
<p>Finally, we can ignore a rule for a particular class. In this case, we&#8217;re going to ignore the <code>UnnecessaryGString</code> rule
for <code>UrlMappings.groovy</code> using <code>@SuppressWarnings</code>:</p>
</div>
<div class="listingblock">
<div class="title">/app/grails-app/controllers/demo/UrlMappings.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@SuppressWarnings</span>([<span class="string"><span class="delimiter">'</span><span class="content">UnnecessaryGString</span><span class="delimiter">'</span></span>])
<span class="type">class</span> <span class="class">UrlMappings</span> {

    <span class="directive">static</span> mappings = {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>controller</span><span class="content">/</span><span class="inline"><span class="inline-delimiter">$</span>action</span><span class="content">?/</span><span class="inline"><span class="inline-delimiter">$</span>id</span><span class="content">?(.</span><span class="inline"><span class="inline-delimiter">$</span>format</span><span class="content">)?</span><span class="delimiter">&quot;</span></span> {
            constraints {
                <span class="comment">// apply constraints here</span>
            }
        }

        <span class="string"><span class="delimiter">&quot;</span><span class="content">/</span><span class="delimiter">&quot;</span></span>(<span class="key">view</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">/index</span><span class="delimiter">&quot;</span></span>)
        <span class="string"><span class="delimiter">&quot;</span><span class="content">500</span><span class="delimiter">&quot;</span></span>(<span class="key">view</span>:<span class="string"><span class="delimiter">'</span><span class="content">/error</span><span class="delimiter">'</span></span>)
        <span class="string"><span class="delimiter">&quot;</span><span class="content">404</span><span class="delimiter">&quot;</span></span>(<span class="key">view</span>:<span class="string"><span class="delimiter">'</span><span class="content">/notFound</span><span class="delimiter">'</span></span>)
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_checking_the_result">Checking the result</h4>
<div class="paragraph">
<p>Just execute again the <code>check</code> task and open the report to see that all the violations are gone:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/report2.png" alt="report2">
</div>
</div>
</div>
</div>


<h2 id="finalConfiguration">2.4 Final configuration</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/finalConfiguration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you install CodeNarc in a medium-big size project, which has not use any static analysis tool before, you may have hundreds or event thousands of violations. It is possible that your team has not been careful enough while writing code. Moreover, it is likely that CodeNarc default configuration contains some rules you don&#8217;t agree with. Rules which might not be a good fit for the team.</p>
</div>
<div class="paragraph">
<p>My advice is to review all the violations, read their documentation and then decide if you want to disable them,
configure with another option and finally fix and respect them.</p>
</div>
<div class="paragraph">
<p>Once the team decides the rules and the configuration the next step is to choose the thresholds to make the build fail.
These thresholds allow having successful builds with some violations but, once we reach these levels, the build will fail.</p>
</div>
<div class="paragraph">
<p>To do that, just edit the <code>build.gradle</code> file:</p>
</div>
<div class="listingblock">
<div class="title">/app/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">codenarc {
    ...
    <span class="comment">// We need to remove the following line</span>
    <span class="comment">//ignoreFailures = true</span>

    maxPriority1Violations = <span class="integer">0</span>
    maxPriority2Violations = <span class="integer">5</span>
    maxPriority3Violations = <span class="integer">9</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this configuration the build will fail once we reach these thresholds.</p>
</div>


<h1 id="writingCustomRule">3 Writing a custom Rule</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/writingCustomRule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Although CodeNarc provides some <a href="http://codenarc.sourceforge.net/codenarc-rules-grails.html">rules</a> specific for Grails,
some times we may want to create our own rules.</p>
</div>
<div class="paragraph">
<p>In this example we&#8217;re going to create a rule to check that we use <br>
<code>grails.gorm.transactions.Transactional</code> instead of
<code>@org.springframework.transaction.annotation.Transactional</code>.<br>
As you probably know the Grails <code>@Transactional</code> annotation is better because it doesn&#8217;t create a runtime proxy. It&#8217;s an AST Transformation that it&#8217;s applied during compilation time, so there&#8217;s no runtime overhead. There&#8217;s also other features that the Grails annotation provides and
the Spring one don&#8217;t.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>grails.gorm.transactions.Transactional</code> is only available for the latest versions of GORM (this guide uses GORM 6.1.6.RELEASE), for previous versions you should use <code>@grails.transaction.Transactional</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The rule checks our code. If we use the Spring annotation, it adds a new violation to the report.</p>
</div>


<h2 id="customRule">3.1 Creating the Rule</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/customRule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect2">
<h3 id="_create_the_project">Create the project</h3>
<div class="paragraph">
<p>We need to create a new Groovy project because we want to package the rule in its own jar file using Gradle.</p>
</div>
<div class="listingblock">
<div class="title">/codenarc-rule/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">'</span><span class="content">groovy</span><span class="delimiter">'</span></span>

repositories {
    jcenter()
}

dependencies {
    compile <span class="string"><span class="delimiter">'</span><span class="content">org.codenarc:CodeNarc:0.27.0</span><span class="delimiter">'</span></span> <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Only need CodeNarc dependency</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to be able to user this new CodeNarc rule in our Grails application we need to make sure that the jar file
is available in the classpath during the <code>codenarcMain</code> taks:</p>
</div>
<div class="listingblock">
<div class="title">/gradle/codenarc.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">codenarcMain.dependsOn <span class="string"><span class="delimiter">'</span><span class="content">:codenarc-rule:jar</span><span class="delimiter">'</span></span> <i class="conum" data-value="1"></i><b>(1)</b>

tasks.withType(CodeNarc) { <i class="conum" data-value="2"></i><b>(2)</b>
    codenarcClasspath += files(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>rootProject.projectDir<span class="inline-delimiter">}</span></span><span class="content">/codenarc-rule/build/libs/codenarc-rule.jar</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>CodeNarc tasks depend on the jar being generated</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add the jar to the <code>codenarcClasspath</code></td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_define_the_rule">Define the rule</h4>
<div class="paragraph">
<p>The first step is create a meta-information file with the information about the rule we want to create:</p>
</div>
<div class="listingblock">
<div class="title">/codenarc-rule/src/main/resources/rulesets/grails-extra.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;ruleset</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://codenarc.org/ruleset/1.0</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://codenarc.org/ruleset/1.0 http://codenarc.org/ruleset-schema.xsd</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">xsi:noNamespaceSchemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://codenarc.org/ruleset-schema.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;description&gt;</span>Extra Grails rules<span class="tag">&lt;/description&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;rule</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">'</span><span class="content">org.codenarc.rule.grails.GrailsTransactionalRule</span><span class="delimiter">'</span></span><span class="tag">/&gt;</span> <i class="conum" data-value="2"></i><b>(2)</b>
<span class="tag">&lt;/ruleset&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The description of the group of rules.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>One <code>rule</code> element per rule we create.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Second we create a properties file with the description of the rule in both plain text and html. The messages will be
used in the html report:</p>
</div>
<div class="listingblock">
<div class="title">/codenarc-rule/src/main/resources/codenarc-messages.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">GrailsTransactional.description=Check that @org.springframework.transaction.annotation.Transactional is used instead of org.springframework.transaction.annotation.Transactional.
GrailsTransactional.description.html=Check that &lt;em&gt;@grails.gorm.transactions.Transactional&lt;/em&gt; is used instead of &lt;em&gt;org.springframework.transaction.annotation.Transactional&lt;/em&gt;.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implement_the_rule">Implement the rule</h3>
<div class="paragraph">
<p>Finally, we implement the rule:</p>
</div>
<div class="listingblock">
<div class="title">/codenarc-rule/src/main/groovy/org/codenarc/rule/grails/GrailsTransactionalRule.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> org.codenarc.rule.grails

<span class="keyword">import</span> <span class="include">groovy.transform.CompileStatic</span>
<span class="keyword">import</span> <span class="include">org.codehaus.groovy.ast.AnnotatedNode</span>
<span class="keyword">import</span> <span class="include">org.codehaus.groovy.ast.AnnotationNode</span>
<span class="keyword">import</span> <span class="include">org.codehaus.groovy.ast.ImportNode</span>
<span class="keyword">import</span> <span class="include">org.codehaus.groovy.ast.ModuleNode</span>
<span class="keyword">import</span> <span class="include">org.codenarc.rule.AbstractAstVisitor</span>
<span class="keyword">import</span> <span class="include">org.codenarc.rule.AbstractAstVisitorRule</span>

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">GrailsTransactionalRule</span> <span class="directive">extends</span> AbstractAstVisitorRule { <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="type">int</span> priority = <span class="integer">2</span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="predefined-type">String</span> name = <span class="string"><span class="delimiter">'</span><span class="content">GrailsTransactional</span><span class="delimiter">'</span></span> <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="predefined-type">Class</span> astVisitorClass = GrailsTransactionalVisitor <i class="conum" data-value="4"></i><b>(4)</b>
}

<span class="annotation">@CompileStatic</span>
<span class="type">class</span> <span class="class">GrailsTransactionalVisitor</span> <span class="directive">extends</span> AbstractAstVisitor { <i class="conum" data-value="5"></i><b>(5)</b>

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> SPRING_TRANSACTIONAL = <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.transaction.annotation.Transactional</span><span class="delimiter">'</span></span>
    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> ERROR_MSG = <span class="string"><span class="delimiter">'</span><span class="content">Do not use Spring @Transactional, use @grails.gorm.transactions.Transactional instead</span><span class="delimiter">'</span></span>

    <span class="annotation">@Override</span>
    <span class="type">void</span> visitAnnotations(AnnotatedNode node) { <i class="conum" data-value="6"></i><b>(6)</b>
        node.annotations.each { AnnotationNode annotationNode -&gt;
            <span class="predefined-type">String</span> annotation = annotationNode.classNode.text
            <span class="keyword">if</span> (annotation == SPRING_TRANSACTIONAL) {
                addViolation(node, ERROR_MSG)
            }
        }

        <span class="local-variable">super</span>.visitAnnotations(node)
    }

    <span class="annotation">@Override</span>
    <span class="type">void</span> visitImports(ModuleNode node) { <i class="conum" data-value="7"></i><b>(7)</b>
        node.imports.each { ImportNode importNode -&gt;
            <span class="predefined-type">String</span> importClass = importNode.className

            <span class="keyword">if</span> (importClass == SPRING_TRANSACTIONAL) {
                node.lineNumber = importNode.lineNumber <i class="conum" data-value="8"></i><b>(8)</b>
                addViolation(node, ERROR_MSG)
            }
        }

        <span class="local-variable">super</span>.visitImports(node)
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The rule needs to extend from <code>AbstractAstVisitorRule</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define the violation priority</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the rule. It needs to be the same as defined previously in the meta-information file</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The class that implements the rule</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The visitor class needs to extend from <code>AbstractAstVisitor</code></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Check the annotations of the class and methods and in case that Spring <code>@Transactional</code> is used, add a new violation</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Check the imports of the class and is case of Spring <code>@Transactional</code> is imported, add a new violation</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>It&#8217;s important to set the <code>lineNumber</code> of the node because if not, the violation won&#8217;t be added</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_testing">Testing</h3>
<div class="paragraph">
<p>And of course we need to write tests to make sure that everything is working as expected:</p>
</div>
<div class="listingblock">
<div class="title">/codenarc-rule/src/test/groovy/org/codenarc/rule/grails/GrailsTransactionalRuleTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> org.codenarc.rule.grails

<span class="keyword">import</span> <span class="include">org.codenarc.rule.AbstractRuleTestCase</span>
<span class="keyword">import</span> <span class="include">org.codenarc.rule.Rule</span>
<span class="keyword">import</span> <span class="include">org.codenarc.rule.Violation</span>
<span class="keyword">import</span> <span class="include">org.junit.Test</span>

<span class="type">class</span> <span class="class">GrailsTransactionalRuleTest</span> <span class="directive">extends</span> AbstractRuleTestCase { <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> Rule createRule() { <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="keyword">return</span> <span class="keyword">new</span> GrailsTransactionalRule()
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testGrailsTransactionalIsAllowedOnClassWithImport() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content"> <i class="conum" data-value="3"></i><b>(3)</b>
            import grails.gorm.transactions.Transactional

            @Transactional
            class TestService {
            }
        </span><span class="delimiter">'''</span></span>

        assertNoViolations(SOURCE) <i class="conum" data-value="4"></i><b>(4)</b>
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testGrailsTransactionalIsAllowedOnClassWithFullpackageAnnotation() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content">
            @grails.gorm.transactions.Transactional
            class TestService {
            }
        </span><span class="delimiter">'''</span></span>

        assertNoViolations(SOURCE)
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testGrailsTransactionalIsAllowedOnMethodWithImport() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content">
            import grails.gorm.transactions.Transactional

            class TestService {
                @Transactional
                void foo() {
                }
            }
        </span><span class="delimiter">'''</span></span>

        assertNoViolations(SOURCE)
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testGrailsTransactionalIsAllowedOnMethodWithFullpackageAnnotation() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content">
            class TestService {
                @grails.gorm.transactions.Transactional
                void foo() {
                }
            }
        </span><span class="delimiter">'''</span></span>

        assertNoViolations(SOURCE)
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testSpringTransactionalIsNotAllowedOnClassWithImport() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content">
            import org.springframework.transaction.annotation.Transactional

            @Transactional
            class TestService {
            }
        </span><span class="delimiter">'''</span></span>

        <i class="conum" data-value="5"></i><b>(5)</b>
        assertSingleViolation(SOURCE) { Violation violation -&gt;
            violation.rule.priority == <span class="integer">2</span> &amp;&amp;
            violation.rule.name == <span class="string"><span class="delimiter">'</span><span class="content">GrailsTransactional</span><span class="delimiter">'</span></span>
        }
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testSpringTransactionalIsNotAllowedOnClassWithFullpackageAnnotation() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content">
            @org.springframework.transaction.annotation.Transactional
            class TestService {
            }
        </span><span class="delimiter">'''</span></span>

        assertSingleViolation(SOURCE) { Violation violation -&gt;
            violation.rule.priority == <span class="integer">2</span> &amp;&amp;
            violation.rule.name == <span class="string"><span class="delimiter">'</span><span class="content">GrailsTransactional</span><span class="delimiter">'</span></span>
        }
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testSpringTransactionalIsNotAllowedOnMethodWithImport() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content">
            import org.springframework.transaction.annotation.Transactional

            class TestService {
                @Transactional
                void foo() {
                }
            }
        </span><span class="delimiter">'''</span></span>

        assertSingleViolation(SOURCE) { Violation violation -&gt;
            violation.rule.priority == <span class="integer">2</span> &amp;&amp;
                violation.rule.name == <span class="string"><span class="delimiter">'</span><span class="content">GrailsTransactional</span><span class="delimiter">'</span></span>
        }
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testSpringTransactionalIsNotAllowedOnMethodWithFullpackageAnnotation() {
        <span class="directive">final</span> SOURCE = <span class="string"><span class="delimiter">'''</span><span class="content">
            class TestService {
                @org.springframework.transaction.annotation.Transactional
                void foo() {
                }
            }
        </span><span class="delimiter">'''</span></span>

        assertSingleViolation(SOURCE) { Violation violation -&gt;
            violation.rule.priority == <span class="integer">2</span> &amp;&amp;
                violation.rule.name == <span class="string"><span class="delimiter">'</span><span class="content">GrailsTransactional</span><span class="delimiter">'</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The test class needs to extend from <code>AbstractRuleTestCase</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Instantiate the rule we want to test</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Write the source code we want to test as a String</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>In this case, as we use Grails <code>@Transactional</code> we expect no violations</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>As we use Spring <code>@Transactional</code> we expect to have one violation</td>
</tr>
</table>
</div>
</div>


<h2 id="checkingRule">3.2 Checking the Rule in the Grails application</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/checkingRule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Once we have created the rule and it&#8217;s available on the classpath, it&#8217;s time to add it to the Grails application.</p>
</div>
<div class="listingblock">
<div class="title">/app/src/codenarc/rules.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ruleset {
    description <span class="string"><span class="delimiter">'</span><span class="content">Grails-CodeNarc Project RuleSet</span><span class="delimiter">'</span></span>

    ...
    ruleset(<span class="string"><span class="delimiter">'</span><span class="content">rulesets/grails-extra.xml</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can create a service and use Spring <code>@Transactional</code> on it:</p>
</div>
<div class="listingblock">
<div class="title">/app/build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="keyword">import</span> <span class="include">org.springframework.transaction.annotation.Transactional</span>

<span class="type">class</span> <span class="class">DemoService</span> {

    <span class="annotation">@Transactional</span>
    <span class="type">void</span> myMethod() {
        println <span class="string"><span class="delimiter">'</span><span class="content">Some business logic</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the final step is generating the CodeNarc report:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/report3.png" alt="report3">
</div>
</div>
<div class="paragraph">
<p>As we can see we have a new violation because the rule we created as been applied.</p>
</div>


<h1 id="helpWithGrails">4 Do you need help with Grails?</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/grails-codenarc/edit/master/src/main/docs/guide/helpWithGrails.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<h3 style="color: #333;">OCI sponsored the creation of this Guide. OCI offers several <a href="https://objectcomputing.com/products/grails/consulting-support/">Grails services</a>:</h3>

<img src="../img/oci-grails-services.svg"/>

<h3>Free consultation </h3>

<!-- This is the code that is needed to run the form -->

<!--Copy and paste into the document's head or body.-->

<script type="text/javascript">

    /** This section is only needed once per page if manually copying **/
    if (typeof MauticSDKLoaded == 'undefined') {
        var MauticSDKLoaded = true;
        var head            = document.getElementsByTagName('head')[0];
        var script          = document.createElement('script');
        script.type         = 'text/javascript';
        script.src          = 'https://mautic.objectcomputing.com/media/js/mautic-form.js';
        script.onload       = function() {
            MauticSDK.onLoad();
        };
        head.appendChild(script);
        var MauticDomain = 'https://mautic.objectcomputing.com';
        var MauticLang   = {
            'submittingMessage': "Please wait..."
        }
    }
</script>

<!--Copy and paste into the document's body.-->

<style type="text/css" scoped>
    .mauticform_wrapper { max-width: 600px; margin: 10px auto; }
    .mauticform-innerform {}
    .mauticform-post-success {}
    .mauticform-name { font-weight: bold; font-size: 1.5em; margin-bottom: 3px; }
    .mauticform-description { margin-top: 2px; margin-bottom: 10px; }
    .mauticform-error { margin-bottom: 10px; color: red; }
    .mauticform-message { margin-bottom: 10px;color: green; }
    .mauticform-row { display: block; margin-bottom: 20px; }
    .mauticform-label { font-size: 1.1em; display: block; font-weight: bold; margin-bottom: 5px; }
    .mauticform-row.mauticform-required .mauticform-label:after { color: #e32; content: " *"; display: inline; }
    .mauticform-helpmessage { display: block; font-size: 0.9em; margin-bottom: 3px; }
    .mauticform-errormsg { display: block; color: red; margin-top: 2px; }
    .mauticform-selectbox, .mauticform-input, .mauticform-textarea { width: 100%; padding: 0.5em 0.5em; border: 1px solid #CCC; background: #fff; box-shadow: 0px 0px 0px #fff inset; border-radius: 4px; box-sizing: border-box; }
    .mauticform-checkboxgrp-row {}
    .mauticform-checkboxgrp-label { font-weight: normal; }
    .mauticform-checkboxgrp-checkbox {}
    .mauticform-radiogrp-row {}
    .mauticform-radiogrp-label { font-weight: normal; }
    .mauticform-radiogrp-radio {}
    .mauticform-button-wrapper .mauticform-button.btn-default, .mauticform-pagebreak-wrapper .mauticform-pagebreak.btn-default { font-size: 14px; color: #fff;background-color: #feb672 ;border-color: #dddddd; padding: 15px 30px;}
    .mauticform-button-wrapper .mauticform-button, .mauticform-pagebreak-wrapper .mauticform-pagebreak { display: inline-block;margin-bottom: 0;font-weight: 600;text-align: center;vertical-align: middle;cursor: pointer;background-image: none;border: 1px solid transparent;white-space: nowrap;padding: 6px 12px;font-size: 13px;line-height: 1.3856;border-radius: none;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}
    .mauticform-button-wrapper .mauticform-button.btn-default[disabled], .mauticform-pagebreak-wrapper .mauticform-pagebreak.btn-default[disabled] { background-color:#feb672; border-color: #dddddd; opacity: 0.75; cursor: not-allowed; font-size: 14px; color: #fff; padding: 15px 30px;}
    .mauticform-pagebreak-wrapper .mauticform-button-wrapper {  display: inline; }
</style>
<div id="mauticform_wrapper_grailsorgconsultationform" class="mauticform_wrapper">
    <form autocomplete="false" role="form" method="post" action="https://mautic.objectcomputing.com/form/submit?formId=3" id="mauticform_grailsorgconsultationform" data-mautic-form="grailsorgconsultationform">

        <div class="mauticform-innerform">

          <div class="mauticform-page-wrapper mauticform-page-1" data-mautic-form-page="1">

            <div id="mauticform_grailsorgconsultationform_first_name"  data-validate="first_name" data-validation-type="text" class="mauticform-row mauticform-text mauticform-field-1 mauticform-required col-lg-6 col-md-6 col-sm-12 col-xs-12">
                <input id="mauticform_input_grailsorgconsultationform_first_name" name="mauticform[first_name]" value="" placeholder="First Name *" class="mauticform-input" type="text" />
                <span class="mauticform-errormsg" style="display: none;">This is required.</span>
            </div>

            <div id="mauticform_grailsorgconsultationform_last_name"  data-validate="last_name" data-validation-type="text" class="mauticform-row mauticform-text mauticform-field-2 mauticform-required col-lg-6 col-md-6 col-sm-12 col-xs-12">
                <input id="mauticform_input_grailsorgconsultationform_last_name" name="mauticform[last_name]" value="" placeholder="Last Name *" class="mauticform-input" type="text" />
                <span class="mauticform-errormsg" style="display: none;">This is required.</span>
            </div>

            <div id="mauticform_grailsorgconsultationform_email"  data-validate="email" data-validation-type="email" class="mauticform-row mauticform-email mauticform-field-3 mauticform-required col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <input id="mauticform_input_grailsorgconsultationform_email" name="mauticform[email]" value="" placeholder="Email *" class="mauticform-input" type="email" />
                <span class="mauticform-errormsg" style="display: none;">This is required.</span>
            </div>

            <div id="mauticform_grailsorgconsultationform_phone"  class="mauticform-row mauticform-tel mauticform-field-4 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <input id="mauticform_input_grailsorgconsultationform_phone" name="mauticform[phone]" value="" placeholder="Phone" class="mauticform-input" type="tel" />
                <span class="mauticform-errormsg" style="display: none;"></span>
            </div>

            <div id="mauticform_grailsorgconsultationform_company"  class="mauticform-row mauticform-text mauticform-field-5 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <input id="mauticform_input_grailsorgconsultationform_company" name="mauticform[company]" value="" placeholder="Company" class="mauticform-input" type="text" />
                <span class="mauticform-errormsg" style="display: none;"></span>
            </div>

            <div id="mauticform_grailsorgconsultationform_submit"  class="mauticform-row mauticform-button-wrapper mauticform-field-6" style="">
                <button type="submit" name="mauticform[submit]" id="mauticform_input_grailsorgconsultationform_submit" name="mauticform[submit]" value="" class="mauticform-button btn btn-default" value="1" style="border: none; margin-left: 14px;">SUBMIT</button>
            </div>
            </div>
        </div>

        <input type="hidden" name="mauticform[formId]" id="mauticform_grailsorgconsultationform_id" value="3"/>
        <input type="hidden" name="mauticform[return]" id="mauticform_grailsorgconsultationform_return" value=""/>
        <input type="hidden" name="mauticform[formName]" id="mauticform_grailsorgconsultationform_name" value="grailsorgconsultationform"/>
</form>
</div>

<!--The code below is the message that appears when someone hits submit. Feel free to style this how you see fit for Grails.org. All CSS is handled in the above code.-->

<div class="mauticform-error" id="mauticform_grailsorgconsultationform_error"></div>
<div class="mauticform-message" id="mauticform_grailsorgconsultationform_message"></div>

<h3 style="color: #333;">The <a href="https://objectcomputing.com/products/grails/consulting-support/">OCI Grails Team</a>
includes Grails co-founders, <b>Jeff Scott Brown and Graeme Rocher</b>.
Check our <a href="https://objectcomputing.com/training/catalog/grails/">Grails courses</a> and learn from the engineers who developed,
matured and maintain Grails.</h3>

<img src="../img/ocigrailsteam.png" style="max-width: 748px; width: 100%;" alt="Grails OCI Team">

                                        </div>
                                    </td>
                                    <td id="col2">
                                        <div class="local clearfix">
                                            <div class="local-title" style="text-align: right"><a href="https://travis-ci.org/grails-guides/grails-codenarc"><img src="https://travis-ci.org/grails-guides/grails-codenarc.svg?branch=master" /></a></div>            

                                            <div class="local-title">
                                                <a href="https://github.com/grails-guides/grails-codenarc">
                                                    <svg height="35" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="35" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg></a> &nbsp;&nbsp;Get the Code
                                                </div>
                                                <div class="menu">
                                                    <div class="input-group">                        
                                                        <button href="#" onclick="document.getElementById('github-url').value='git@github.com:grails-guides/grails-codenarc.git'" class="codeButton">SSH</button>
                                                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/grails-codenarc.git'" class="codeButton">HTTPS</button>
                                                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/grails-codenarc'" class="codeButton">Subversion</button>
                                                    </div>

                                                    <div class="input-group">                    
                                                        <!-- Target -->
                                                        <input id="github-url" value="git@github.com:grails-guides/grails-codenarc.git" type="text" />

                                                        <!-- Trigger -->
                                                        <button class="clipbtn" type="button" data-clipboard-target="#github-url">

                                                            <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
                                                        </button>       

                                                    </div>
                                                    <div class="input-group">
                                                      <a href="https://github.com/grails-guides/grails-codenarc/archive/master.zip" class="downloadButton">Download ZIP</a>
                                                  </div>
                                              </div>
                                              
                                              <div id="table-of-content">
                                                <h2>Table of Contents</h2>
                                                
                                                <div class="toc-item" style="margin-left:0px"><a href="#gettingStarted"><strong>1</strong><span>Getting Started</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#requirements"><strong>1.1</strong><span>What you will need</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#howto"><strong>1.2</strong><span>How to complete the guide</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:0px"><a href="#writingTheApp"><strong>2</strong><span>Writing the Application</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#multiproject"><strong>2.1</strong><span>Multi-Project Build</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#ruleTypes"><strong>2.2</strong><span>Rule Types</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#addingCodenarc"><strong>2.3</strong><span>Adding CodeNarc to our project</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#finalConfiguration"><strong>2.4</strong><span>Final configuration</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:0px"><a href="#writingCustomRule"><strong>3</strong><span>Writing a custom Rule</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#customRule"><strong>3.1</strong><span>Creating the Rule</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:10px"><a href="#checkingRule"><strong>3.2</strong><span>Checking the Rule in the Grails application</span></a></div>
                                                
                                                <div class="toc-item" style="margin-left:0px"><a href="#helpWithGrails"><strong>4</strong><span>Do you need help with Grails?</span></a></div>
                                                
                            <div style="clear:both" ></div>
                        </div>
                                            
                    </div>
                </td>
            </tr>
        </table>

        <div id="footer">
            Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. All guides are released with an ASLv2 license for the code, and Creative Commons license for the writing.
            
        </div>

            <!-- END CONTENT -->
          </div>
        </div>
      </div>
    </div>

<script type="text/javascript">
    new Clipboard('.clipbtn');
</script>
<script type="text/javascript" src="../js/docs.js"></script>
<script type="text/javascript" src="../js/classie.js"></script>        
<script type="text/javascript" src="../js/sidebarEffects.js"></script>
<script type="text/javascript" src="../js/navbar.js"></script> 
<style type="text/css">
    #colset {
        background-color: #f5f5f5;
    }
    .grailsnavbar {
        padding-right: 0;
    }
    #fork-me {
        display: none;
    }
</style>       
    </body>
</html>
