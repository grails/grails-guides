<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>4 Updating the Service</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/guide.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />            
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Grails Framework Guide 
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/training.html"><strong>1</strong><span>Grails Training</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>2</strong><span>Getting Started</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/testingTheService.html"><strong>3</strong><span>Testing the Service</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/updatingTheService.html"><strong>4</strong><span>Updating the Service</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/specialForms.html"><strong>5</strong><span>Convenient Exceptional Forms</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/dynamicFinderSummary.html"><strong>6</strong><span>Summary of Dynamic Finders</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/helpWithGrails.html"><strong>7</strong><span>Do you need help with Grails?</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/testingTheService.html">&lt;&lt; <strong>3</strong><span>Testing the Service</span></a></div>
                

                
                    <div class="toc-item next-right"><a href="../guide/specialForms.html"><strong>5</strong><span>Convenient Exceptional Forms</span> >></a></div>
                


                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#findByProp"><strong>4.1</strong><span>Find One By Value</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#findAllByProp"><strong>4.2</strong><span>Find Many By Value</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#findByInequality"><strong>4.3</strong><span>Find By Inequality</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#countingMatches"><strong>4.4</strong><span>Counting Matching Instances</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#findByRange"><strong>4.5</strong><span>Find By Value Range</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#findByStringComp"><strong>4.6</strong><span>Find by Similar Strings</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#findByNull"><strong>4.7</strong><span>Find By Null/Non-Null</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#findInList"><strong>4.8</strong><span>Find Property In List</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#combinators"><strong>4.9</strong><span>Combining Query Clauses</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#queryParameters"><strong>4.10</strong><span>Parameterizing Queries</span></a>
                    </div>
                    
                </div>
                

                

<h1 id="updatingTheService">4 Updating the Service</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://gorm.grails.org/latest/hibernate/manual/index.html#finders">Dynamic finders</a> are methods generated
at runtime. Though the methods don&#8217;t exist initially, Grails uses the Groovy metaprogramming hooks
<a href="http://groovy-lang.org/metaprogramming.html#_methodmissing"><code>methodMissing</code></a> and
<a href="http://groovy-lang.org/metaprogramming.html#_propertymissing"><code>propertyMissing</code></a> to recognize when you
attempt to call one. Grails will then examine the method name you use and generate an appropriate
implementation, including the corresponding database query.</p>
</div>
<div class="paragraph">
<p>Dynamic finders read like English commands. For example, if I want to find all the board games with an
average play duration between 30 and 90 minutes, it might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> games = Game.findAllByAverageDurationBetween(<span class="integer">30</span>, <span class="integer">90</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This guide will explore ways to build dynamic finders by updating all the methods in
<code>QueryService</code> with implementations that use dynamic finders, such that the new
implementations continue to pass all unit tests in <code>QueryServiceSpec</code>.</p>
</div>


<h2 id="findByProp">4.1 Find One By Value</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/findByProp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The first method to update is <code>QueryService.queryGame</code> which takes a single <code>name</code> parameter.
The existing code loads all instances of the <code>Game</code> domain class, and searches for the single
instance whose name matches the parameter. (We only expect to find one, since the <code>name</code> property
of <code>Game</code> is unique.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGame</span>(<span class="predefined-type">String</span> name) {
    Game.all.find {
        <span class="local-variable">it</span>.name == name
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>all</code> property on <code>Game</code> does exactly what it sounds like: it fetches all of the instances
from the database into memory. This terrible implementation fetches all of the instances
when only one is needed; this is highly inefficient code! Let&#8217;s get exactly the one instance we
want (i.e. the one with the provided name) using a dynamic finder.</p>
</div>
<div class="paragraph">
<p>Every dynamic finder starts with a prefix. Since we expect to find only one game (because
the name is constrained to be unique), we can use <code>findBy</code>, which will
return the matching instance if one is found or a <code>null</code> if no match is found.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>findBy</code> can also be used to retrieve only the first of many matching instances.
However, you should consider adding a sort column, described in
<a href="#queryParameters">Parameterizing Queries</a>, to make your query robust.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After determining the prefix, next we need the property to match against. The <code>Game</code> domain class
has a <code>name</code> property that the inefficient implementation used; by appending (using camel-case) the
property name to the prefix, we create the dynamic finder <code>findByName</code> to find the desired game.
This method should be called on the domain class of interest: in this case, <code>Game</code>. So our dynamic
finder call will be <code>Game.findByName(&#8230;&#8203;)</code>.</p>
</div>
<div class="paragraph">
<p>At the same time we add a property name to the dynamic finder method <em>name</em>, we should also add an
argument to the dynamic finder method <em>call</em>; in this case, we want to use the <code>name</code> parameter
provided by the <code>queryGame</code> method. So the final, efficient implementation of <code>queryGame</code> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGame</span>(<span class="predefined-type">String</span> name) {
    Game.findByName(name)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Change the implementation and run the tests to see that they still pass.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you append a property name to a dynamic finder method, you also append a corresponding
argument to the method call <strong>in most cases</strong>. The few cases that differ in this respect will be
pointed out in later sections of this guide.
</td>
</tr>
</table>
</div>


<h2 id="findAllByProp">4.2 Find Many By Value</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/findAllByProp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Knowing how to find one instance by a property value, we can find multiple instances by a
(non-unique) property value by changing the prefix. Instead of <code>findBy</code>, use <code>findAllBy</code> to
return a list of matching instances. If none match, the list will be empty.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s update <code>QueryService.queryGamesWithAverageDuration</code>, a method used to collect all of
the board games with the provided average duration. Here is the existing, inefficient implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesWithAverageDuration</span>(<span class="predefined-type">Integer</span> averageDuration) {
    Game.all.findAll {
        <span class="local-variable">it</span>.averageDuration == averageDuration
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As before, this slow implementation loads all records into memory, then searches over them.
The database engine is much quicker and the memory load is much lower if only the matching records
are returned, so let&#8217;s change this to a dynamic finder.</p>
</div>
<div class="paragraph">
<p>To find multiple records, use the <code>findAllBy</code> prefix. Append the property name <code>averageDuration</code>
(updating capitalization for consistent camel-case of the dynamic finder method name), and pass
the <code>averageDuration</code> parameter from <code>queryGamesWithAverageDuration</code> as an argument to the
dynamic finder method call.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesWithAverageDuration</span>(<span class="predefined-type">Integer</span> averageDuration) {
    Game.findAllByAverageDuration(averageDuration)
}</code></pre>
</div>
</div>


<h2 id="findByInequality">4.3 Find By Inequality</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/findByInequality.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The previous methods searched for matching instances by value equality. Dynamic finders
can search also by inequality: whether the property is not equal to, is greater than,
or is less than the provided value.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at <code>QueryService.queryGamesNotConsideredStrategy</code> which attempts to find all
games that, according to the database, are not marked as strategy games.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesNotConsideredStrategy</span>() {
    Game.all.findAll {
        <span class="local-variable">it</span>.strategy != <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It would be more idiomatic to write the predicate as <code>!it.strategy</code>, but for this
demo, the not-equal comparison against <code>true</code> is made explicit to better illustrate the
similarity between the inefficient version and the dynamic finder version.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since we expect there will be more than one result, we still need to use the prefix
<code>findAllBy</code>. The property of interest is <code>strategy</code>, a boolean flag. But using the dynamic
finder <code>findAllByStrategy(true)</code> finds all of the strategy games, and we want the non-strategy
games. In order to find those, we need to add a <strong>comparator</strong>. A comparator changes the query
from an equality test to something else. You&#8217;ll see many of
these in the sections to follow. Here, we will use the comparator <code>NotEqual</code> which, when
appended to the property name in the dynamic finder method name, generates a query that
matches on non-equality.</p>
</div>
<div class="paragraph">
<p>Our improved query to find non-strategy games is then:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesNotConsideredStrategy</span>() {
    <span class="comment">// General case: using the NotEqual comparator.</span>
    Game.findAllByStrategyNotEqual(<span class="predefined-constant">true</span>)    <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="comment">// Special case: using exceptional form for Boolean properties.</span>
    Game.findAllNotStrategy()    <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This query demonstrates the general form of a dynamic finder using the <code>NotEqual</code> comparator.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This query demonstrates the <a href="#simplerBooleans">exceptional form</a> of dynamic finders for boolean properties.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Though the second form shown here is more compact and readable, the first form
using the <code>NotEqual</code> comparator will work equally well for any database types; it is used
here with a boolean property simply to demonstrate how the comparator works.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What if we want a greater than or less than comparison? Let&#8217;s look at
<code>QueryService.queryGamesExpectedShorterThan</code>, which will return a list of
games with an average duration shorter than the provided value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesExpectedShorterThan</span>(<span class="predefined-type">Integer</span> duration) {
    Game.all.findAll {
        <span class="local-variable">it</span>.averageDuration &lt; duration
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, we know to start with <code>findAllByAverageDuration</code>. Since we want to
match property values that are <strong>less than</strong> the provided value, we should use the
<code>LessThan</code> comparator. Again, this comparator is appended after the property name,
so our final, improved implementation is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesExpectedShorterThan</span>(<span class="predefined-type">Integer</span> duration) {
    Game.findAllByAverageDurationLessThan(duration)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is a similar comparator when you need instances with property values <strong>greater than</strong> the
supplied argument: use <code>GreaterThan</code>. For example, <code>QueryService.queryGamesRatedMoreThan</code> will
find all games with a rating higher than the provided rating. The original implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesRatedMoreThan</span>(<span class="predefined-type">BigDecimal</span> rating) {
    Game.all.findAll {
        <span class="local-variable">it</span>.rating &gt; rating
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our dynamic finder for this query will be called <code>findAllByRatingGreaterThan</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesRatedMoreThan</span>(<span class="predefined-type">BigDecimal</span> rating) {
    Game.findAllByRatingGreaterThan(rating)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>LessThan</code> and <code>GreaterThan</code> comparators are <em>strict</em> inequality comparisons; that is,
if the values compared are equal, the instance is <strong>not</strong> considered a match. If you need to
also include equality, use the non-strict <code>LessThanEquals</code> and <code>GreaterThanEquals</code> comparators.</p>
</div>


<h2 id="countingMatches">4.4 Counting Matching Instances</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/countingMatches.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Sometimes, you don&#8217;t need the actual results of a query, but rather just
how many instances <strong>did</strong> match. As before, this inefficient implementation loads
all the records, then counts how many match a predicate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryHowManyGamesRatedAtLeast</span>(<span class="predefined-type">BigDecimal</span> rating) {
    Game.all.count {
        <span class="local-variable">it</span>.rating &gt;= rating
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A more efficient implementation of the above would call the dynamic finder
<code>Game.findAllByRatingGreaterThanEquals(rating)</code>, then return the size of the
resulting list. But if all you need is a single number&#8201;&#8212;&#8201;the count of matching
records&#8201;&#8212;&#8201;it is inefficient to fetch the results of the database query into memory.</p>
</div>
<div class="paragraph">
<p>In this case, use the prefix <code>countBy</code>. It works very much like <code>findAllBy</code>, but
instead of returning the matching instances, it returns the number of instances matched.
So to count how many games rated a certain value or higher:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryHowManyGamesRatedAtLeast</span>(<span class="predefined-type">BigDecimal</span> rating) {
    Game.countByRatingGreaterThanEquals(rating)
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By now, you&#8217;ve probably noticed that the <code>QueryService</code> methods, when implemented
efficiently using dynamic finders, is not really useful as-is. That said, Grails services
often do much more business logic that what this guide attempts to teach. The use of the
service here helps to separate the work from the tests.
</td>
</tr>
</table>
</div>


<h2 id="findByRange">4.5 Find By Value Range</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/findByRange.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>What if you need to find instances where some property falls in between two values?
Maybe you want to know all the games played (represented by the domain class <code>Match</code>) between two dates?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryMatchesPlayedBetweenDates</span>(<span class="predefined-type">Date</span> startDate, <span class="predefined-type">Date</span> finishDate) {
    Match.all.findAll {
        startDate &lt;= <span class="local-variable">it</span>.started &amp;&amp; <span class="local-variable">it</span>.started &lt;= finishDate
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the comparator <code>Between</code>. As mentioned earlier, most comparators expect a matching argument
in the dynamic finder call. However, <code>Between</code> is one of the exceptions, and it expects <strong>two</strong> arguments:
the lower and upper bounds. In the case of <code>QueryService.queryMatchesPlayedBetweenDates</code>, the lower and
upper bounds are the start and finish dates.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We will use the <code>started</code> property of <code>Match</code> as the property to examine. We could
have chosen to look at the <code>finished</code> property, but that could be null while <code>started</code>
cannot be null according to the constraints of <code>Match</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now we know the parts to build up our dynamic finder call: <code>findAllBy</code> to look for multiple,
matching instances; <code>started</code> as the property to examine; and <code>Between</code> as the operator to
find values of the property between provided lower and upper bounds. Here is the efficient
implementation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryMatchesPlayedBetweenDates</span>(<span class="predefined-type">Date</span> startDate, <span class="predefined-type">Date</span> finishDate) {
    Match.findAllByStartedBetween(startDate, finishDate)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A similar comparator is <code>InRange</code>, which works like <code>Between</code> but accepts a Groovy range as
the argument. As an example, we want to find out how many high scores there are across all
played games. Let&#8217;s define high scores to be in the range 90-100.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Range highScore = <span class="integer">90</span>..<span class="integer">100</span>
<span class="keyword">def</span> numHighScores = queryService.queryHowManyScoresWithinRange(highScore)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here&#8217;s the old, inefficient implementation of <code>queryHowManyScoresWithinRange</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryHowManyScoresWithinRange</span>(Range range) {
    Score.all.count {
        <span class="local-variable">it</span>.score <span class="keyword">in</span> range
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since we only want to know how many high scores there are (and not the scores themselves),
we&#8217;ll use the <code>countBy</code> prefix. We need to look at the <code>score</code> property of the <code>Score</code>
domain class, and we&#8217;ll use <code>InRange</code> to compare against the provided range. Here is
the improved implementation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryHowManyScoresWithinRange</span>(Range range) {
    Score.countByScoreInRange(range)
}</code></pre>
</div>
</div>


<h2 id="findByStringComp">4.6 Find by Similar Strings</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/findByStringComp.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In addition to inequality comparisons (with types such as numbers and dates), we want to
do inexact string comparisons&#8230;&#8203; to know that one string is similar or "like" another string.
Here follows three examples that we should improve with a dynamic finder.</p>
</div>
<div class="paragraph">
<p>First, find all players having a certain last name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryPlayersWithLastName</span>(<span class="predefined-type">String</span> lastName) {
    Player.all.findAll {
        <span class="local-variable">it</span>.name.endsWith <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="inline"><span class="inline-delimiter">${</span>lastName<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>GORM provides the dynamic finder comparator <code>Like</code> for string comparisons, and it
uses the character <code>%</code> in the search string as a wildcard. So the above can more
efficiently be written as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryPlayersWithLastName</span>(<span class="predefined-type">String</span> lastName) {
    Player.findAllByNameLike(<span class="string"><span class="delimiter">&quot;</span><span class="content">% </span><span class="inline"><span class="inline-delimiter">${</span>lastName<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>%</code> wildcard can go anywhere in the search string: front, back, middle, even
multiple locations. It can match any string, even empty.</p>
</div>
<div class="paragraph">
<p>The second example finds all game mechanics whose name contains a snippet of text,
case-insensitive.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryMechanicsContaining</span>(<span class="predefined-type">String</span> text) {
    Mechanic.all.findAll {
        StringUtils.containsIgnoreCase <span class="local-variable">it</span>.name, text
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The earlier comparator <code>Like</code> was case-sensitive; it matched anything where the <code>%</code>
wildcards appeared, but other text was an exact match. If you want to search
ignoring case, use the <code>Ilike</code> comparator. You can still use wildcards, as is done here.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryMechanicsContaining</span>(<span class="predefined-type">String</span> text) {
    Mechanic.findAllByNameIlike(<span class="string"><span class="delimiter">&quot;</span><span class="content">%</span><span class="inline"><span class="inline-delimiter">${</span>text<span class="inline-delimiter">}</span></span><span class="content">%</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In our third example, we find all games where the name matches a regular expression pattern.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesMatching</span>(<span class="predefined-type">String</span> pattern) {
    Game.all.findAll {
        <span class="local-variable">it</span>.name ==~ pattern
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://en.wikipedia.org/wiki/Regular_expression">Regular expressions</a> are a handy tool for
developers to define complex search expressions in a compact form. Groovy provides
<a href="http://docs.groovy-lang.org/latest/html/documentation/#_regular_expression_operators">support for regular expressions</a>
built upon the
<a href="https://docs.oracle.com/javase/tutorial/essential/regex/">Regular Expression APIs in Java</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To do regular expression matching, use the <code>Rlike</code> comparator in your dynamic finder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryGamesMatching</span>(<span class="predefined-type">String</span> pattern) {
    Game.findAllByNameRlike(pattern)      <span class="comment">// Rlike: not universally supported</span>
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The <code>Rlike</code> comparator is not universally supported! It is only supported if the underlying
database supports regular expressions. If the database does not support regular expressions, then
<code>Rlike</code> will fall back to <code>Like</code> behavior.
</td>
</tr>
</table>
</div>


<h2 id="findByNull">4.7 Find By Null/Non-Null</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/findByNull.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Since our databases and Grails domain classes can contain properties that might
hold null values, we need ways to query those situations. For example, in our original
service implementations, we have two methods used to find which games played are complete
and which are still ongoing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryHowManyMatchesInProgress</span>() {
    Match.all.count {
        <span class="local-variable">it</span>.finished == <span class="predefined-constant">null</span>
    }
}

<span class="keyword">def</span> <span class="function">queryHowManyMatchesCompleted</span>() {
    Match.all.count {
        <span class="local-variable">it</span>.finished != <span class="predefined-constant">null</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The comparators for checking null values are <code>IsNull</code> and <code>IsNotNull</code>. These are
special in that they require no arguments for the dynamic finder. Here is the
improved implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">queryHowManyMatchesInProgress</span>() {
    Match.countByFinishedIsNull()
}

<span class="keyword">def</span> <span class="function">queryHowManyMatchesCompleted</span>() {
    Match.countByFinishedIsNotNull()
}</code></pre>
</div>
</div>


<h2 id="findInList">4.8 Find Property In List</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/findInList.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In the above sections, we have been able to find instances through a property: by equality,
by inequality, by values between bounds. Sometimes, though, the matching values for a property
do not form a simple range. With dynamic finders, you can find records where a property is
tested against items from a provided list: use the <code>InList</code> comparator.</p>
</div>
<div class="paragraph">
<p>Here are two examples. The first finds all of the <code>Game</code> records that match a list of <code>String</code> game
names, while the second example finds all <code>Match</code> records that track the game play of the games
listed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesForNames</span>(<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; names) {
        Game.all.findAll {
            <span class="local-variable">it</span>.name <span class="keyword">in</span> names
        }
    }

    <span class="keyword">def</span> <span class="function">queryMatchesForGames</span>(<span class="predefined-type">List</span>&lt;Game&gt; games) {
        Match.all.findAll {
            <span class="local-variable">it</span>.game <span class="keyword">in</span> games
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>By using the <code>InList</code> comparator and passing in the list of items to match against, we can
reduce these methods to be more efficient.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesForNames</span>(<span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; names) {
        Game.findAllByNameInList(names)
    }

    <span class="keyword">def</span> <span class="function">queryMatchesForGames</span>(<span class="predefined-type">List</span>&lt;Game&gt; games) {
        Match.findAllByGameInList(games)
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the second example, <code>QueryService.queryMatchesForGames</code>, note that the list does not
contain simple types (like <code>Number</code> or <code>String</code>), but actually contains a list of <code>Game</code>
domain objects. This is reasonable, since the property <code>game</code> of <code>Match</code> <strong>is an instance
of <code>Game</code></strong>.</p>
</div>
<div class="paragraph">
<p>Anytime you have a relationship like this, you can use domain class instances as part of
your query. As another example, the <code>Score</code> domain references the <code>Player</code> domain, and so,
for example, to find all of the scores by a particular player:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> jeffBrown = Player.findByName(<span class="string"><span class="delimiter">'</span><span class="content">Jeff Brown</span><span class="delimiter">'</span></span>)
    <span class="keyword">def</span> scores = Score.findByPlayer(jeffBrown)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Related to the <code>InList</code> comparator is the <code>NotInList</code> comparator which, as it sounds, finds
matching instances where the property under test is <strong>not</strong> found in the provided list. So, for
the inefficient implementation of <code>QueryService.queryGamesOtherThan</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesOtherThan</span>(<span class="predefined-type">List</span>&lt;Game&gt; games) {
        Game.all.findAll {
            !(<span class="local-variable">it</span> <span class="keyword">in</span> games)
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can be replaced using the <code>NotInList</code> comparator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesOtherThan</span>(<span class="predefined-type">List</span>&lt;Game&gt; games) {
        Game.findAllByNameNotInList(games*.name)
    }</code></pre>
</div>
</div>


<h2 id="combinators">4.9 Combining Query Clauses</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/combinators.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>There will be times when you want to find records by more than one property. Let&#8217;s take
an example: we want to find all the board games that support a certain number of players.
Our inefficient implementation looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryHowManyGamesSupportPlayerCount</span>(<span class="predefined-type">Integer</span> playerCount) {
        Game.all.count {
            <span class="local-variable">it</span>.minPlayers &lt;= playerCount &amp;&amp; playerCount &lt;= <span class="local-variable">it</span>.maxPlayers
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>These implementation use equality and less-than-or-equals operators; we already know how
to search for these things independently. For example, to find where the minimum number of
players is no higher than the requested player count, we would do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> games = Game.findAllByMinPlayersLessThanEqual(playerCount)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or to find those games where the maximum number of players is no less than the requested
player count, we would do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> games = Game.findAllByMaxPlayersGreaterThanEqual(playerCount)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because <code>minPlayers</code> and <code>maxPlayers</code> are different properties, we can&#8217;t use the <code>Between</code>
or <code>InRange</code> comparators, as they operate on a single property.</p>
</div>
<div class="paragraph">
<p>Instead, we introduce here <strong>combinators</strong>. These are the boolean operators <code>And</code> and <code>Or</code>.
So if we want to combine two requirements (i.e. a property and its comparator), we join them
using <code>And</code> if we require both requirements to pass, or <code>Or</code> if only one is required to pass.</p>
</div>
<div class="paragraph">
<p>For our current example, we want to combine <code>findAllByMinPlayersLessThanEqual</code> and
<code>findAllByMaxPlayersGreaterThanEqual</code>, requiring both statements to pass (which matches the
boolean-and operator <code>&amp;&amp;</code> of the inefficient implementation). When joining these, the prefix
(e.g. <code>findAllBy</code>) only needs to be specified once; then, our <code>And</code> combined query becomes
<code>findAllByMinPlayersLessThanEqualAndMaxPlayersGreaterThanEqual</code>, and the final dynamic finder
method call will take two arguments: one for <code>minPlayers</code> and one for <code>maxPlayers</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryHowManyGamesSupportPlayerCount</span>(<span class="predefined-type">Integer</span> playerCount) {
        Game.countByMinPlayersLessThanEqualsAndMaxPlayersGreaterThanEquals(playerCount, playerCount)
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another similar example: find all board games supporting an exact number of players (i.e.
where <code>minPlayers</code> and <code>maxPlayers</code> are equal to the same number). The original implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesSupportExactPlayerCount</span>(<span class="predefined-type">Integer</span> playerCount) {
        Game.all.findAll {
            <span class="local-variable">it</span>.minPlayers == playerCount &amp;&amp; <span class="local-variable">it</span>.maxPlayers == playerCount
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the improved implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesSupportExactPlayerCount</span>(<span class="predefined-type">Integer</span> playerCount) {
        Game.findAllByMinPlayersAndMaxPlayers(playerCount, playerCount)
    }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You are not limited to two predicates in your dynamic finder. You can use the <code>And</code> multiple
times to join as many predicates (i.e. query requirements) as you need. However, past two or
three predicates, you may find that your dynamic finder becomes difficult to read. Complex queries
may be implemented more legibly by using
<a href="http://gorm.grails.org/latest/hibernate/manual/index.html#querying">other query techniques</a>; these will
be the topics of future guides.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If we don&#8217;t require <strong>both</strong> parts of the combination to pass, we can use the <code>Or</code> combiner
(which compares to the boolean-or operator <code>||</code>). In <code>QueryService.queryGamesConsideredFamilyOrParty</code>,
the original implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesConsideredFamilyOrParty</span>() {
        Game.all.findAll {
            <span class="local-variable">it</span>.family || <span class="local-variable">it</span>.party
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>can be replaced with an improved implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> <span class="function">queryGamesConsideredFamilyOrParty</span>() {
        Game.findAllByFamilyOrParty(<span class="predefined-constant">true</span>, <span class="predefined-constant">true</span>)
    }</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
While a dynamic finder may use any number of <code>And</code> combiners or any number of <code>Or</code>
combiners, you <strong>cannot</strong> use <code>And</code> and <code>Or</code> together in the same dynamic finder. So this query
and those like it are invalid: <code>Game.findByMinPlayersAndMaxPlayersOrParty(2, 5, true)</code>. To
specify a condition such as this, you need to use
<a href="http://gorm.grails.org/latest/hibernate/manual/index.html#querying">other query techniques</a>.
</td>
</tr>
</table>
</div>


<h2 id="queryParameters">4.10 Parameterizing Queries</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/querying-gorm-dynamic-finders/edit/master/src/main/docs/guide/updatingTheService/queryParameters.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Any database query is made more useful when the results are sorted and paginated.
With any dynamic finder, beyond the arguments required by the properties/comparators used,
an additional <code>Map</code> argument can be added to manage sorting and pagination. (This argument
map is the same used for the <code>list()</code> method.)</p>
</div>
<div class="paragraph">
<p>To sort results as part of your query, use <code>sort</code>, <code>order</code>, and <code>ignoreCase</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sort</code> specifies the property to use to sort all instances.</p>
</li>
<li>
<p><code>order</code> is a string that specifies whether the sort should be ascending/increasing (<code>asc</code>) or
descending/decreasing (<code>desc</code>).</p>
</li>
<li>
<p><code>ignoreCase</code> specifies whether case should be ignored during sorting.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To paginate results as part of your query, use <code>offset</code> and <code>max</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>offset</code> specifies the index of the first result to return.</p>
</li>
<li>
<p><code>max</code> specifies the maximum number of results to return.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pagination parameters are applied <strong>after</strong> sorting parameters.</p>
</div>
<div class="paragraph">
<p>As an example, let&#8217;s say I want to find all strategy games supporting at least two players.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> games = Game.findAllByStrategyAndMinPlayers(<span class="predefined-constant">true</span>, <span class="integer">2</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s modify that to order the results, showing first the games supporting the highest
maximum number of players. Since we&#8217;re changing the ordering (and not the conditions to be
included in the results), we add <code>sort</code>/<code>order</code> query parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> games = Game.findAllByStrategyAndMinPlayers(<span class="predefined-constant">true</span>, <span class="integer">2</span>, [<span class="key">sort</span>: <span class="string"><span class="delimiter">'</span><span class="content">maxPlayers</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, let&#8217;s just show the first group of ten results. Add <code>offset</code>/<code>max</code> parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> games = Game.findAllByStrategyAndMinPlayers(<span class="predefined-constant">true</span>, <span class="integer">2</span>, [<span class="key">sort</span>: <span class="string"><span class="delimiter">'</span><span class="content">maxPlayers</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>, <span class="key">offset</span>: <span class="integer">0</span>, <span class="key">max</span>: <span class="integer">10</span>])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming a user of the application clicked the <code>Next</code> button, we can modify the
last call to show the next group of ten results by updating the <code>offset</code> value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="keyword">def</span> games = Game.findAllByStrategyAndMinPlayers(<span class="predefined-constant">true</span>, <span class="integer">2</span>, [<span class="key">sort</span>: <span class="string"><span class="delimiter">'</span><span class="content">maxPlayers</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>, <span class="key">offset</span>: <span class="integer">10</span>, <span class="key">max</span>: <span class="integer">10</span>])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, as was noted <a href="#findByProp">earlier</a>, the prefix <code>findBy</code> will return the first matching
result of a query. For robust code, you should consider adding a <code>sort</code> parameter, or even replacing
<code>findBy</code> with <code>findAllBy</code> and using <code>max: 1</code> in your parameters. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="comment">// This:</span>
    <span class="keyword">def</span> bestTwoPlayerGame = Game.findByMinPlayerAndMaxPlayer(<span class="integer">2</span>, <span class="integer">2</span>, [<span class="key">sort</span>: <span class="string"><span class="delimiter">'</span><span class="content">rating</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>])

    <span class="comment">// is equivalent to this:</span>
    <span class="keyword">def</span> bestTwoPlayerGame = Game.findAllByMinPlayerAndMaxPlayer(<span class="integer">2</span>, <span class="integer">2</span>, [<span class="key">sort</span>: <span class="string"><span class="delimiter">'</span><span class="content">rating</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="string"><span class="delimiter">'</span><span class="content">desc</span><span class="delimiter">'</span></span>, <span class="key">max</span>: <span class="integer">1</span>])</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There are a few more parameters available than are listed here. Please
refer to the documentation for
<a href="http://docs.grails.org/latest/ref/Domain%20Classes/list.html"><code>list</code></a> to see if they
apply to your situation.
</td>
</tr>
</table>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/testingTheService.html">&lt;&lt; <strong>3</strong><span>Testing the Service</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/specialForms.html"><strong>5</strong><span>Convenient Exceptional Forms</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title" style="text-align: right"><a href="https://travis-ci.org/grails-guides/querying-gorm-dynamic-finders"><img src="https://travis-ci.org/grails-guides/querying-gorm-dynamic-finders.svg?branch=master" /></a></div>            
                 <div class="local-title">
                    <a href="https://github.com/grails-guides/querying-gorm-dynamic-finders">
                    <svg height="35" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="35" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg></a> &nbsp;&nbsp;Get the Code
                </div>
                <div class="menu">
                    <div class="input-group">                        
                        <button href="#" onclick="document.getElementById('github-url').value='git@github.com:grails-guides/querying-gorm-dynamic-finders.git'" class="codeButton">SSH</button>
                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/querying-gorm-dynamic-finders.git'" class="codeButton">HTTPS</button>
                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/querying-gorm-dynamic-finders'" class="codeButton">Subversion</button>
                    </div>
       
                    <div class="input-group">                    
                        <!-- Target -->
                        <input id="github-url" value="git@github.com:grails-guides/querying-gorm-dynamic-finders.git" type="text" />

                        <!-- Trigger -->
                        <button class="clipbtn" type="button" data-clipboard-target="#github-url">

                            <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
                        </button>       

                    </div>
                    <div class="input-group">
                      <a href="https://github.com/grails-guides/querying-gorm-dynamic-finders/archive/master.zip" class="downloadButton">Download ZIP</a>
                    </div>
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. All guides are released with an ASLv2 license for the code, and Creative Commons license for the writing. 
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
